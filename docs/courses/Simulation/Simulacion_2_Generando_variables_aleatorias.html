<!DOCTYPE html>
<html lang="es"><head>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/clipboard/clipboard.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tabby.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/popper.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="author" content="Francisco Plaza Vega">
<title>Simulación Estadística</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/theme/quarto.css">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="Simulacion_2_Generando_variables_aleatorias_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Simulación Estadística</h1>
  <p class="subtitle">Unidad 2: Generando variables aleatorias</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Francisco Plaza Vega 
</div>
<div class="quarto-title-author-email">
<a href="mailto:francisco.plaza.v@usach.cl">francisco.plaza.v@usach.cl</a>
</div>
        <p class="quarto-title-affiliation">
            Ingeniería en Estadística
          </p>
    </div>
</div>

</section><section><section id="introducción" class="title-slide slide level1 center" data-background-color="#00A499" data-number="1"><h1>
<span class="header-section-number">1</span> Introducción</h1>

</section><section class="slide level2"><ul>
<li class="fragment"><p>La <span class="green">simulación de variables aleatorias</span> a partir de distribuciones de probabilidad específicas es una <span class="orange">herramienta fundamental</span> en la estadística computacional.</p></li>
<li class="fragment"><p>El caso más elemental, podría corresponder a <span class="orange">simular la extracción de una observación al azar</span> desde una población finita. Para lograrlo, se hace <span class="orange">necesario el poder generar observaciones aleatorias de la distribución uniforme discreta</span>. <em>Por lo que es <span class="orange">esencial tener un generador adecuado de números pseudoaleatorios</span> uniformes (Unidad anterior)</em>.</p></li>
<li class="fragment"><p>Los métodos para generar variables aleatorias de otras distribuciones de probabilidad dependen del generador de números aleatorios uniformes.</p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>En R, el generador de números pseudoaleatorios uniformes se utiliza con la función <code>runif</code>. Para generar un vector de números (pseudo) aleatorios entre 0 y 1 se usa <code>runif(n)</code>.</p></li>
<li class="fragment"><p>Para generar <span class="math inline">\(n\)</span> números aleatorios <span class="math inline">\(Uniforme(a, b)\)</span> se usa <code>runif(n, a, b)</code>; para una matriz de números aleatorios se utilizan las funciones <code>matrix(runif(n*m), nrow=n, ncol=m)</code> o <code>matrix(runif(n*m), n, m)</code>.</p></li>
<li class="fragment"><p>En esta unidad revisaremos algunas funciones para generar variables aleatorias de distribuciones de probabilidad continuas y discretas, algunas disponibles en R (como <code>rbeta</code>, <code>rgeom</code>, <code>rchisq</code>, etc.), aunque los métodos que describiremos son generales y aplicables a otros tipos de distribuciones y para su uso en bibliotecas externas, programas autónomos o problemas de simulación no estándar.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Muestreando desde una población finita</span></p>
<p>La función <code>sample</code> puede ser utilizada para obtener muestras desde una población, con o sin reemplazo.</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Lanzamiento de monedas</span></span>
<span id="cb1-2"><a href=""></a><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 0 1 0 0 1 0 1 1 0</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># Escoger números del loto</span></span>
<span id="cb3-2"><a href=""></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33  3  7 10 16 32</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Permuación de letras a-z</span></span>
<span id="cb5-2"><a href=""></a><span class="fu">sample</span>(letters)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "q" "u" "x" "j" "s" "l" "v" "r" "t" "i" "p" "y" "w" "c" "a" "o" "f" "h" "b"
[20] "d" "e" "z" "m" "g" "n" "k"</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Muestrear desde una distribución multinomial</span></span>
<span id="cb7-2"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">5</span>))</span>
<span id="cb7-3"><a href=""></a><span class="fu">table</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x
 1  2  3 
20 36 44 </code></pre>
</div>
</div>
</section><section id="algunos-generadores-aleatorios-en-r" class="slide level2" data-number="1.1"><h2>
<span class="header-section-number">1.1</span> Algunos generadores aleatorios en R</h2>
<p>En lo que sigue, revisaremos algunos generadores de números aleatorios con distribuciones conocidas, implementados en R. Sin embargo antes, necesitamos recordar algunos conceptos:</p>
<ul>
<li class="fragment"><p><strong>Función de masa de probabilidad (pmf)</strong>: Describe la probabilidad de que una variable aleatoria discreta adopte un valor específico. En R, se usa <code>d</code> al inicio del nombre de la función, como <code>dbinom</code>.</p></li>
<li class="fragment"><p><strong>Función de distribución de probabilidad (pdf)</strong>: Indica la probabilidad relativa de un valor específico para una variable aleatoria continua. En R, se identifica con <code>d</code>, como <code>dnorm</code>.</p></li>
<li class="fragment"><p><strong>Función de distribución acumulada (cdf)</strong>: Muestra la probabilidad de que una variable aleatoria sea menor o igual a un cierto valor. En R, se usa <code>p</code>, como <code>pnorm</code>.</p></li>
<li class="fragment"><p><strong>Función cuantíl</strong>: El inverso de la cdf, determina el valor de variable para una probabilidad acumulada dada. En R, se usa <code>q</code>, como <code>qnorm</code>.</p></li>
<li class="fragment"><p><strong>Función generadora de números aleatorios</strong>: Genera muestras de una distribución de probabilidad. En R, se identifica con <code>r</code>, como <code>rnorm</code>.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplos: Algunas distribuciones conocidas</span></p>
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Binomial:</strong>
<ul>
<li class="fragment"><p><code>dbinom(x, size, prob, log = FALSE)</code>: Calcula la función de masa de probabilidad (pmf) para un número <code>x</code> de éxitos, dado un <code>size</code> (número total de ensayos) y <code>prob</code> (probabilidad de éxito en un ensayo).</p></li>
<li class="fragment"><p><code>pbinom(q, size, prob, lower.tail = TRUE, log.p = FALSE)</code>: Calcula la función de distribución acumulada (cdf) para un cuantil <code>q</code>, es decir, la probabilidad de obtener un número de éxitos menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qbinom(p, size, prob, lower.tail = TRUE, log.p = FALSE)</code>: Determina el cuantil de la distribución binomial para una probabilidad acumulada <code>p</code>.</p></li>
<li class="fragment"><p><code>rbinom(n, size, prob)</code>: Genera <code>n</code> números aleatorios siguiendo una distribución binomial.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Normal:</strong>
<ul>
<li class="fragment"><p><code>dnorm(x, mean = 0, sd = 1, log = FALSE)</code>: Función de densidad de probabilidad (pdf) para la distribución normal en un punto <code>x</code>, con <code>mean</code> (media) y <code>sd</code> (desviación estándar).</p></li>
<li class="fragment"><p><code>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función de distribución acumulada (cdf) para la normal, probabilidad de que la variable sea menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función cuantil para la normal, determina el valor de variable que corresponde a la probabilidad <code>p</code>.</p></li>
<li class="fragment"><p><code>rnorm(n, mean = 0, sd = 1)</code>: Genera <code>n</code> números aleatorios con distribución normal.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Exponencial:</strong>
<ul>
<li class="fragment"><p><code>dexp(x, rate = 1, log = FALSE)</code>: Función de densidad de probabilidad (pdf) para la exponencial en un punto <code>x</code>, con <code>rate</code> (tasa de ocurrencia).</p></li>
<li class="fragment"><p><code>pexp(q, rate = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función de distribución acumulada (cdf) para la exponencial, probabilidad de que la variable sea menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qexp(p, rate = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función cuantil para la exponencial, determina el valor de variable que corresponde a la probabilidad <code>p</code>.</p></li>
<li class="fragment"><p><code>rexp(n, rate = 1)</code>: Genera <code>n</code> números aleatorios con distribución exponencial.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>Algunas distribuciones de probabilidad univariadas disponibles en R</p>
<div class="alert">
<div class="small">
<table style="width:97%;">
<colgroup>
<col style="width: 30%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th>Distribución</th>
<th style="text-align: center;">cdf</th>
<th style="text-align: center;">Generador</th>
<th>Parámetros</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>beta</td>
<td style="text-align: center;"><code>pbeta</code></td>
<td style="text-align: center;"><code>rbeta</code></td>
<td>shape1, shape2</td>
</tr>
<tr class="even">
<td>binomial</td>
<td style="text-align: center;"><code>pbinom</code></td>
<td style="text-align: center;"><code>rbinom</code></td>
<td>size, prob</td>
</tr>
<tr class="odd">
<td>chi-cuadrado</td>
<td style="text-align: center;"><code>pchisq</code></td>
<td style="text-align: center;"><code>rchisq</code></td>
<td>df</td>
</tr>
<tr class="even">
<td>exponencial</td>
<td style="text-align: center;"><code>pexp</code></td>
<td style="text-align: center;"><code>rexp</code></td>
<td>rate</td>
</tr>
<tr class="odd">
<td>F</td>
<td style="text-align: center;"><code>pf</code></td>
<td style="text-align: center;"><code>rf</code></td>
<td>df1, df2</td>
</tr>
<tr class="even">
<td>gamma</td>
<td style="text-align: center;"><code>pgamma</code></td>
<td style="text-align: center;"><code>rgamma</code></td>
<td>shape, rate or scale</td>
</tr>
<tr class="odd">
<td>geométrica</td>
<td style="text-align: center;"><code>pgeom</code></td>
<td style="text-align: center;"><code>rgeom</code></td>
<td>prob</td>
</tr>
<tr class="even">
<td>lognormal</td>
<td style="text-align: center;"><code>plnorm</code></td>
<td style="text-align: center;"><code>rlnorm</code></td>
<td>meanlog, sdlog</td>
</tr>
<tr class="odd">
<td>binomial negativa</td>
<td style="text-align: center;"><code>pnbinom</code></td>
<td style="text-align: center;"><code>rnbinom</code></td>
<td>size, prob</td>
</tr>
<tr class="even">
<td>normal</td>
<td style="text-align: center;"><code>pnorm</code></td>
<td style="text-align: center;"><code>rnorm</code></td>
<td>mean, sd</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td style="text-align: center;"><code>ppois</code></td>
<td style="text-align: center;"><code>rpois</code></td>
<td>lambda</td>
</tr>
<tr class="even">
<td>T de Student</td>
<td style="text-align: center;"><code>pt</code></td>
<td style="text-align: center;"><code>rt</code></td>
<td>df</td>
</tr>
<tr class="odd">
<td>uniforme</td>
<td style="text-align: center;"><code>punif</code></td>
<td style="text-align: center;"><code>runif</code></td>
<td>min, max</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section><section id="método-de-la-transformada-inversa" class="title-slide slide level1 center" data-background-color="#00A499" data-number="2"><h1>
<span class="header-section-number">2</span> Método de la transformada inversa</h1>

</section><section id="la-idea-intuitiva" class="slide level2" data-number="2.1"><h2>
<span class="header-section-number">2.1</span> La idea intuitiva</h2>
<p>La Función de distribución acumulada (CDF) de una variable aleatoria <span class="math inline">\(X\)</span> evaluada en <span class="math inline">\(x\)</span> es la probabilidad de que <span class="math inline">\(X\)</span> tome un valor igual o menor que <span class="math inline">\(x\)</span> (<span class="math inline">\(P(X) = P(X \leq x)\)</span>). Por ejemplo tomemos la distribución Normal con parámetros <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span></p>

<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>Digamos que muestreamos una variable aleatoria desde la distribución normal <span class="math inline">\(N(\mu=0, \sigma=1)\)</span>, y obtenemos un valor de <span class="math inline">\(x=0.3\)</span>. Al revisar en la CDF podremos revisar el valor de la probabilidad acumulada de <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>x_val <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb9-2"><a href=""></a>y_val <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x_val)</span>
<span id="cb9-3"><a href=""></a>y_val</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6179114</code></pre>
</div>
</div>
</section><section class="slide level2"><p>¿Qué podemos decir de lo anterior?:</p>
<ul>
<li class="fragment"><p>Cuando extraemos una muestra aleatoria <span class="math inline">\(x\)</span> de esta distribución, existe un <span class="math inline">\(62\%\)</span> de que <span class="math inline">\(x \leq 0.3\)</span>. La CDF es una probabilidad, por lo que está en el rango <span class="math inline">\((0,1)\)</span></p></li>
<li class="fragment"><p>La CDF también es una función monótona creciente.</p></li>
</ul>
<div class="alert">
<ul>
<li class="fragment"><p>Esto es el concepto intuitivo del método de la transformada inversa. En vez de evaluar la CDF en <span class="math inline">\(x\)</span>, se evalúa la inversa de la CDF en un punto <span class="math inline">\(u\)</span>, donde <span class="math inline">\(u\)</span> es una variable aleatoria desde una distribución <span class="math inline">\(Uniforme(0,1)\)</span>.</p></li>
<li class="fragment"><p>Iniciamos con un valor aleatorio entre 0 y 1 y empleamos la inversa de la CDF para convertirlo en el valor de <span class="math inline">\(x\)</span> al cual pertenece la distribución objetivo.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>El método de la transformada inversa para generar variables aleatorias está basado en el siguiente teorema <span class="citation" data-cites="Fisher1936">(<a href="#/referencias" role="doc-biblioref" onclick="">Fisher et&nbsp;al. 1936</a>)</span>:</p>
<div class="definition">
<p><span class="blue">Teorema: Transformación integral de la probabilidad</span></p>
<p>Si <span class="math inline">\(X\)</span> es una variable aleatoria contínua con <span class="math inline">\(cdf\)</span> <span class="math inline">\(F_{X}(x)\)</span>, entonces</p>
<p><span class="math display">\[U=F_{X}(X) \sim Uniforme(0,1)\]</span></p>
</div>
</section><section class="slide level2"><p>El método de la transformada inversa para generar variables aleatorias aplica el teorema anterior. Se define la transformación inversa:</p>
<p><span class="math display">\[F_{X}^{-1}(u) = inf\{ x: F_{X}(x)=u \},  \quad 0&lt;u&lt;1.\]</span></p>
<p>Si <span class="math inline">\(U\sim Uniforme(0,1)\)</span>, entonces para todo <span class="math inline">\(x \in \mathbb{R}\)</span> se tiene que</p>
<div class="small">
<span class="math display">\[\begin{array}{l}
P \left( F_{X}^{-1}(U) \leq x \right) =&amp; P \left( inf\{ t: F_{X}(t) =U \} \leq x \right) \\
                                 &amp; P(U \leq F_{X}(x)) \\
                                 &amp; F_{U}(F_{X}(x)) = F_{X}(x),

\end{array}\]</span>
</div>
<p>por lo tanto <span class="math inline">\(F_{X}^{-1}(U)\)</span> tiene la misma distribución que <span class="math inline">\(X\)</span>.</p>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Para generar una observación <span class="math inline">\(X\)</span>, primero generamos una variable aleatoria <span class="math inline">\(Uniforme(0,1)\)</span>, denotada por <span class="math inline">\(u\)</span> y computamos la inversa <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment"><p>Este método es sencillo de implementar, siempre y cuando <span class="math inline">\(F_{X}^{-1}\)</span> sea posible de computar.</p></li>
<li class="fragment"><p>Este método puede ser aplicado para generar variables aleatorias contínuas o discretas.</p></li>
</ul>
<div class="definition">
<p>El método puede ser resumido de la siguiente manera:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Encontrar la función inversa <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment"><p>Escribir una función para calcular <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment">
<p>Para cada variable aleatoria requerida:</p>
<ol type="i">
<li class="fragment">Generar una variable <span class="math inline">\(u \sim Uniforme(0,1)\)</span>.</li>
<li class="fragment">Computar <span class="math inline">\(x= F_{X}^{-1}(u)\)</span>.</li>
</ol>
</li>
</ol>
</div>
</div>
</section><section id="método-de-la-transformada-inversa-caso-contínuo" class="slide level2" data-number="2.2"><h2>
<span class="header-section-number">2.2</span> Método de la transformada inversa, caso contínuo</h2>
<div class="example">
<p><span class="green">Ejemplo:</span> Supongamos que se quiere simular una muestra aleatoria desde una distribución con densidad <span class="math inline">\(f_{X}(x) = 3x^2, \; 0 &lt;x&lt;1\)</span>.</p>
</div>
<ul>
<li class="fragment"><p>En este caso <span class="math inline">\(F_{X}(x) = x^3\)</span> para <span class="math inline">\(0&lt;x&lt;1\)</span> y <span class="math inline">\(F_{X}^{-1}(u) = u^{\frac{1}{3}}\)</span>.</p></li>
<li class="fragment"><p>Generamos los <span class="math inline">\(n\)</span> números aleatorios requeridos como el vector <code>u</code>. Entonces <code>u^(1/3)</code> es un vector de largo <code>n</code> que contiene la muestra <span class="math inline">\(x_1, \ldots, x_n\)</span></p></li>
</ul></section><section class="slide level2"><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb11-3"><a href=""></a>x <span class="ot">=</span> u<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb11-4"><a href=""></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb11-5"><a href=""></a>     <span class="at">ylab=</span><span class="st">"Densidad"</span>) <span class="co">#histograma para la densidad de la muestra</span></span>
<span id="cb11-6"><a href=""></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb11-7"><a href=""></a><span class="fu">lines</span>(y, <span class="dv">3</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span>) <span class="co">#curva de la densidad f(x)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><h3 id="ejemplo-distribución-exponencial">Ejemplo: Distribución exponencial</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución exponencial</span> Es posible generar muestras aleatorias desde una distribución exponencial con media <span class="math inline">\(\frac{1}{\lambda}\)</span>.</p>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(X\sim Exp(\lambda)\)</span>, entonces para <span class="math inline">\(x&gt;0\)</span> la <em>cdf</em> de <span class="math inline">\(X\)</span> es <span class="math inline">\(F_{X}(x) = 1 - e^{-\lambda x}\)</span>.</p></li>
<li class="fragment"><p>La transformación inversa es <span class="math inline">\(F_{X}^{-1}(u) = - \frac{1}{\lambda}log(1-u)\)</span>.</p></li>
<li class="fragment"><p>Notar que <span class="math inline">\(U\)</span> y <span class="math inline">\(1-U\)</span> tienen la misma distribución y en este caso es más sencillo definir <span class="math inline">\(x = - \frac{1}{\lambda}log(u)\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Para generar una muestra aleatoria de tamaño <code>n</code> con parámetro <code>lambda</code> hacemos</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb12-2"><a href=""></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href=""></a>x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">runif</span>(n))<span class="sc">/</span>lambda</span>
<span id="cb12-4"><a href=""></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Distribución exp("</span>,lambda, <span class="st">")"</span>),</span>
<span id="cb12-5"><a href=""></a>     <span class="at">ylab=</span><span class="st">"Densidad"</span>, <span class="at">col =</span> <span class="st">'lightblue'</span>) <span class="co">#histograma para la densidad de la muestra</span></span>
<span id="cb12-6"><a href=""></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">qexp</span>(<span class="fl">0.99</span>, lambda), .<span class="dv">01</span>)</span>
<span id="cb12-7"><a href=""></a><span class="fu">lines</span>(y, <span class="fu">dexp</span>(y), <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><h3 id="ejemplo-distribución-kumaraswami">Ejemplo: Distribución Kumaraswami</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución Kumaraswami</span></p>
<p>La función de <a href="https://en.wikipedia.org/wiki/Kumaraswamy_distribution">distribución Kumaraswami</a> puede ser expresada</p>
<p><span class="math display">\[F_{X}(x) = 1- (1-x^a)^b\]</span></p>
</div>
<p>Tenemos entonces que encontrar la función inversa de la CFF de la función de distribución, al hacer <span class="math inline">\(u = F_{X}(x)\)</span></p>
<p><span class="math display">\[ x= (1-(1-u)^{\frac{1}{b}})^{\frac{1}{a}} = F_{X}^{-1}(u)\]</span></p>
</section><section class="slide level2"><div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1">Gráfico</a></li>
<li><a href="#tabset-1-2">Código en R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href=""></a></span>
<span id="cb13-4"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-5"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb13-6"><a href=""></a>a <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb13-7"><a href=""></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb13-8"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb13-9"><a href=""></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(u) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">pdf_sim =</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>b) ) <span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a),</span>
<span id="cb13-11"><a href=""></a>         <span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n),</span>
<span id="cb13-12"><a href=""></a>         <span class="at">pdf_teorica =</span> a<span class="sc">*</span>b<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span>a)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb13-13"><a href=""></a></span>
<span id="cb13-14"><a href=""></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href=""></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-16"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>pdf_sim, <span class="at">y=</span><span class="fu">after_stat</span>(density)), </span>
<span id="cb13-17"><a href=""></a>                 <span class="at">bins=</span><span class="dv">30</span>, <span class="at">colour=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>pdf_teorica), <span class="at">colour=</span><span class="st">"green4"</span>,<span class="at">lwd =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb13-19"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Densidad f(x)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> </span>
<span id="cb13-20"><a href=""></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Densidad de la distribución Kumaraswami (a="</span>, a, <span class="st">" , b="</span>, b, <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb13-21"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="ejercicios" class="slide level2" data-number="2.3"><h2>
<span class="header-section-number">2.3</span> Ejercicios</h2>
<p>Genere números aleatorios utilizando el método de la inversa de las siguientes distribuciones:</p>
<div>
<div class="small">
<ol type="1">
<li><p>Distribución Cauchy</p></li>
<li><p>Distribución Weibull</p></li>
</ol>
</div>
</div>
</section><section id="método-de-la-transformada-inversa-caso-discreto" class="slide level2" data-number="2.4"><h2>
<span class="header-section-number">2.4</span> Método de la transformada inversa (caso discreto)</h2>
<ul>
<li class="fragment"><p>Supongamos que se necesita generar el valor de una variable aleatoria discreta denotada por <span class="math inline">\(X\)</span>, cuya función de masa de probabilidad está dada por <span class="math display">\[P\{ X = x_j \} = p_j, \qquad j=0,1, \ldots, \sum_{j} p_j = 1\]</span></p></li>
<li class="fragment"><p>Para lograr lo anterior, necesitamos generar un número aleatorio <span class="math inline">\(U\)</span>, tal que <span class="math inline">\(U\)</span> tenga una distribución <span class="math inline">\((0,1)\)</span>, y además establecer que <span class="math display">\[X = \left\{\begin{array}{ll}
x_0 &amp; \mbox{Si} \; U &lt; p_0  \\
x_1 &amp; \mbox{Si} \; p_0 \leq U &lt; p_0 + p_1\\
\vdots &amp; \\
x_j &amp; \mbox{Si} \; \sum_{i=0}^{j-1} p_i \leq U &lt; \sum_{i=0}^{j} p_i  \\
\vdots &amp;
\end{array}\right.\]</span></p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>Dado que, para <span class="math inline">\(0&lt;a&lt;b&lt;1\)</span>, <span class="math inline">\(P\{a \leq U &lt; b \} = b-a\)</span>, tenemos que <span class="math display">\[ P\{X = x_j \} = P\left\{ \sum_{i=0}^{j-1} p_i \leq U &lt; \sum_{i=0}^{j} p_i \right\} = p_j \]</span></p></li>
<li class="fragment"><p>Entonces, <span class="math inline">\(X\)</span> tendrá la distribución objetivo.</p></li>
</ul>
<div class="definition">
<p>Podemos escribir el procedimiento anterior como pseudocódigo:</p>
<div class="small">
<ol type="1">
<li class="fragment">Genera un número aleatorio <span class="math inline">\(U\)</span>
<ol type="i">
<li class="fragment">Si <span class="math inline">\(U &lt; p_0\)</span>, entonces <span class="math inline">\(X = x_0\)</span>.</li>
<li class="fragment">Si <span class="math inline">\(U &lt; p_0 + p_1\)</span>, entonces <span class="math inline">\(X = x_1\)</span>
</li>
<li class="fragment">Si <span class="math inline">\(U &lt; p_0 + p_1 + p_2\)</span>, entonces <span class="math inline">\(X = x_2\)</span>
</li>
<li class="fragment"><span class="math inline">\(\vdots\)</span></li>
</ol>
</li>
<li class="fragment">Repetir</li>
</ol>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Si el <span class="math inline">\(i-\)</span>ésimo elemento <span class="math inline">\(x_i, i \geq 0\)</span> está ordenado de tal manera que <span class="math inline">\(x_0 &lt; x_1 &lt; x_2 \cdots\)</span> y dejamos que <span class="math inline">\(F\)</span> sea la función de distribución de <span class="math inline">\(X\)</span>. Así <span class="math inline">\(F(x_k) = \sum_{i=0}^{k}p_i\)</span>, entonces <span class="math display">\[X \quad \mbox{será igual a } x_j \quad \mbox{Si} \quad F(x_{j-1}) \leq U &lt; F(x_k)\]</span></p></li>
<li class="fragment"><p>En otras palabras, después de generar un número aleatorio <span class="math inline">\(U\)</span>, se determina el valor de <span class="math inline">\(X\)</span> al encontrar un intervalo <span class="math inline">\(\left[ F(x_{j−1}), F(x_{j}) \right]\)</span> en el cual se encuentra <span class="math inline">\(U\)</span> <span class="math inline">\(\left[ \mbox{o de forma equivalente, al encontrar la inversa de } F(U), F^{-1}(U) \right]\)</span>. Por esta razón es que este método recibe su nombre: <span class="green">La transformada inversa para generar <span class="math inline">\(X\)</span></span>.</p></li>
<li class="fragment"><p>La cantidad de tiempo que este método tarda en generar una variable aleatoria discrata será proporiconal al número de intervalos que se deben buscar. Es por esta razón que es necesario considerar los posibles valores de <span class="math inline">\(x_j\)</span> de <span class="math inline">\(X\)</span> en orden decreciente para la <span class="math inline">\(p_j\)</span>.</p></li>
</ul></section><section class="slide level2"><h3 id="ejemplo">Ejemplo</h3>
<div class="example">
<p><span class="green">Ejemplo:</span> Supongamos que queremos simular desde una variable aleatoria <span class="math inline">\(X\)</span> que sigue la siguiente distribución</p>
<p><span class="math display">\[f(x) = \left\{ \begin{align}
0.1 &amp; \quad \mbox{Si } x = 1  \\
0.4 &amp; \quad \mbox{Si } x = 2  \\
0.2 &amp; \quad \mbox{Si } x = 3  \\
0.3 &amp; \quad \mbox{Si } x = 4  \\
\end{align}\right.\]</span></p>
</div>
<p></p>
<p>Tabulamos los posibles valores de <span class="math inline">\(x_i\)</span> y de sus probabilidades <span class="math inline">\(P(X=x_i)\)</span></p>
<div class="small">
<table style="width:29%;">
<colgroup>
<col style="width: 11%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(P(X=x_i)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3</td>
</tr>
</tbody>
</table>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="co"># Valores posibles de x</span></span>
<span id="cb14-2"><a href=""></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb14-3"><a href=""></a></span>
<span id="cb14-4"><a href=""></a><span class="co"># pdf evaluada en cada valor de x</span></span>
<span id="cb14-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb14-6"><a href=""></a></span>
<span id="cb14-7"><a href=""></a><span class="co"># CDF evaluada en cada valor de x</span></span>
<span id="cb14-8"><a href=""></a>(<span class="at">Fx =</span> <span class="fu">cumsum</span>(fx))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1 0.5 0.7 1.0</code></pre>
</div>
</div>
</div><div class="column">
<p>Por lo que nuestra CDF se podría escribir de la siguiente manera:</p>
<p><span class="math display">\[F_{X}(x) = \left\{ \begin{align}
0.1 &amp; \quad \mbox{Si } x = 1  \\
0.5 &amp; \quad \mbox{Si } x = 2  \\
0.7 &amp; \quad \mbox{Si } x = 3  \\
1.0 &amp; \quad \mbox{Si } x = 4  \\
\end{align}\right.\]</span></p>
</div>
</div>
<p>Ahora, en vez de encontrar la inversa de la CDF, la empleamos directamente. Generamos números aleatorios y encontramos el valor más pequeño de <span class="math inline">\(X\)</span> tal que <span class="math inline">\(F(x) \geq u\)</span>:</p>
<div class="small">
<ul>
<li class="fragment">Paso 1: Generar <span class="math inline">\(u\)</span> desde la distribución <span class="math inline">\(Uniforme(0,1)\)</span>;</li>
<li class="fragment">Paso 2: Encontrar el valor más pequeño de <span class="math inline">\(X\)</span> tal que <span class="math inline">\(F(x) \geq u\)</span>. Es decir:
<ul>
<li class="fragment">if <span class="math inline">\(u \leq 0.10\)</span>, entonces <span class="math inline">\(X=1\)</span>;</li>
<li class="fragment">else if <span class="math inline">\(0.10 &lt; u \leq 0.5\)</span>, entonces <span class="math inline">\(X=2\)</span>;</li>
<li class="fragment"><span class="math inline">\(\vdots\)</span></li>
<li class="fragment">else <span class="math inline">\(X=4\)</span>.</li>
</ul>
</li>
</ul>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb16-2"><a href=""></a><span class="fu">library</span>(kableExtra) </span>
<span id="cb16-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-4"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb16-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb16-6"><a href=""></a>Fx <span class="ot">=</span> <span class="fu">cumsum</span>(fx)</span>
<span id="cb16-7"><a href=""></a></span>
<span id="cb16-8"><a href=""></a><span class="co"># Especificar los valores de x</span></span>
<span id="cb16-9"><a href=""></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb16-10"><a href=""></a></span>
<span id="cb16-11"><a href=""></a><span class="co"># Encontrar el valor más pequeño de x con la CDF &gt;= u</span></span>
<span id="cb16-12"><a href=""></a>xsim <span class="ot">=</span> <span class="fu">sapply</span>(u, <span class="cf">function</span>(uval) <span class="fu">min</span>(x[Fx <span class="sc">&gt;=</span> uval]))</span>
<span id="cb16-13"><a href=""></a></span>
<span id="cb16-14"><a href=""></a><span class="co"># Mostrar tabla con los resultados</span></span>
<span id="cb16-15"><a href=""></a><span class="fu">tibble</span>(<span class="at">u =</span> u, <span class="at">xsim =</span> xsim) <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">22</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 30px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">u</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">xsim</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.2655087</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3721239</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.5728534</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.9082078</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.2016819</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.8983897</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.9446753</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.6607978</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.6291140</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.0617863</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><p>Finalmente, evaluamos el generador de números aleatorios a través de una muestra más grande.</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-3"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb17-4"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb17-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb17-6"><a href=""></a>Fx <span class="ot">=</span> <span class="fu">cumsum</span>(fx)</span>
<span id="cb17-7"><a href=""></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb17-8"><a href=""></a></span>
<span id="cb17-9"><a href=""></a><span class="co"># Encontrar el valor más pequeño de x con la CDF &gt;= u</span></span>
<span id="cb17-10"><a href=""></a>xsim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(u, <span class="cf">function</span>(uval) <span class="fu">min</span>(x[Fx <span class="sc">&gt;=</span> uval]))</span>
<span id="cb17-11"><a href=""></a></span>
<span id="cb17-12"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">table</span>(xsim)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-13"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-14"><a href=""></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(xsim, Freq<span class="sc">/</span>n),</span>
<span id="cb17-15"><a href=""></a>           <span class="at">colour=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-16-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribuciones-de-bernoulli-p-y-binomial-n-p">Ejemplo: Distribuciones de Bernoulli (<span class="math inline">\(p\)</span>) y Binomial (<span class="math inline">\(n, p\)</span>)</h3>
<p>Supongamos que queremos generar una variable aleatoria Bernoulli (<span class="math inline">\(p\)</span>) <span class="math inline">\(X\)</span>, en cuyo caso <span class="math inline">\(P(X = 0) = 1-p\)</span> y <span class="math inline">\(P(X = 1) = p\)</span> para algún <span class="math inline">\(p \in (0, 1)\)</span>. Entonces el método de transformación inversa discreta produce:</p>
<div class="alert">
<div class="small">
<p>Algoritmo para generar una v.a. Bernoulli (<span class="math inline">\(p\)</span>) <span class="math inline">\(X\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Genera <span class="math inline">\(u_i \sim \text{unif}(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Establece <span class="math inline">\(x_i = 0\)</span> si <span class="math inline">\(u_i \leq 1-p\)</span>; <span class="math inline">\(x_i = 1\)</span> si <span class="math inline">\(u_i &gt; 1-p\)</span>.</p></li>
<li class="fragment"><p>Repetir pasos 1 y 2 <span class="math inline">\(n\)</span> veces, tal que <span class="math inline">\(i=1, 2, \ldots, n\)</span>.</p></li>
</ol>
</div>
</div>
</section><section class="slide level2"><h3 id="implementación-distribución-bernoulli">Implementación: Distribución <em>Bernoulli</em>
</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución Bernoulli</span> Aplicamos la transformada inversa discreta para generar una muestra aleatoria <span class="math inline">\(Bernoulli(p=0.4)\)</span>.</p>
<ul>
<li class="fragment"><p>En este ejemplo, <span class="math inline">\(F_{x}(0) = f_{X}(0) =1-p\)</span> y <span class="math inline">\(F_{X}(1) = 1\)</span>.</p></li>
<li class="fragment"><p>Así, <span class="math inline">\(F_{X}^{-1}(u) = 1\)</span> si <span class="math inline">\(u &gt;0.6\)</span> y <span class="math inline">\(F_{X}^{-1}(u) = 0\)</span> si <span class="math inline">\(u \leq 0.6\)</span>.</p></li>
<li class="fragment"><p>El generador de la variable aleatoria debería entregar el valor numérico de la expresión lógica <span class="math inline">\(u&gt;0.6\)</span>.</p></li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-2"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb18-3"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb18-4"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span> p)</span>
<span id="cb18-5"><a href=""></a><span class="fu">head</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0 0 1 0 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">mean</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">var</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2376937</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Podemos comparar los valores de los estadísticos muestrales con los momentos teóricos de la distribución Bernoulli.</p>
<ul>
<li class="fragment"><p>La media muestral de la muestra generada debería ser aproximadamente <span class="math inline">\(p = 0.4\)</span>, en nuestro ejemplo, la media muestral estimada <span class="math inline">\(\bar{x}=\)</span> 0.388.</p></li>
<li class="fragment"><p>La varianza muestral debería ser aproximadamente <span class="math inline">\(p(1-p) = 0.24\)</span> y nuestra varianza muestral <span class="math inline">\(s^2=\)</span> 0.2376937</p></li>
</ul>
<p></p>
<p><strong>Nota</strong>: <em>En R, se puede utilizar la función <code>rbinom</code> (</em>random binomial<em>) de tamaño 1 (<code>size=1</code>) para generar una muestra de tipo Bernoulli. Otro método podría ser utilizar la función <code>sample</code> desde el vector <span class="math inline">\(x=\{0,1\}\)</span> con probabilidades <span class="math inline">\((1-p, p)\)</span>.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb24-2"><a href=""></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">6</span>,.<span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribución-binomial">Ejemplo: Distribución Binomial</h3>
<ul>
<li class="fragment"><p>Supongamos que queremos que <span class="math inline">\(X\)</span> tenga una distribución binomial (<span class="math inline">\(n, p\)</span>), es decir, <span class="math display">\[p(k) = P(X = k) = \binom{n}{k} p^k(1-p)^{n-k}, 0 \leq k \leq n.\]</span></p></li>
<li class="fragment"><p>Uno podría, en principio, usar el método de transformación inversa discreta con estas <span class="math inline">\(p(k)\)</span>, pero también podemos notar que <span class="math inline">\(X\)</span> puede ser representado (en distribución) como la suma de <span class="math inline">\(n\)</span> v.a. Bernoulli (<span class="math inline">\(p\)</span>) i.i.d, <span class="math inline">\(Y_1, \dots, Y_n\)</span>; <span class="math display">\[X = \sum_{i=1}^n Y_i,\]</span> el número de éxitos de <span class="math inline">\(n\)</span> pruebas Bernoulli (<span class="math inline">\(p\)</span>) i.i.d.</p></li>
</ul></section><section class="slide level2"><div class="definition">
<div class="small">
<p>Algoritmo alternativo para generar una v.a. binomial (<span class="math inline">\(n, p\)</span>) <span class="math inline">\(X\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(n\)</span> v.a. i.i.d. <span class="math inline">\(U_1, U_2, \dots, U_n \sim \text{unif}(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Para cada <span class="math inline">\(1 \leq i \leq n\)</span>, establecer <span class="math inline">\(Y_i = 0\)</span> si <span class="math inline">\(U_i \leq 1-p\)</span>; <span class="math inline">\(Y_i = 1\)</span> si <span class="math inline">\(U_i &gt; 1-p\)</span>. (Esto produce <span class="math inline">\(n\)</span> v.a. Bernoulli (<span class="math inline">\(p\)</span>) i.i.d.)</p></li>
<li class="fragment"><p>Establece <span class="math inline">\(X = \sum_{i=1}^n Y_i\)</span>.</p></li>
</ol>
</div>
</div>
<p>La ventaja de este algoritmo es su simplicidad, no necesitamos hacer los diversos cálculos involucrados con las <span class="math inline">\(p(k)\)</span>. Por otro lado, este algoritmo requiere <span class="math inline">\(n\)</span> uniformes para cada copia de <span class="math inline">\(X\)</span> en lugar de solo uno cuando se usa el método de transformación inversa discreta.</p>
<!-- Por lo tanto, podríamos no querer usar este algoritmo cuando $n$ es bastante grande. -->
<!-- - De hecho, cuando $n$ es muy grande, y $p$ es pequeño, se sigue (por ejemplo, puede ser demostrado; hay un teorema aquí), que la distribución de $X$ es muy aproximadamente la distribución de Poisson con media $np$. Esto motiva nuestro próximo ejemplo. -->
</section><section class="slide level2"><!-- --- --><!-- ### Ejemplo: Distribución *Poisson* con media $\alpha$: --><!-- En este caso, --><!-- $$p(k) = P(X = k) = e^{-\alpha} \frac{\alpha^k}{k!}, k \geq 0.$$ --><!-- - Podríamos usar el método de transformación inversa discreta, pero, por supuesto, esto implica calcular (de antemano) intervalos como $\frac{\alpha^k}{k!}$.  --><!-- - Se propone un algoritmo alternativo que hace uso de las propiedades de un proceso de Poisson a tasa $\alpha$. El truco es recordar que si $\{N(t) : t \geq 0\}$ es el proceso de conteo de un proceso de Poisson a tasa $\alpha$, entonces $N(1)$ tiene una distribución de Poisson con media $\alpha$. Así que si podemos simular $N(1)$, entonces podemos establecer $X = N(1)$ y hemos terminado. Sea $Y = N(1) + 1$, y que $t_n = X_1 + \dots + X_n$ denote el $n$-ésimo punto del proceso de Poisson; los $X_i$ son iid con una distribución exponencial a tasa $\alpha$. Note que --><!-- $$Y = \min\{n \geq 1 : t_n > 1\} = \min\{n \geq 1 --><!--  : X_1 + \dots + X_n > 1\},$$ --><!-- un tiempo de parada. Usando el método de transformación inversa para generar los tiempos de llegada exponenciales iid $X_i$, podemos representar $X_i = -\frac{1}{\alpha} \ln(U_i)$. Luego podemos reescribir (recordando que $\ln(xy) = \ln(x)+\ln(y)$) --><!-- $$Y = \min\{n \geq 1 : \ln(U_1) + \dots+ \ln(U_n) < -\alpha\} = \min\{n \geq 1 : \ln(U_1 \dots U_n) < -\alpha\} = \min\{n \geq 1 : U_1 \dots U_n < e^{-\alpha}\}$$ --><!-- Así podemos simular $Y$ simplemente generando uniformes $U_i$ independientes consecutivamente y tomando el producto hasta que el producto caiga por debajo de $e^{-\alpha}$. --><!-- Así podemos simular $Y$ simplemente generando uniformes $U_i$ independientes consecutivamente y tomando el producto hasta que el producto caiga por debajo de $e^{-\alpha}$. Entonces obtenemos $X = N(1) = Y - 1$ como nuestra Poisson deseada. Aquí entonces está el algoritmo resultante: --><!-- ### Algoritmo alternativo para generar una rv Poisson $X$ con media $\alpha$: --><!-- i. Establece $X = 0$, $P = 1$ --><!-- ii. Genera $U \sim \text{unif}(0, 1)$, establece $P = UP$ --><!-- iii. Si $P < e^{-\alpha}$, entonces detente. De lo contrario, si $P \geq e^{-\alpha}$, entonces establece $X = X + 1$ y vuelve a ii. --><!-- --- --><div class="example">
<p><span class="green">Ejemplo: Generación de permutaciones aleatorias</span></p>
<ul>
<li class="fragment">
<p>Consideremos la generación de una permutación de los números <span class="math inline">\(1, 2, \ldots, n\)</span> de tal manera que todos los <span class="math inline">\(n!\)</span> ordenamientos posibles sean igualmente probables.</p>
<ul>
<li class="fragment"><p>El procedimiento inicia seleccionando de manera aleatoria uno de los números <span class="math inline">\(1,\ldots, n\)</span> y colocándolo en la posición <span class="math inline">\(n\)</span>.</p></li>
<li class="fragment"><p>Luego, se elige aleatoriamente uno de los <span class="math inline">\(n - 1\)</span> números restantes, ubicándolo en la posición <span class="math inline">\(n - 1\)</span>.</p></li>
<li class="fragment"><p>El proceso continúa, seleccionando aleatoriamente uno de los <span class="math inline">\(n - 2\)</span> números restantes para la posición <span class="math inline">\(n - 2\)</span>, y así sucesivamente.</p></li>
<li class="fragment"><p>La elección aleatoria de un número significa que cada uno de los números restantes tiene la misma probabilidad de ser seleccionado.</p></li>
</ul>
</li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p>Para simplificar el proceso y evitar tener que identificar exactamente qué números quedan por posicionar, es práctico y eficiente mantener los números en una lista ordenada. Entonces, en lugar de elegir el número directamente, se selecciona aleatoriamente la posición del número. Partiendo de un ordenamiento inicial <span class="math inline">\(P_1, P_2, \ldots, P_n\)</span>, se elige una posición de <span class="math inline">\(1, \ldots, n\)</span> al azar, intercambiando el número en esa posición con el que está en la posición <span class="math inline">\(n\)</span>. Posteriormente, se selecciona una de las posiciones <span class="math inline">\(1, \ldots, n - 1\)</span> de manera aleatoria, intercambiando el número en esta posición con el que está en la posición <span class="math inline">\(n - 1\)</span>, y este procedimiento se repite sucesivamente.</p>
</div>
</section><section class="slide level2"><p>Recordando que <span class="math inline">\(\text{Int}(kU) + 1\)</span> tendrá la misma probabilidad de tomar cualquiera de los valores <span class="math inline">\(1, 2, \ldots, k\)</span>, vemos que el algoritmo anterior para generar una permutación aleatoria puede escribirse de la siguiente manera:</p>
<div class="small">
<div class="alert">
<ul>
<li class="fragment"><p>PASO 1. Sea <span class="math inline">\(P1, P2, \ldots, Pn\)</span> cualquier permutación de <span class="math inline">\(1, 2, \ldots, n\)</span> (por ejemplo, podemos elegir <span class="math inline">\(P_j = j, j = 1,\ldots, n\)</span>).</p></li>
<li class="fragment"><p>PASO 2. Establecer <span class="math inline">\(k = n\)</span>.</p></li>
<li class="fragment"><p>PASO 3. Generar un número aleatorio <span class="math inline">\(U\)</span> y dejar <span class="math inline">\(I = \text{Int}(kU) + 1\)</span>.</p></li>
<li class="fragment"><p>PASO 4. Intercambiar los valores de <span class="math inline">\(P_I\)</span> y <span class="math inline">\(P_k\)</span>.</p></li>
<li class="fragment"><p>PASO 5. Dejar <span class="math inline">\(k = k - 1\)</span> y si <span class="math inline">\(k &gt; 1\)</span>, volver al Paso 3.</p></li>
<li class="fragment"><p>PASO 6. <span class="math inline">\(P1,...,Pn\)</span> es la permutación aleatoria deseada.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Por ejemplo, supongamos <span class="math inline">\(n = 4\)</span> y la permutación inicial es <span class="math inline">\(1, 2, 3, 4\)</span>. Si el primer valor de <span class="math inline">\(I\)</span> (que tiene la misma probabilidad de ser <span class="math inline">\(1, 2, 3\)</span> o <span class="math inline">\(4\)</span>) es <span class="math inline">\(I = 3\)</span>, entonces los elementos en las posiciones <span class="math inline">\(3\)</span> y <span class="math inline">\(4\)</span> se intercambian y así la nueva permutación es <span class="math inline">\(1, 2, 4, 3\)</span>. Si el siguiente valor de <span class="math inline">\(I\)</span> es <span class="math inline">\(I = 2\)</span>, entonces los elementos en las posiciones <span class="math inline">\(2\)</span> y <span class="math inline">\(3\)</span> se intercambian y así la nueva permutación es <span class="math inline">\(1, 4, 2, 3\)</span>. Si el valor final de <span class="math inline">\(I\)</span> es <span class="math inline">\(I = 2\)</span>, entonces la permutación final es <span class="math inline">\(1, 4, 2, 3\)</span>, y este es el valor de la permutación aleatoria.</p></li>
<li class="fragment"><p>Otra manera de generar una permutación aleatoria es generar números aleatorios <span class="math inline">\(U_1, ..., U_n\)</span>, ordenarlos y luego usar los índices de los valores sucesivos como la permutación aleatoria. Por ejemplo, si <span class="math inline">\(n = 4\)</span> y <span class="math inline">\(U_1 = 0.4, U_2 = 0.1, U_3 = 0.8, U_4 = 0.7\)</span>, entonces, debido a que <span class="math inline">\(U_2 &lt; U_1 &lt; U_4 &lt; U_3\)</span>, la permutación aleatoria es 2, 1, 4, 3. La dificultad con este enfoque, sin embargo, es que ordenar los números aleatorios típicamente requiere del orden de <span class="math inline">\(n \log(n)\)</span> comparaciones.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Práctica:</span></p>
<p>Implementar un generador de permutaciones aleatorias, utilizando lo planteado anteriormente en R</p>
</div>
</section></section><section><section id="método-de-aceptación-y-rechazo" class="title-slide slide level1 center" data-background-color="#00A499" data-number="3"><h1>
<span class="header-section-number">3</span> Método de aceptación y rechazo</h1>

</section><section id="la-idea-intuitiva-1" class="slide level2" data-number="3.1"><h2>
<span class="header-section-number">3.1</span> La idea intuitiva</h2>
<p>Supongamos que la función de densidad de probabilidad (pdf) <span class="math inline">\(f\)</span>, está acotada por u intervalo finito <span class="math inline">\(\left[a, b\right]\)</span>, y tiene valor cero fuera de dicho intervalo.</p>
<p>Sea</p>
<p><span class="math display">\[ c= sup\{ f(x): x \in \left[ a,b \right] \}.\]</span></p>

<img data-src="images/rejection_1.png" class="r-stretch quarto-figure-center"><p class="caption">Método de aceptación y rechazo</p></section><section class="slide level2"><div class="definition">
<p>En este caso, el generar una variable aleatoria <span class="math inline">\(Z\sim f\)</span> es muy sencillo, y puede ser implementado al seguir los <span class="green">siguientes pasos de aceptación-rechazo</span>:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(X \sim U(a,b)\)</span>.</p></li>
<li class="fragment"><p>Generar <span class="math inline">\(Y \sim U(0,c)\)</span> independiente de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Y \leq f(X)\)</span>, hacer <span class="math inline">\(Z=X\)</span>. En cualquier otro caso, volver al <em>Paso 1</em>.</p></li>
</ol>
</div>
</div>
<p></p>
<p>Es importante notar que cada vector <span class="math inline">\((X,Y)\)</span> es distribuído de manera uniforme sobre el rectángulo <span class="math inline">\([a, b] \times [0, c]\)</span>. Por lo tanto, el par aceptado <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido bajo la curva de <span class="math inline">\(f\)</span>. Esto implica que la distribución de los valores aceptados de <span class="math inline">\(X\)</span> tiene la densidad de probabilidad deseada <span class="math inline">\(f\)</span>.</p>
</section><section class="slide level2"><p>Podemos generalizar lo anterior de la siguiente manera:</p>
<p>Sea <span class="math inline">\(g\)</span> una densidad arbitraria tal que <span class="math inline">\(\phi(x) = C g(x)\)</span> <a href="https://es.wikipedia.org/wiki/Mayorizaci%C3%B3n"><em>mayoriza</em></a> <span class="math inline">\(f(x)\)</span> para alguna constante <span class="math inline">\(C\)</span>; es decir, que <span class="math inline">\(\phi(x) \geq f(x)\)</span> para todo <span class="math inline">\(x\)</span>. Notar que de necesidad <span class="math inline">\(C \geq 1\)</span>. Llamamos <span class="math inline">\(g(x)\)</span> la <em>pdf de propuesta</em> y asumimos que es fácil generar variables aleatorias de ella.</p>

<img data-src="images/rejection_2.png" class="r-stretch quarto-figure-center"><p class="caption">Método de aceptación y rechazo con una función de mayorización <span class="math inline">\(\phi\)</span></p></section><section class="slide level2"><div class="definition">
<p>Entonces el algoritmo de aceptación-rechazo puede ser escrito de la siguiente manera: </p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(X\)</span> desde <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>Generar <span class="math inline">\(Y \sim U(0,C\; g(X))\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Y \leq f(X)\)</span>, hacer <span class="math inline">\(Z_X\)</span>. En cualquier otro caso, volver al <em>Paso 1</em>.</p></li>
</ol>
</div>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="blue">Teorema:</span></p>
<p>La variable aleatoria generada de acuerdo con el Algoritmo anterior tiene la <em>pdf</em> deseada <span class="math inline">\(f(x)\)</span>.</p>
</div>
<p><strong>Prueba:</strong><br>
Definimos los siguientes dos subconjuntos:</p>
<p><span class="math display">\[
\mathcal{A} = \{ (x, y) : 0 \leq y \leq Cg(x) \} \quad \text{y} \quad \mathcal{B} = \{ (x, y) : 0 \leq y \leq f(x) \},
\]</span></p>
<p>los cuales representan las áreas debajo de las curvas <span class="math inline">\(C\; g(x)\)</span> y <span class="math inline">\(f(x)\)</span>, respectivamente. Note primero que los pasos 1 y 2 del Algoritmo implican que el vector aleatorio <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{A}\)</span>. Para ver esto, sea <span class="math inline">\(q(x, y)\)</span> la <em>pdf</em> conjunta de <span class="math inline">\((X, Y)\)</span>, y sea <span class="math inline">\(g(y | x)\)</span> denotando la <em>pdf</em> condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(X = x\)</span>. Entonces tenemos</p>
<p><span class="math display">\[
q(x, y) =
\begin{cases}
g(x) q(y | x) &amp; \text{si } (x,y) \in \mathcal{A} \\
0 &amp; \text{de otra forma}.
\end{cases}
\]</span></p>
</section><section class="slide level2"><div class="small">
<ul>
<li class="fragment"><p>Ahora, el Paso 2 afirma que <span class="math inline">\(q(y | x)\)</span> es igual a <span class="math inline">\(1 / (Cg(x))\)</span> para <span class="math inline">\(y \in [0, Cg(x)]\)</span> y es cero de otra forma. Por lo tanto, <span class="math inline">\(q(x, y) = C^{-1}\)</span> para cada <span class="math inline">\((x, y) \in \mathcal{A}\)</span>.</p></li>
<li class="fragment"><p>Sea <span class="math inline">\((X^*, Y^*)\)</span> el primer punto aceptado, es decir, el primero que está en <span class="math inline">\(\mathcal{B}\)</span>. Dado que el vector <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{A}\)</span>, entonces el vector <span class="math inline">\((X^*, Y^*)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{B}\)</span>. Además, dado que el área de <span class="math inline">\(\mathcal{B}\)</span> equivale a la unidad, la <em>pdf</em> conjunta de <span class="math inline">\((X^*, Y^*)\)</span> en <span class="math inline">\(\mathcal{B}\)</span> equivale a la unidad también. Así, la <em>pdf</em> marginal de <span class="math inline">\(Z = X^*\)</span> es</p></li>
</ul>
<p><span class="math display">\[ \int_0^{f(x)} 1 dy = f(x). \]</span></p>
<ul>
<li class="fragment">La eficiencia del Algoritmo se define como</li>
</ul>
<p><span class="math display">\[ P((X, Y) \text{ es aceptado}) = \frac{\text{área } \mathcal{B}}{\text{área } \mathcal{A}} = \frac{1}{C}. \]</span></p>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="green">En otras palabras:</span> </p>
<ul>
<li class="fragment"><p>Supongamos que se tiene un método para generar una variable aleatoria que tiene una función de densidad <span class="math inline">\(g(X)\)</span>.</p></li>
<li class="fragment"><p>Podemos usar esto como base para generar desde la distribución continua que tiene una función de densidad <span class="math inline">\(f(x)\)</span> generando <span class="math inline">\(Y\)</span> desde <span class="math inline">\(g\)</span> y luego aceptando este valor generado con una probabilidad proporcional a <span class="math inline">\(\frac{f(Y)}{g(Y)}\)</span>.</p></li>
<li class="fragment"><p>Sea <span class="math inline">\(c\)</span> una constante tal que <span class="math inline">\(\frac{f(y)}{g(y)} &lt; c\)</span> para todo <span class="math inline">\(y\)</span>. Luego tenemos la siguiente técnica para generar una variable aleatoria que tenga densidad <span class="math inline">\(f\)</span>.</p></li>
</ul>
<p><img data-src="images/esquema_aceptacion_rechazo.png"></p>
</div>
</section><section class="slide level2"><div class="definition">
<div class="small">
<ol type="1">
<li class="fragment"><p>Encontrar una variable aleatoria <span class="math inline">\(Y\)</span> con densidad <span class="math inline">\(g\)</span> que satisface <span class="math inline">\(\frac{f(t)}{g(t)} \leq c\)</span>, para todo <span class="math inline">\(t\)</span> tal que <span class="math inline">\(f(t) &gt;0\)</span>. Proveer de un método para generar de manera aleatoria <span class="math inline">\(Y\)</span>.</p></li>
<li class="fragment"><p>Para cada m.a. requerida:</p></li>
</ol>
<ul>
<li class="fragment"><p>PASO 1: Genera <span class="math inline">\(y\)</span> teniendo densidad <span class="math inline">\(g\)</span>.</p></li>
<li class="fragment"><p>PASO 2: Genera un número aleatorio <span class="math inline">\(u \sim U(0,1)\)</span>.</p></li>
<li class="fragment"><p>PASO 3: Si <span class="math inline">\(u &lt; \frac{f(y)}{cg(y)}\)</span>, establece <span class="math inline">\(x = y\)</span>. De lo contrario, rechazar <span class="math inline">\(y\)</span> y regresar al PASO 1.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>Notar que en el Paso 2, <span class="math display">\[ P(\text{aceptar}|Y) = P\left(U &lt; \frac{f(Y)}{cg(Y)} \Big| Y\right) = \frac{f(Y)}{cg(Y)}. \]</span></p>
<p>La última igualdad es simplemente la evaluación de la cdf de <span class="math inline">\(U\)</span>. Por lo tanto, la probabilidad total de aceptación en cualquier iteración es <span class="math display">\[ \sum_{y} P(\text{aceptar}|y)P(Y = y) = \sum_{y} \frac{f(y)}{cg(y)}g(y) = \frac{1}{c}, \]</span></p>
<p>y el número de iteraciones hasta la aceptación tiene la distribución geométrica con media <span class="math inline">\(c\)</span>. Por lo tanto, en promedio cada valor de muestra de <span class="math inline">\(X\)</span> requiere <span class="math inline">\(c\)</span> iteraciones. Para eficiencia, <span class="math inline">\(Y\)</span> debería ser fácil de simular y <span class="math inline">\(c\)</span> pequeño.</p>
</section><section class="slide level2"><p>Para ver que la muestra aceptada tiene la misma distribución que <span class="math inline">\(X\)</span>, aplicamos el Teorema de Bayes. En el caso discreto, para cada <span class="math inline">\(k\)</span> tal que <span class="math inline">\(f(k) &gt; 0\)</span>, <span class="math display">\[ P(k | \text{aceptado}) = \frac{P(\text{aceptado} | k)g(k)}{P(\text{aceptado})} = \frac{[f(k)]/([cg(k)])}{1/c} g(k) = f(k). \]</span></p>
<p>El caso continuo es similar.</p>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Notar que el método de rechazo es exactamente el mismo que en el caso de variables aleatorias discretas, con la única diferencia de que las densidades reemplazan a las funciones de masa.</p></li>
<li class="fragment"><p>De la misma manera que lo hicimos en el caso discreto podemos probar el siguiente resultado.</p></li>
</ul>
<div class="definition">
<div class="small">
<p><span class="blue">Teorema:</span> <br></p>
<ol type="1">
<li class="fragment"><p>La variable aleatoria generada por el método de rechazo tiene densidad <span class="math inline">\(f\)</span>.</p></li>
<li class="fragment"><p>El número de iteraciones del algoritmo que se necesitan es una variable aleatoria geométrica con media <span class="math inline">\(c\)</span>.</p></li>
</ol>
</div>
</div>
<p>Como en el caso discreto, se debe notar que la forma en que uno acepta el valor <span class="math inline">\(Y\)</span> con probabilidad <span class="math inline">\(\frac{f(Y)}{cg(Y)}\)</span> es generando un número aleatorio <span class="math inline">\(U\)</span> y luego aceptando si <span class="math inline">\(U \leq \frac{f(Y)}{cg(Y)}\)</span>.</p>
</section><section class="slide level2"><h3 id="ejemplo-1">Ejemplo</h3>
<p>Vamos a demostrar cómo generar una variable aleatoria <span class="math inline">\(Z\)</span> a partir de la <em>pdf</em></p>
<p><span class="math display">\[
f(x) = \begin{cases}
2x, &amp; 0 \leq x \leq 1 \\
0, &amp; \text{de lo contrario}
\end{cases}
\]</span></p>
<p>utilizando el método de aceptación-rechazo. Por simplicidad, tomemos <span class="math inline">\(g(x) = 1, 0 \leq x \leq 1\)</span>, y <span class="math inline">\(C = 2\)</span>. Es decir, nuestra distribución propuesta es simplemente la distribución uniforme en <span class="math inline">\([0, 1]\)</span>. En este caso, <span class="math inline">\(\frac{f(x)}{Cg(x)} = x\)</span> y el Algoritmo se escribe de la siguiente manera:</p>
<ol type="1">
<li class="fragment"><p>Genera <span class="math inline">\(X\)</span> de <span class="math inline">\(U(0,1)\)</span>.</p></li>
<li class="fragment"><p>Genera <span class="math inline">\(U\)</span> de <span class="math inline">\(U(0,1)\)</span> independientemente de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U \leq X\)</span>, retorna <span class="math inline">\(Z = X\)</span>. De lo contrario, vuelve al Paso 1.</p></li>
</ol>
<p>Notar que este ejemplo es meramente ilustrativo, ya que el método de transformación inversa lo maneja eficientemente.</p>
</section><section class="slide level2"><p>Como consecuencia de (2.14), la eficiencia del método de aceptación-rechazo modificado se determina nuevamente por la probabilidad de aceptación <span class="math inline">\(p = P(U \leq \frac{f(X)}{(Cg(X))}) = P(Y \leq f(X)) = \frac{1}{C}\)</span> para cada intento <span class="math inline">\((X, U)\)</span>. Dado que los intentos son independientes, el número de intentos, <span class="math inline">\(N\)</span>, antes de que ocurra un par exitoso <span class="math inline">\((Z, U)\)</span> tiene la siguiente distribución geométrica:</p>
<p><span class="math display">\[
P(N = n) = p(1 - p)^{n-1}, \quad n = 1, 2, \ldots,
\]</span></p>
<p>con el número esperado de intentos igual a <span class="math inline">\(\frac{1}{p} = C\)</span>.</p>
<p>Para que este método sea de interés práctico, se deben usar los siguientes criterios al seleccionar la densidad de propuesta <span class="math inline">\(g(x)\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Debe ser fácil generar una variable aleatoria de <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>La eficiencia, <span class="math inline">\(\frac{1}{C}\)</span>, del procedimiento debe ser grande, es decir, <span class="math inline">\(C\)</span> debería estar cerca de 1 (lo que ocurre cuando <span class="math inline">\(g(x)\)</span> está cerca de <span class="math inline">\(f(x)\)</span>).</p></li>
</ol></section><section class="slide level2"><h3 id="ejemplo-2">Ejemplo</h3>
<p>Genera una variable aleatoria <span class="math inline">\(Z\)</span> de la densidad semicircular</p>
<p><span class="math display">\[
f(x) = \frac{2}{\pi R^2}\sqrt{R^2 - x^2}, \quad -R \leq x \leq R.
\]</span></p>
<p>Toma la distribución propuesta para ser uniforme sobre <span class="math inline">\([-R, R]\)</span>, esto es, toma <span class="math inline">\(g(x) = \frac{1}{2R}\)</span>, <span class="math inline">\(-R \leq x \leq R\)</span> y elige <span class="math inline">\(C\)</span> tan pequeño como sea posible tal que <span class="math inline">\(Cg(x) \geq f(x)\)</span>; por ende, <span class="math inline">\(C = \frac{4}{\pi}\)</span>. Entonces el Algoritmo 2.3.6 conduce al siguiente algoritmo de generación:</p>
<ol type="1">
<li class="fragment"><p>Genera dos variables aleatorias independientes, <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span>, de <span class="math inline">\(U(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Usa <span class="math inline">\(U_2\)</span> para generar <span class="math inline">\(X\)</span> de <span class="math inline">\(g(x)\)</span> vía el método de transformación inversa, es decir, <span class="math inline">\(X = (2U_2 - 1)R\)</span>, y calcula</p></li>
</ol>
<p><span class="math display">\[
\frac{f(X)}{Cg(X)} = \sqrt{1 - (2U_2 - 1)^2}.
\]</span></p>
<ol start="3" type="1">
<li class="fragment">Si <span class="math inline">\(U_1 \leq \frac{f(X)}{Cg(X)}\)</span>, lo cual es equivalente a <span class="math inline">\((2U_2 - 1)^2 \leq 1 - U_1^2\)</span>, retorna <span class="math inline">\(Z = X = (2U_2 - 1)R\)</span>; de otra manera, regresa al Paso 1.</li>
</ol>
<p>El número esperado de intentos para este algoritmo es <span class="math inline">\(C = \frac{4}{\pi}\)</span>, y la eficiencia es <span class="math inline">\(\frac{1}{C} = \frac{\pi}{4} \approx 0.785\)</span>.</p>
</section><section class="slide level2"><h3 id="ejemplo-distribución-beta">Ejemplo: Distribución <em>Beta</em>
</h3>
<div class="example">
<p>¿Cuántos números pseudo aleatorios debenser simulados en promedio para generar 1000 muestras desde la distribución <span class="math inline">\(Beta(\alpha=2, \beta=2)\)</span>, empleando este método? <br></p>
<ul>
<li class="fragment"><p>Dependerá del límite superior <span class="math inline">\(c\)</span> de <span class="math inline">\(\frac{f(x)}{g(x)}\)</span>, que depende de la elección de la función <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>La densidad <span class="math inline">\(Beta(2,2)\)</span> es <span class="math inline">\(f(x)=6x(1-x), 0&lt;x&lt;1\)</span>. Sea <span class="math inline">\(g(x)\)</span> la densidad <span class="math inline">\(Uniforme(0,1)\)</span>. Entonces <span class="math inline">\(\frac{f(x)}{g(x)} \leq 6\)</span> para todo <span class="math inline">\(0&lt;x&lt;1\)</span>, así <span class="math inline">\(c=6\)</span>.</p></li>
<li class="fragment"><p>Una muestra aleatoria <span class="math inline">\(x\)</span> desde <span class="math inline">\(g(x)\)</span> es aceptada si <span class="math display">\[\frac{f(x)}{c \, g(x)} = \frac{6x(1-x)}{6(1)} = x(1-x)&gt;u\]</span></p></li>
</ul>
</div>
</section><section class="slide level2"><p>En promedio, <span class="math inline">\(c \, n = 6000\)</span> iteraciones (12000 números aleatorios) serán requeridos para un tamaño de muestra igual a 1000. Podemos comprobarlo en la siguiente simulación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-2"><a href=""></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-3"><a href=""></a><span class="co">#Contador para aceptación</span></span>
<span id="cb25-4"><a href=""></a>contador <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-5"><a href=""></a><span class="co">#iteraciones</span></span>
<span id="cb25-6"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb25-7"><a href=""></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb25-8"><a href=""></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-9"><a href=""></a>  contador <span class="ot">&lt;-</span> contador <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-10"><a href=""></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-11"><a href=""></a>  <span class="co">#muestra aleatoria desde g</span></span>
<span id="cb25-12"><a href=""></a>  <span class="cf">if</span> (x <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb25-13"><a href=""></a>    <span class="co">#aceptamos x</span></span>
<span id="cb25-14"><a href=""></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-15"><a href=""></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb25-16"><a href=""></a>  }</span>
<span id="cb25-17"><a href=""></a>}</span>
<span id="cb25-18"><a href=""></a><span class="fu">print</span>(contador)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5852</code></pre>
</div>
</div>
</section><section class="slide level2"><p>En esta simulación, 5852 iteraciones fueron requeridas para generar 1000 muestras <em>Beta</em>. Comparamos los percentiles teóricos y empíricos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-2"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb27-3"><a href=""></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb27-4"><a href=""></a><span class="co">#Comparación de percentiles teóricos y empíricos</span></span>
<span id="cb27-5"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>)</span>
<span id="cb27-6"><a href=""></a>Qhat <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, p)</span>
<span id="cb27-7"><a href=""></a><span class="co">#Cuantiles de la muestra</span></span>
<span id="cb27-8"><a href=""></a>Q <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(p, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb27-9"><a href=""></a><span class="co">#Cuantiles teóricos</span></span>
<span id="cb27-10"><a href=""></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">/</span> (n <span class="sc">*</span> <span class="fu">dbeta</span>(Q, <span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb27-11"><a href=""></a></span>
<span id="cb27-12"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(Qhat, Q, se), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href=""></a>  <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">'X'</span>)), <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">seq_along</span>(.), <span class="st">'0%'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-15"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 25px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">10%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">20%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">30%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">40%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">50%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">60%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">70%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">80%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">90%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Qhat</td>
<td style="text-align: center;">0.194</td>
<td style="text-align: center;">0.281</td>
<td style="text-align: center;">0.366</td>
<td style="text-align: center;">0.435</td>
<td style="text-align: center;">0.499</td>
<td style="text-align: center;">0.564</td>
<td style="text-align: center;">0.638</td>
<td style="text-align: center;">0.711</td>
<td style="text-align: center;">0.807</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q</td>
<td style="text-align: center;">0.196</td>
<td style="text-align: center;">0.287</td>
<td style="text-align: center;">0.363</td>
<td style="text-align: center;">0.433</td>
<td style="text-align: center;">0.500</td>
<td style="text-align: center;">0.567</td>
<td style="text-align: center;">0.637</td>
<td style="text-align: center;">0.713</td>
<td style="text-align: center;">0.804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">se</td>
<td style="text-align: center;">0.010</td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.010</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section></section><section><section id="métodos-de-transformación" class="title-slide slide level1 center" data-background-color="#00A499" data-number="4"><h1>
<span class="header-section-number">4</span> Métodos de transformación</h1>

</section><section class="slide level2"><p>Muchos tipos de transformaciones además del método de transformación inversa de probabilidad pueden aplicarse para simular variables aleatorias. Algunos ejemplos son:</p>
<ol type="1">
<li class="fragment"><p>Si <span class="math inline">\(Z \sim N(0,1)\)</span>, entonces <span class="math inline">\(V = Z^2 \sim \chi^2(1)\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U \sim \chi^2(m)\)</span> y <span class="math inline">\(V \sim \chi^2(n)\)</span> son independientes, entonces <span class="math inline">\(F = \frac{U/m}{V/n}\)</span> tiene la distribución F con <span class="math inline">\((m, n)\)</span> grados de libertad.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Z \sim N(0,1)\)</span> y <span class="math inline">\(V \sim \chi^2(n)\)</span> son independientes, entonces <span class="math inline">\(T = \frac{Z}{\sqrt{V/n}}\)</span> tiene la distribución t de Student con <span class="math inline">\(n\)</span> grados de libertad.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U, V \sim \text{Unif}(0,1)\)</span> son independientes, entonces</p></li>
</ol>
<p><span class="math display">\[\begin{eqnarray}
  Z_1 =&amp; \sqrt{-2 \log U} \cos(2\pi V), \\
  Z_2 =&amp; \sqrt{-2 \log V} \sin(2\pi U)
\end{eqnarray}\]</span></p>
<p>son variables normales estándar independientes.</p>
</section><section class="slide level2"><ol start="5" type="1">
<li class="fragment"><p>Si <span class="math inline">\(U \sim \text{Gamma}(r, \lambda)\)</span> y <span class="math inline">\(V \sim \text{Gamma}(s, \lambda)\)</span> son independientes, entonces <span class="math inline">\(X = \frac{U}{U+V}\)</span> tiene la distribución Beta<span class="math inline">\((r, s)\)</span>.</p></li>
<li class="fragment">
<p>Si <span class="math inline">\(U, V \sim \text{Unif}(0,1)\)</span> son independientes, entonces</p>
<p><span class="math display">\[
X = \left\lfloor 1 + \frac{\log(V)}{\log(1 - (1 - \theta)U)} \right\rfloor
\]</span></p>
<p>tiene la distribución Logarítmica<span class="math inline">\((\theta)\)</span>, donde <span class="math inline">\(\left\lfloor x \right\rfloor\)</span> denota la parte entera de <span class="math inline">\(x\)</span>.</p>
</li>
</ol></section><section class="slide level2"><p>Recuerdan esta figura?</p>

<img data-src="images/distribution_relationship_map.png" class="r-stretch quarto-figure-center"><p class="caption">Ejemplo de algunas relaciones entre distribuciones univariadas</p><div class="alert">
<p><span class="orange">Enlaces con información más detallada:</span></p>
<ul>
<li class="fragment"><p><a href="https://www.johndcook.com/blog/distribution_chart/">Diagrama de relaciones entre distribuciones</a></p></li>
<li class="fragment"><p><a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">Un diagrama un poco más detallado</a></p></li>
</ul>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribución-beta-nuevamente">Ejemplo: Distribución <em>Beta</em> (nuevamente)</h3>
<div class="example">
<p>La siguiente relación entre la <span class="green">distribución Beta y Gamma</span> nos permite implementar otro RNG para la <span class="orange">distribución Beta</span>:</p>
<blockquote>
<p>Si <span class="math inline">\(U \sim \text{Gamma}(r, \lambda)\)</span> y <span class="math inline">\(V \sim \text{Gamma}(s, \lambda)\)</span> son independientes, entonces <span class="math inline">\(X = \frac{U}{U+V}\)</span> tiene la distribución Beta<span class="math inline">\((r, s)\)</span>.</p>
</blockquote>
</div>
<p>Por lo tanto, podemos implementar un algoritmo para generar muestras aleatorias <span class="math inline">\(Beta(r,s)\)</span></p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Gamma(a,1)\)</span>.</p></li>
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(v\)</span> desde una distribución <span class="math inline">\(Gamma(b,1)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(\frac{u}{u+v}\)</span>.</p></li>
</ol>
</div>
</section><section class="slide level2"><p>Para generar una muestra aleatoria proveniente de una <span class="green">distribución <span class="math inline">\(Beta(3,2)\)</span></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-2"><a href=""></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb28-3"><a href=""></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb28-4"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>a, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb28-5"><a href=""></a>v <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>b, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb28-6"><a href=""></a>x <span class="ot">&lt;-</span> u <span class="sc">/</span> (u <span class="sc">+</span> v)</span>
<span id="cb28-7"><a href=""></a><span class="fu">print</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.1785884 0.5445075 0.6947001 0.8656039 0.7633113 0.3117103 0.5346568
  [8] 0.8551243 0.4379071 0.8046751 0.2538818 0.5789318 0.5006593 0.8055877
 [15] 0.4205466 0.6996796 0.6928022 0.7532208 0.3630649 0.7803501 0.3820578
 [22] 0.4037790 0.9615570 0.8167136 0.7110212 0.3081472 0.7873189 0.7395515
 [29] 0.6611742 0.7910903 0.3210334 0.3106950 0.7575779 0.5996522 0.2604717
 [36] 0.6301943 0.9678052 0.3886486 0.6888294 0.6467294 0.3686549 0.6521048
 [43] 0.4933808 0.7119907 0.8980924 0.6543846 0.2475923 0.7744678 0.2019214
 [50] 0.7368245 0.5550486 0.5219131 0.6740776 0.3740246 0.2638140 0.9644488
 [57] 0.3797149 0.4749358 0.5314753 0.7847241 0.9458239 0.7461899 0.4594762
 [64] 0.4362033 0.4881184 0.3436201 0.7081080 0.4732468 0.5033110 0.4796188
 [71] 0.7606784 0.5098181 0.6434120 0.5395007 0.9609418 0.3968011 0.7118716
 [78] 0.2325506 0.3684421 0.5762307 0.4399937 0.7502540 0.6135231 0.3064664
 [85] 0.6814964 0.7573213 0.8521979 0.5285770 0.7986032 0.3255244 0.6870631
 [92] 0.5110796 0.3010627 0.7351797 0.5629944 0.6352725 0.7874648 0.3909429
 [99] 0.7879142 0.7321640</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Podemos comparar la muestra obtenida con la distribución <span class="math inline">\(Beta(3,2)\)</span>, utilizando un gráfico de cuantíl-cuantíl (<span class="green">Quantile-Quantile plot, QQ plot</span>). Si las distribuciones son similares, el gráfico debería parecerse:</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1">Usando R-Base</a></li>
<li><a href="#tabset-2-2">Usando GGplot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>q <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fu">ppoints</span>(n), a, b)</span>
<span id="cb30-2"><a href=""></a><span class="fu">qqplot</span>(q, x, <span class="at">cex=</span><span class="fl">0.25</span>, <span class="at">xlab=</span><span class="st">"Beta(3, 2)"</span>, <span class="at">ylab=</span><span class="st">"Sample"</span>)</span>
<span id="cb30-3"><a href=""></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb31-3"><a href=""></a><span class="fu">data.frame</span>(x, q) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href=""></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample=</span>x), </span>
<span id="cb31-6"><a href=""></a>          <span class="at">distribution =</span> stats<span class="sc">::</span>qbeta, </span>
<span id="cb31-7"><a href=""></a>          <span class="at">dparams =</span> <span class="fu">c</span>(a,b), </span>
<span id="cb31-8"><a href=""></a>          <span class="at">color=</span><span class="st">"green4"</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href=""></a>  <span class="fu">stat_qq_line</span>(<span class="fu">aes</span>(<span class="at">sample=</span>x),</span>
<span id="cb31-10"><a href=""></a>               <span class="at">distribution =</span> stats<span class="sc">::</span>qbeta, </span>
<span id="cb31-11"><a href=""></a>               <span class="at">dparams =</span> <span class="fu">c</span>(a,b),</span>
<span id="cb31-12"><a href=""></a>               <span class="at">color=</span><span class="st">"orange1"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb31-13"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Muestra generada"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Beta(3,2)"</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-25-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>La línea <span class="math inline">\(x=q\)</span> se añade para referencia. El <span class="orange">QQplot de la muestra generada vs la <span class="math inline">\(Beta(3,2)\)</span> es muy similar a una línea recta</span>, como debería ser si es que efectivamente la distribución de la muestra generada a través del RNG es <span class="math inline">\(Beta\)</span>.</p>
</section><section class="slide level2"><h3 id="ejemplo-distribución-logarítmica">Ejemplo: Distribución <em>Logarítmica</em>
</h3>
<div class="example">
<p>Implementaremos un RNG para muestras a partir de una <span class="green">distribución Logarítmica</span>.</p>
<blockquote>
<p>Si <span class="math inline">\(U,V\)</span> son v.a. i.i.d. Uniforme<span class="math inline">\((0,1)\)</span>, entonces <span class="math display">\[ X = \left\lfloor 1+ \frac{log(V)}{log(1-1(1-\theta)^U)} \right\rfloor\]</span> Se distribuye <span class="math inline">\(Log(\theta)\)</span>.</p>
</blockquote>
</div>
<p>Por lo tanto, podemos implementar un algoritmo para generar muestras aleatorias <span class="math inline">\(Log(\theta)\)</span>:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Unif(0,1)\)</span>.</p></li>
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(v\)</span> desde una distribución <span class="math inline">\(Unif(0,1)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(x = \left\lfloor 1+ \frac{log(v)}{log(1-1(1-\theta)^u)} \right\rfloor\)</span>.</p></li>
</ol>
</div>
</section><section class="slide level2"><p>Comparamos la distribución <span class="math inline">\(Log(\frac{1}{2})\)</span> con una muestra generada a través de nuestro RNG, utilizando la transformación planteada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb32-2"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb32-3"><a href=""></a><span class="co"># Muestras Uniformes</span></span>
<span id="cb32-4"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb32-5"><a href=""></a>v <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb32-6"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(v) <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>u)) <span class="co"># Transformación a Log</span></span>
<span id="cb32-7"><a href=""></a>k <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(x)</span>
<span id="cb32-8"><a href=""></a>p <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> theta<span class="sc">^</span>k <span class="sc">/</span> k <span class="co">#calcula probabilidades</span></span>
<span id="cb32-9"><a href=""></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb32-10"><a href=""></a>p.hat <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(x)<span class="sc">/</span>n</span>
<span id="cb32-11"><a href=""></a></span>
<span id="cb32-12"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb32-13"><a href=""></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb32-14"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(p.hat, p, se), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-15"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="at">col.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb32-17"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 25px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">4</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">6</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">7</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p.hat</td>
<td style="text-align: center;">0.705</td>
<td style="text-align: center;">0.177</td>
<td style="text-align: center;">0.067</td>
<td style="text-align: center;">0.031</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.005</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">p</td>
<td style="text-align: center;">0.721</td>
<td style="text-align: center;">0.180</td>
<td style="text-align: center;">0.060</td>
<td style="text-align: center;">0.023</td>
<td style="text-align: center;">0.009</td>
<td style="text-align: center;">0.004</td>
<td style="text-align: center;">0.002</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">se</td>
<td style="text-align: center;">0.014</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.008</td>
<td style="text-align: center;">0.005</td>
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">0.002</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Se muestran las probabilidades empíricas <code>p.hat</code>, las probabilidades teóricas <code>p</code>, y el error estándar <code>se</code>.</p>
</section></section><section id="referencias" class="title-slide slide level1 smaller scrollable" data-background-color="#00A499" data-number="5"><h1>
<span class="header-section-number">5</span> Referencias</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Fisher1936" class="csl-entry" role="listitem">
Fisher, Ronald Aylmer et&nbsp;al. 1936. <span>«Statistical methods for research workers.»</span> <em>Statistical methods for research workers.</em>, n.º 6th Ed.
</div>
</div>
<div class="quarto-auto-generated-content">
<p><img src="images/Usach_P2.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/notes/notes.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/search/search.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"d455d1a19a55b0f5","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>