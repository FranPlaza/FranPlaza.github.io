<!DOCTYPE html>
<html lang="es"><head>
<script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/clipboard/clipboard.min.js"></script>
<script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/tabby.min.js"></script>
<script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/popper.min.js"></script>
<script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="author" content="Francisco Plaza Vega">
<title>Simulación Estadística</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/dist/theme/quarto.css">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Simulación Estadística</h1>
  <p class="subtitle">Unidad 1: Generando números pseudo aleatorios</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Francisco Plaza Vega 
</div>
<div class="quarto-title-author-email">
<a href="mailto:francisco.plaza.v@usach.cl">francisco.plaza.v@usach.cl</a>
</div>
        <p class="quarto-title-affiliation">
            Ingeniería en Estadística
          </p>
    </div>
</div>

</section><section><section id="simulación-estadística" class="title-slide slide level1 center" data-background-color="#00A499" data-number="1"><h1>
<span class="header-section-number">1</span> Simulación Estadística</h1>

</section><section id="qué-es-la-simulación" class="slide level2" data-number="1.1"><h2>
<span class="header-section-number">1.1</span> ¿Qué es la simulación?</h2>
<div class="definition">
<p>El acto de <span class="green">“<em>simular</em>”</span>:<br></p>
<ul>
<li class="fragment"><p>Según el <a href="https://www.rae.es/drae2001/simular">Diccionario de la Lengua Española de la RAE</a>, <span class="green">“<em>simular</em>”</span> significa representar algo, fingiendo o imitando lo que no es.</p></li>
<li class="fragment"><p>De acuerdo con <a href="https://es.thefreedictionary.com/simular">TheFreeDictionary</a>, <span class="green">“<em>simular</em>”</span> es hacer creer una cosa que no es verdad con palabras, gestos o acciones, y también se refiere a representar algo fingiendo lo que no es.</p></li>
<li class="fragment"><p><a href="https://www.wordreference.com/definicion/simular#:~:text=tr.,simul%C3%B3%20que%20no%20le%20importaba.">WordReference</a> define <span class="green">“<em>simular</em>”</span> como representar una cosa fingiendo o imitando lo que no es.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="definition">
<p><span class="green">de ChatGPT</span><br><em>Estas definiciones resaltan la idea de crear una apariencia o representación de algo que no es real o verdadero, ya sea mediante acciones, palabras o gestos. En un contexto más amplio, la simulación puede usarse en diversos campos, como la ciencia, la tecnología y el arte, para representar o modelar situaciones, procesos o sistemas de manera virtual o teórica.</em> <br></p>
<p><em>El término “simular” proviene del latín “<em>simulāre</em>” y tiene varias definiciones que se centran en la idea de representación o imitación</em></p>
</div>
</section><section class="slide level2"><p>La experimentación directa sobre la realidad puede tener muchos inconvenientes, entre otros:</p>
<ul>
<li class="fragment"><p><span class="green">Coste elevado</span>: por ejemplo cuando las pruebas son destructivas o si es necesario esperar mucho tiempo para observar los resultados.</p></li>
<li class="fragment"><p><span class="green">Puede no ser ética</span>: por ejemplo la experimentación sobre seres humanos o la dispersión de un contaminante.</p></li>
<li class="fragment"><p><span class="green">Puede resultar imposible</span>: por ejemplo cuando se trata de un acontecimiento futuro o una alternativa en el pasado.</p></li>
</ul></section><section id="simulación-estadística-1" class="slide level2" data-number="1.2"><h2>
<span class="header-section-number">1.2</span> Simulación estadística</h2>
<div class="small">
<ul>
<li class="fragment"><p>Para estadísticos e investigadores, el término <span class="green">‘simulación’</span> describe una gran cantidad de técnicas variadas y útiles, todas relacionadas con la imitación de las reglas de un modelo de algún tipo. Estas técnicas permiten a los investigadores y analistas estudiar y predecir el comportamiento del sistema bajo diferentes condiciones y escenarios sin necesidad de experimentos físicos o reales.</p></li>
<li class="fragment"><p>En la simulación estadística, se emplean modelos probabilísticos para representar la incertidumbre y la variabilidad inherente a los fenómenos reales. Estos modelos pueden ser tan simples como distribuciones de probabilidad básicas o tan complejos como sistemas dinámicos y redes neuronales. Al ejecutar la simulación múltiples veces, se obtienen distribuciones de resultados que ayudan a comprender mejor el sistema y a evaluar riesgos, eficiencia, y otras métricas importantes.</p></li>
<li class="fragment"><p>El objetivo es a menudo explorar <span class="green">“qué pasaría si”</span> en situaciones donde los experimentos reales son impracticables, costosos, peligrosos o éticamente inviables.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="blue">Por ejemplo:</span><br></p>
<ul>
<li class="fragment"><p><span class="green">En ingeniería</span>, los estudios de simulación pueden usarse para predecir cómo se comportará una estructura bajo ciertas cargas sin tener que construirla físicamente.</p></li>
<li class="fragment"><p><span class="green">En finanzas</span>, pueden ayudar a evaluar los riesgos de diferentes inversiones o estrategias de mercado.</p></li>
<li class="fragment"><p><span class="green">En medicina</span>, se pueden utilizar para prever la progresión de enfermedades o la respuesta a distintos tratamientos.</p></li>
</ul>
</div>
<p><br></p>
<div class="fragment">
<p>Los estudios de simulación <span class="green"><em>dependen de la generación de datos y escenarios artificiales</em></span>, pero <span class="green">buscan producir resultados que sean lo suficientemente precisos</span> y realistas como para informar decisiones o entender mejor un sistema o fenómeno.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="blue">Ejemplo práctico</span><br> Supongamos que comenzamos a coleccionar láminas para un álbum con <span class="math inline">\(n = 75\)</span> láminas, que se venden sobres con <span class="math inline">\(m = 6\)</span> láminas y cada sobre tiene un costo de <span class="math inline">\(\$800\)</span>, y que estamos interesados en el número de sobres que hay que comprar para completar la colección, por ejemplo en su valor medio.</p>
</div>
<p><br></p>
<div class="fragment">
<p>Podemos aproximar la distribución del número de sobres para completar la colección a partir de <span class="math inline">\(nsim = 1000\)</span> simulaciones de coleccionistas de láminas</p>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column" style="width:50%;">
<h3 id="código">Código</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Parámetros</span></span>
<span id="cb1-2"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># Número total de láminas del álbum</span></span>
<span id="cb1-3"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">6</span>  <span class="co"># Número de láminas en cada sobre</span></span>
<span id="cb1-4"><a href=""></a>repe <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Láminas repetidas en cada sobre</span></span>
<span id="cb1-5"><a href=""></a><span class="co"># Número de simulaciones</span></span>
<span id="cb1-6"><a href=""></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-7"><a href=""></a><span class="co"># Resultados simulación</span></span>
<span id="cb1-8"><a href=""></a>nsobres <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb1-9"><a href=""></a><span class="co"># evol &lt;- vector("list", nsim)</span></span>
<span id="cb1-10"><a href=""></a><span class="co"># Fijar semilla</span></span>
<span id="cb1-11"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-12"><a href=""></a><span class="co"># Bucle simulación</span></span>
<span id="cb1-13"><a href=""></a><span class="cf">for</span> (isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb1-14"><a href=""></a>  <span class="co"># seed &lt;- .Random.seed    # .Random.seed &lt;- seed</span></span>
<span id="cb1-15"><a href=""></a>  album <span class="ot">&lt;-</span> <span class="fu">logical</span>(n)</span>
<span id="cb1-16"><a href=""></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Número de sobres</span></span>
<span id="cb1-17"><a href=""></a>  <span class="cf">while</span>(<span class="fu">sum</span>(album) <span class="sc">&lt;</span> n) {</span>
<span id="cb1-18"><a href=""></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-19"><a href=""></a>    album[<span class="fu">sample</span>(n,m, <span class="at">replace =</span> repe)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-20"><a href=""></a>  }</span>
<span id="cb1-21"><a href=""></a>  nsobres[isim] <span class="ot">&lt;-</span> i</span>
<span id="cb1-22"><a href=""></a>}</span>
<span id="cb1-23"><a href=""></a></span>
<span id="cb1-24"><a href=""></a><span class="fu">hist</span>(nsobres, <span class="at">breaks =</span> <span class="st">"FD"</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-25"><a href=""></a>     <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"Número de sobres"</span>)</span>
<span id="cb1-26"><a href=""></a><span class="fu">lines</span>(<span class="fu">density</span>(nsobres))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<h3 id="histograma">Histograma</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column" style="width:50%;">
<div class="small">
<p>Aproximación por simulación del número medio de sobres para completar la colección:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">mean</span>(nsobres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.775</code></pre>
</div>
</div>
<p><br></p>
<div class="small">
<p>Número mínimo de sobres para asegurar de que se completa la colección con una probabilidad del 95%:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">quantile</span>(nsobres, <span class="at">probs =</span> <span class="fl">0.95</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% 
 92 </code></pre>
</div>
</div>
<p><br></p>
<div class="small">
<p>Reserva de dinero para poder completar la colección el 95% de las veces:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">quantile</span>(nsobres, <span class="at">probs =</span> <span class="fl">0.95</span>)<span class="sc">*</span><span class="dv">800</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% 
73600 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Aproximaciones por simulación de la distribución del número de sobres para completar la colección, de su valor esperado (línea vertical continua) y del cuantil 0.95 (línea vertical discontinua).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>sol <span class="ot">=</span> <span class="fu">mean</span>(nsobres)</span>
<span id="cb8-2"><a href=""></a>nmin <span class="ot">=</span> <span class="fu">quantile</span>(nsobres, <span class="at">probs =</span> <span class="fl">0.95</span>)</span>
<span id="cb8-3"><a href=""></a><span class="fu">hist</span>(nsobres, <span class="at">breaks =</span> <span class="st">"FD"</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-4"><a href=""></a>     <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"Número de sobres"</span>)</span>
<span id="cb8-5"><a href=""></a><span class="fu">lines</span>(<span class="fu">density</span>(nsobres))</span>
<span id="cb8-6"><a href=""></a><span class="fu">abline</span>(<span class="at">v =</span> sol)</span>
<span id="cb8-7"><a href=""></a><span class="fu">abline</span>(<span class="at">v =</span> nmin, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="aplicaciones-de-simulación" class="slide level2" data-number="1.3"><h2>
<span class="header-section-number">1.3</span> Aplicaciones de simulación</h2>
<p>La simulación resulta de utilidad en multitud de contextos diferentes. Los principales campos de aplicación en estadística pueden ser:</p>
<ul>
<li class="fragment"><p>Muestreo, remuestreo…</p></li>
<li class="fragment"><p>Aproximación de distribuciones (de estadísticos, estimadores…)</p></li>
<li class="fragment"><p>Realización de contrastes, intervalos de confianza…</p></li>
<li class="fragment"><p>Comparación de estimadores, contrastes…</p></li>
<li class="fragment"><p>Validación teoría (distribución asintótica…)</p></li>
<li class="fragment"><p>Inferencia Bayesiana</p></li>
</ul></section><section id="tipos-de-números-aleatorios" class="slide level2" data-number="1.4"><h2>
<span class="header-section-number">1.4</span> Tipos de números aleatorios</h2>
<p>El primer requisito para poder realizar simulación estocástica sería disponer de números aleatorios. Se distingue entre tres tipos de secuencias:</p>
<ul>
<li class="fragment"><p><span class="orange">números aleatorios puros (true random):</span> se caracteriza porque no existe ninguna regla o plan que nos permita conocer sus valores.</p></li>
<li class="fragment"><p><span class="orange">números pseudo-aleatorios:</span> simulan realizaciones de una variable aleatoria (uniforme),</p></li>
<li class="fragment"><p><span class="orange">números cuasi-aleatorios:</span> secuencias deterministas con una distribución más regular en el rango considerado.</p></li>
</ul></section><section class="slide level2"><h3 id="números-aleatorios-puros">Números aleatorios puros</h3>
<p>Normalmente son obtenidos por procesos físicos (loterías, ruletas, ruidos…) y, hasta hace una décadas, se almacenaban en tablas de dígitos aleatorios. Por ejemplo, en 1955 la Corporación RAND publicó el libro <span class="orange"><em>A Million Random Digits with 100,000 Normal Deviates</em></span> que contenía números aleatorios generados mediante una ruleta electrónica conectada a una computadora</p>

<img data-src="images/rand_book.jpg" style="width:20.0%" class="r-stretch quarto-figure-center"><p class="caption">Portada del libro <em>A Million Random Digits with 100,000 Normal Deviates</em> <span class="citation" data-cites="hammersley1955million">(<a href="#/referencias" role="doc-biblioref" onclick="">Hammersley 1955</a>)</span>.</p></section><section class="slide level2"><p>El procedimiento que se utilizaba para seleccionar de una tabla, de forma manual, números aleatorios en un rango de 1 a <span class="math inline">\(m\)</span> era el siguiente:</p>
<ul>
<li class="fragment"><p>Se selecciona al azar un punto de inicio en la tabla y la dirección que se seguirá.</p></li>
<li class="fragment"><p>Se agrupan los dígitos de forma que “cubran” el valor de <span class="math inline">\(m\)</span>.</p></li>
<li class="fragment"><p>Se va avanzado en la dirección elegida, seleccionando los valores menores o iguales que <span class="math inline">\(m\)</span> y descartando el resto.</p></li>
</ul></section><section class="slide level2"><h3 id="números-cuasi-aleatorios">Números cuasi-aleatorios</h3>
<p>Algunos problemas, como la integración numérica (que veremos más adelante en este curso), no dependen realmente de la aleatoriedad de la secuencia. Para evitar generaciones poco probables, se puede recurrir a secuencias <span class="orange"><em>cuasi-aleatorias</em></span>, también denominadas sucesiones de baja discrepancia (hablaríamos entonces de métodos cuasi-Monte Carlo, por ejemplo). La idea sería que la proporción de valores en una región cualquiera sea siempre aproximadamente proporcional a la medida de la región (como sucedería en media con la distribución uniforme, aunque no necesariamente para una realización concreta).</p>
</section><section class="slide level2"><p>Por ejemplo, el paquete randtoolbox de R implementa métodos para la generación de secuencias cuasi-aleatorias</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">library</span>(randtoolbox)</span>
<span id="cb9-2"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb9-3"><a href=""></a>par.old <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb9-4"><a href=""></a><span class="fu">plot</span>(<span class="fu">halton</span>(n, <span class="at">dim =</span> <span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">'x1'</span>, <span class="at">ylab =</span> <span class="st">'x2'</span>)</span>
<span id="cb9-5"><a href=""></a><span class="fu">plot</span>(<span class="fu">sobol</span>(n, <span class="at">dim =</span> <span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">'x1'</span>, <span class="at">ylab =</span> <span class="st">'x2'</span>)</span>
<span id="cb9-6"><a href=""></a><span class="fu">plot</span>(<span class="fu">torus</span>(n, <span class="at">dim =</span> <span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">'x1'</span>, <span class="at">ylab =</span> <span class="st">'x2'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">Secuencias cuasi-aleatorias bidimensionales obtenidas con los métodos de Halton (izquierda), Sobol (centro) y Torus (derecha).</p></section><section class="slide level2"><h3 id="números-pseudo-aleatorios">Números pseudo-aleatorios</h3>
<p>La mayoría de los métodos de simulación se basan en la posibilidad de <span class="orange">generar números pseudo-aleatorios</span> que imiten las propiedades de valores independientes de la distribución <span class="math inline">\(U \sim (0,1)\)</span>, es decir, que imiten las propiedades de una muestra aleatoria simple<sup>1</sup> de esta distribución.</p>
<p>El procedimiento habitual para obtener estas secuencias es emplear un algoritmo recursivo denominado generador:</p>
<p><span class="math display">\[x_i = f(x_{i-1}, x_{i-2}, \ldots, x_{i-k})\]</span></p>
<p>donde: <span class="math inline">\(k\)</span> es el orden del generador y <span class="math inline">\((x_{0}, x_{1}, \ldots, x_{k-1})\)</span> es la semilla (estado inicial).</p>
<p>El periodo o longitud del ciclo es la longitud de la secuencia antes de que vuelva a repetirse. Lo denotaremos por <span class="math inline">\(p\)</span>.</p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Se debe distinguir entre secuencia y muestra. En un problema de <span class="green">inferencia</span>, en principio estamos interesados en una característica desconocida de la población. En cambio, en un problema de <span class="green">simulación</span>, <span class="orange">la población</span> es el modelo y lo conocemos por completo (no obstante el problema de simulación puede surgir como solución de un problema de inferencia)</p></li></ol></aside></section><section class="slide level2"><div class="definition">
<p>Los números de la sucesión son predecibles, conociendo el <span class="green">algoritmo</span> y la <span class="green">semilla</span>. Sin embargo, si no se conociesen, no se debería poder distinguir una serie de números pseudoaleatorios de una sucesión de números verdaderamente aleatoria (utilizando recursos computacionales razonables).</p>
</div>
<p><br> En caso contrario esta predecibilidad puede dar lugar a algunos problemas. Acá se muestran algunos artículos que ejemplifican esta situación:</p>
<ul>
<li class="fragment"><p><a href="http://eprint.iacr.org/2007/419">Cryptanalysis of the Random Number Generator of the Windows Operating System</a>.</p></li>
<li class="fragment"><p><a href="https://eprint.iacr.org/2021/1204">Attacks on Pseudo Random Number Generators Hiding a Linear Structure</a>.</p></li>
<li class="fragment"><p><a href="https://www.cs.tufts.edu/comp/116/archive/fall2013/ali.pdf">Potential Weaknesses In Pseudorandom Number Generators</a>.</p></li>
<li class="fragment"><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0010465513001604">Security problems for a pseudorandom sequence generator based on the Chen chaotic system</a>.</p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>Como regla general, por lo menos mientras se está desarrollando un código o análisis particular, interesa fijar la semilla de aleatorización.</p></li>
<li class="fragment"><p>Permite la reproducibilidad de los resultados.</p></li>
<li class="fragment"><p>Facilita la depuración del código.</p></li>
</ul></section><section class="slide level2"><div class="alert">
<p><span class="orange">Tarea:</span> Revisar artículo <em><a href="https://www.sciencedirect.com/science/article/pii/S1574013722000144?casa_token=qAGiENpFHZwAAAAA:_BzpZp7UVbTaP517SK9ObEBs45Yg1niOBJlPg6EjIWkTU9nyZ0CuFf8qUp6_R0vZxJ6AQP4jFg">A search for good pseudo-random number generators: Survey and empirical studies</a></em> <span class="citation" data-cites="bhattacharjee2022search">(<a href="#/referencias" role="doc-biblioref" onclick="">Bhattacharjee y Das 2022</a>)</span>.</p>
</div>
</section><section class="slide level2"><h3 id="la-semilla">La Semilla</h3>
<p>Los computadores son máquinas determinísticas, capaces de seguir solamente reglas predeterminadas. La solución es emplear <span class="green">números pseudo aleatorios</span>, que como esquema general, funcionan de la siguiente manera:</p>
<ul>
<li class="fragment"><p>Se inicia una secuencia arbitraria de <span class="orange">bytes</span>. Los <span class="orange">bits</span> de esa secuencia son interpretados como los digitos de un número aleatorio <span class="math inline">\(Uniforme(0,1)\)</span>, expresado de forma binaria hasta una cantidad fija de lugares decimales.</p></li>
<li class="fragment"><p>Luego se aplica una compleja función matemática (de forma determinística) que transforma el arreglo (o matriz) de bytes en un nuevo arreglo de bytes. El nuevo arreglo de bytes es técnicamente una función determinista del anterior, pero en la práctica no se parece mucho al arreglo original.</p></li>
<li class="fragment"><p>Voltear un solo bit en la matriz de bytes original podría cambiar los bits en cualquier parte de la salida. La nueva matriz se trata como una nueva variable <span class="math inline">\(Uniforme(0,1)\)</span>, y así sucesivamente.</p></li>
</ul></section><section class="slide level2"><p>Una <span class="orange">ventaja del uso de números pseudo aleatorios</span> es que puede configurar manualmente la matriz de bytes inicial al comienzo de un programa. Esto se denomina la <span class="green">semilla</span>. Lo anterior tiene algunos usos:</p>
<ul>
<li class="fragment"><p>Si hay un error en algún programa aleatorio que sólo ocurre algunas veces, puede hacerse perfectamente reproducible y averiguar qué está pasando.</p></li>
<li class="fragment"><p>Si se necesita que los resultados de los análisis sean exactamente reproducibles, se puede establecer la semilla en la secuencia de comandos.</p></li>
<li class="fragment"><p>Cuando escribe pruebas, puede establecer la semilla y asegurarse de que el resultado sea exactamente el esperado.</p></li>
</ul></section><section class="slide level2"><p>En Python</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="im">import</span> random</span>
<span id="cb10-2"><a href=""></a>random.seed(<span class="dv">10</span>)</span>
<span id="cb10-3"><a href=""></a><span class="bu">print</span>(random.random())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5714025946899135</code></pre>
</div>
</div>
<p>En R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb12-2"><a href=""></a><span class="fu">print</span>(<span class="fu">runif</span>(<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5074782</code></pre>
</div>
</div>
</section><section class="slide level2"><h3 id="generando-números-aleatorios-en-r">Generando números aleatorios en <em>R</em>
</h3>
<p>La generación de números pseudo-aleatorios en R es una de las mejores disponibles en paquetes estadísticos. Entre las herramientas implementadas en el paquete base de R podemos destacar:</p>
<ul>
<li class="fragment"><p><code>set.seed(entero)</code>: permite establecer la semilla (y el generador).</p></li>
<li class="fragment"><p><code><a href="https://rdrr.io/r/base/Random.html">RNGkind()</a></code>: selecciona el generador.</p></li>
<li class="fragment"><p><code>r_distribución(n,...)</code>: genera valores aleatorios de la correspondiente distribución. Por ejemplo, <code>runif(n, min = 0, max = 1)</code>, generaría <span class="math inline">\(n\)</span> valores de una uniforme. Se puede acceder al listado completo de las funciones disponibles en el paquete <code>stats</code> mediante el comando <code><a href="https://rdrr.io/r/stats/Distributions.html">?distributions</a></code>.</p></li>
<li class="fragment"><p><code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>: genera muestras aleatorias de variables discretas y permutaciones.</p></li>
<li class="fragment"><p><code><a href="https://rdrr.io/r/stats/simulate.html">simulate()</a></code>: genera realizaciones de la respuesta de un modelo ajustado.</p></li>
</ul></section><section class="slide level2"><div class="definition">
<p><span class="green">La Semilla</span> </p>
<ul>
<li class="fragment"><p>La semilla se almacena en <code>.Random.seed</code>:</p></li>
<li class="fragment"><p>Inicialmente no existe. La recomendación es establecerla con <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>, en caso contrario se generará a partir del reloj del sistema cuando se necesite.</p></li>
<li class="fragment"><p>Se almacena como un objeto oculto en el entorno de trabajo (o entorno global <code>.GlobalEnv</code>). Con las opciones por defecto de R, si al terminar una sesión almacenamos el entorno (en un fichero <code>.RData</code>), al iniciar una nueva sesión se restaurará también la semilla (y se podría continuar con las simulaciones).</p></li>
<li class="fragment"><p>Es un vector de enteros cuya estructura depende del tipo de generador, por lo que no debería ser modificado manualmente.</p></li>
<li class="fragment"><p>Puede ser recomendable almacenar (el objeto completo) antes de generar simulaciones, e.g.&nbsp;<code>seed &lt;- .Random.seed</code>. Esto permite reproducir los resultados y facilita la depuración de posibles errores.</p></li>
</ul>
</div>
</section><section id="práctica-variables-aleatorias-bernoulli" class="slide level2" data-number="1.5"><h2>
<span class="header-section-number">1.5</span> Práctica: Variables aleatorias Bernoulli</h2>
<div class="example">
<p><span class="green">Monedas al aire: Variables aleatorias Bernoulli</span></p>
<p>Uno de los <span class="orange">modelos probabilísticos más intuitivos</span> es simplemente lanzar una moneda (equilibrada o no).</p>
<ul>
<li class="fragment"><p>Digamos que la probabilidad de obtener <span class="green">cara</span> es <span class="math inline">\(p\)</span>, por lo tanto, la probabilidad de obtener <span class="green">sello</span> es <span class="math inline">\(1-p\)</span>.</p></li>
<li class="fragment"><p>En términos probabilisticos podríamos decir que el lanzamiento de esta moneda corresponde a una <span class="orange">Variable aleatoria Bernoulli</span>. También denotado por <span class="math inline">\(Bernoulli(p)\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><!-- https://livebook.manning.com/book/data-science-bookcamp/chapter-3/21 --><p>Probemos generando el experimento de manera computacional:</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1">Python</a></li>
<li><a href="#tabset-1-2">R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a><span class="co"># importando librerías</span></span>
<span id="cb14-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href=""></a><span class="im">from</span> scipy.stats <span class="im">import</span> bernoulli</span>
<span id="cb14-4"><a href=""></a></span>
<span id="cb14-5"><a href=""></a><span class="co">#Datos</span></span>
<span id="cb14-6"><a href=""></a>p<span class="op">=</span> <span class="fl">0.7</span> <span class="co">#Probabilidad de ocurrencia </span></span>
<span id="cb14-7"><a href=""></a>n <span class="op">=</span> <span class="dv">1000</span> <span class="co">#Tamaño de la muestra</span></span>
<span id="cb14-8"><a href=""></a>muestras <span class="op">=</span> bernoulli.rvs(p,size<span class="op">=</span>n) </span>
<span id="cb14-9"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb14-10"><a href=""></a>plt.hist(muestras)<span class="op">;</span></span>
<span id="cb14-11"><a href=""></a>plt.xlabel(<span class="st">'Lanzamiento de la moneda'</span>)</span>
<span id="cb14-12"><a href=""></a>plt.ylabel(<span class="st">'Conteo'</span>)<span class="op">;</span></span>
<span id="cb14-13"><a href=""></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb15-2"><a href=""></a>p <span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb15-3"><a href=""></a>moneda <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb15-4"><a href=""></a>moneda <span class="ot">=</span> <span class="fu">ifelse</span>(moneda <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"Cara"</span>, <span class="st">"Sello"</span>)</span>
<span id="cb15-5"><a href=""></a><span class="fu">barplot</span>(<span class="fu">table</span>(moneda)<span class="sc">/</span>n, </span>
<span id="cb15-6"><a href=""></a>        <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb15-7"><a href=""></a>        <span class="at">ylab =</span> <span class="st">"Probabilidad"</span>)</span>
<span id="cb15-8"><a href=""></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.7</span>, <span class="at">col=</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>La asignación de <span class="math inline">\(p=0.7\)</span> a la probabilidad de obtener <em>‘cara’</em> y a <span class="math inline">\(1-p=0.3\)</span> la probabilidad de obtener <em>‘sello’</em>, es denominado la función de masa de probabilidad, para esta variable aleatoria en particular.</p></li>
<li class="fragment"><p>Es conveniente describir la variable aleatoria en términos de números en vez de lados de una moneda. Por convención denominamos <span class="math inline">\(cara=1\)</span> y <span class="math inline">\(sello=0\)</span>.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="blue">Ejemplo</span></p>
<p>Dos amigos efectúan una apuesta a partir de lanzamiento de una moneda. Un amigo le dice al otro:</p>
<blockquote>
<p>Te daré 5 por cada cara que salga y tu me pagarás 2 por cada sello que aparezca.</p>
</blockquote>
</div>
<ul>
<li class="fragment"><p>El pago promedio entonces será: <span class="math display">\[ \mathbb{E}(pago) = 0.7 \times 5 + 0.3 \times (-2) = 2.9 \]</span></p></li>
<li class="fragment"><p>Entonces, si lanzamos la moneda <span class="math inline">\(N\)</span> veces, donde <span class="math inline">\(N\)</span> es un número muy grande, el pago final será de aproximadamente <span class="math inline">\((2.9 \times N)\)</span>.</p></li>
</ul></section><section class="slide level2"><p>Podemos observar cómo una variable aleatoria <span class="green">Bernoulli</span>, podría generalizarse a algo como el lanzamiento de un dado, donde la función de masa de probabilidad asignaría una probabilidad a los números <span class="math inline">\(0-5\)</span>. En este caso, denotamos como <span class="math inline">\(p_i\)</span> la probabilidad del <span class="math inline">\(i\)</span>-ésimo resultado. Además:</p>
<ul>
<li class="fragment"><p>Todos los <span class="math inline">\(p_i\)</span> son no negativos, y</p></li>
<li class="fragment"><p><span class="math inline">\(\sum_{i=0}^n p_i = 1\)</span>, con <span class="math inline">\(n=5\)</span>.</p></li>
</ul>
<p>Una variable de tipo <span class="green">Bernoulli</span> es denominada una <span class="green">variable aleatoria discreta</span>. Esto significa que:</p>
<ul>
<li class="fragment"><p>Tiene un número finito de resultados posibles o</p></li>
<li class="fragment"><p>Todos sus posibles resultados pueden ser listados.</p></li>
</ul></section><section id="variables-aleatorias-uniformes" class="slide level2" data-number="1.6"><h2>
<span class="header-section-number">1.6</span> Variables aleatorias Uniformes</h2>
<div class="alert">
<p><span class="green">Lanzando dardos: Variables aleatorias Uniformes</span></p>
<p>Lo opuesto a las variables aleatorias discretas, son las <span class="green">variables aleatorias contínuas</span>, que pueden tomar cualquier valor entre un rango de números.</p>
<ul>
<li class="fragment"><p>La variable aleatoria contínua más simple para simular es la denominada <span class="green">Uniforme</span>, denotada por <span class="math inline">\(Uniforme(a,b)\)</span>.</p></li>
<li class="fragment"><p>Una v.a. <span class="math inline">\(Uniforme(a,b)\)</span>, siempre se encontrará entre los números <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> con una probabilidad igual de estar en cualquier lugar dentro de ese rango.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Probemos generando una v.a. <span class="math inline">\(Uniforme(1,5)\)</span>, de manera computacional:</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1">Python</a></li>
<li><a href="#tabset-2-2">R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href=""></a></span>
<span id="cb16-4"><a href=""></a>a, b <span class="op">=</span> <span class="dv">1</span>,<span class="dv">5</span> <span class="co">#Rango </span></span>
<span id="cb16-5"><a href=""></a>n <span class="op">=</span> <span class="dv">1000</span> <span class="co">#Tamaño de la muestra</span></span>
<span id="cb16-6"><a href=""></a>muestras <span class="op">=</span> np.random.uniform(low <span class="op">=</span> a, high <span class="op">=</span> b, size<span class="op">=</span>n) </span>
<span id="cb16-7"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb16-8"><a href=""></a>count, bins, ignored <span class="op">=</span> plt.hist(muestras, bins <span class="op">=</span> <span class="dv">15</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-9"><a href=""></a>plt.plot(bins, np.ones_like(bins)<span class="op">/</span>(b<span class="op">-</span>a), linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb16-10"><a href=""></a>plt.xlim([<span class="dv">0</span>, <span class="dv">6</span>])<span class="op">;</span> plt.ylim([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb16-11"><a href=""></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb16-12"><a href=""></a>plt.ylabel(<span class="st">'Probabilidad'</span>)<span class="op">;</span></span>
<span id="cb16-13"><a href=""></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb17-2"><a href=""></a>a <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb17-3"><a href=""></a>b <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb17-4"><a href=""></a>muestras <span class="ot">=</span> <span class="fu">runif</span>(n, a, b)</span>
<span id="cb17-5"><a href=""></a><span class="fu">hist</span>(muestras, <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-6"><a href=""></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb17-7"><a href=""></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>((a<span class="dv">-1</span>),(b<span class="sc">+</span><span class="dv">1</span>)),</span>
<span id="cb17-8"><a href=""></a>     <span class="at">ylab =</span> <span class="st">"Probabilidad"</span>, <span class="at">main=</span><span class="cn">NULL</span>)</span>
<span id="cb17-9"><a href=""></a><span class="fu">abline</span>(<span class="at">h=</span>(<span class="dv">1</span><span class="sc">/</span>(b<span class="sc">-</span>a)), <span class="at">col=</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Para v.a. discretas, la función de masa de probabilidad asigna una probabilidad finita a cada resultado posible. Para v.a. continuas, cada resultado exacto, tiene probabilidad 0, pero ciertos rangos tienen mayor probabilidad que otros. Denominamos a esta función la <span class="orange">función de densidad de probabilidad</span> (pdf, por su sigla en inglés: <em>probability density function</em>). En el caso de la v.a. Uniforme, su pdf es:</p>
<p><span class="math display">\[p(x) = \frac{1}{(b-a)}\]</span></p>
</section><section class="slide level2"><div class="alert">
<p><span class="green">Un recordatorio…</span></p>
<ul>
<li class="fragment">
<p>Similar a las funciones de masa de probabilidad, las restricciones de la pdf <span class="math inline">\(f\)</span> son:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(f(x)\)</span> no es nunca negativa, y</p></li>
<li class="fragment"><p>El área total bajo la curva de <span class="math inline">\(f(x)\)</span> es igual a 1.</p></li>
</ul>
</li>
<li class="fragment"><p>Cualquier <span class="math inline">\(f\)</span> que cumple estos requisitos, es una pdf válida.</p></li>
<li class="fragment"><p>Relacionado con la pdf, está la <span class="orange">Función de distribución acumulada</span> (cdf, por su sigla en inglés: <em>cummulative distribution function</em>). Por convención, se utiliza la munúscula <span class="math inline">\(f()\)</span> para denotar a la pdf, y la mayúscula <span class="math inline">\(F()\)</span> para denotar a la cdf.</p></li>
<li class="fragment"><p><span class="math inline">\(F(x)\)</span> es la probabilidad de que el valor de una variable aleatoria sea <span class="math inline">\(\leq x\)</span>. Así, <span class="math inline">\(F(x)\)</span> es una función no decreciente que se aproxima a cero cuando <span class="math inline">\(x \to -\infty\)</span> y se aproxima a uno cuando <span class="math inline">\(x \to \infty\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><h3 id="distribución-uniforme-y-los-números-pseudo-aleatorios">Distribución <span class="green">Uniforme</span> y los números pseudo-aleatorios</h3>
<p>La distribución <span class="green">Uniforme</span> es una de las más sencillas de entender y constituye la base para construir distribuciones más complejas, en términos teóricos y matemáticos.</p>
<div class="example">
<p><span class="orange">Por ejemplo:</span></p>
<ul>
<li class="fragment"><p>Si se quiere simular una v.a. <span class="math inline">\(Bernoulli(p)\)</span>, se puede simular una variable aleatoria <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Uniforme(0,1)\)</span>. Si <span class="math inline">\(u&lt;p\)</span>, se establece <span class="math inline">\(B=cara\)</span>. Si no, <span class="math inline">\(B=sello\)</span>.</p></li>
<li class="fragment"><p>Si se quiere simular el lanzamiento de un dado, se puede dividir el rango <span class="math inline">\([0.0, 1.0]\)</span> en seis regiones, donde la <span class="math inline">\(i\)</span>-ésima región corresponde a la <span class="math inline">\(i\)</span>-ésima cara del dado. Luego, se extrae un valor <span class="math inline">\(u\)</span> desde la distribución <span class="math inline">\(Uniforme(0,1)\)</span>. La cara del dado corresponderá a la región <span class="math inline">\([0.0, 1.0]\)</span> en que <span class="math inline">\(u\)</span> caiga.</p></li>
<li class="fragment"><p>Si queremos simular una v.a. <span class="math inline">\(Exponencial\)</span> (que veremos más adelante), se extrae <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Uniforme(0,1)\)</span>, Luego se calcula <span class="math inline">\(-Log(u)\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Digamos que conocemos la cdf <span class="math inline">\(F_X()\)</span> de una v.a., y que además, podemos computar la inversa de la cdf <span class="math inline">\(F_X^{-1}(u)\)</span>, entonces:</p>
<ul>
<li class="fragment"><p>Entonces <span class="math inline">\(F_X^{-1}(u)\)</span> será una muestra de <span class="math inline">\(X\)</span> si <span class="math inline">\(u\)</span> es extraída desde una distribución <span class="math inline">\(Uniforme\)</span>.</p></li>
<li class="fragment"><p>Las librerías computacionales que simulan v.a. usualmente muestrean desde la distribución <span class="math inline">\(Uniforme\)</span> como su operación fundamental.</p></li>
</ul></section><section class="slide level2"><h3 id="ejercicios">Ejercicios</h3>
<p>Probar simulando distribuciones a partir de números pseudo-aleatorios, graficar los resultados y comprobar con el generador de distribuciones:</p>
<ul>
<li class="fragment"><p>Simular 1000 números aleatorios a partir de una distribución exponencial, con <span class="math inline">\(\lambda = 0.5\)</span> (fijarse en la parametrización del código).</p></li>
<li class="fragment"><p>Simular 1000 números aleatorios a partir de una distribución normal, con <span class="math inline">\(\mu = 10\)</span>, y <span class="math inline">\(\sigma^2 = 3\)</span>.</p></li>
<li class="fragment"><p>Simular 1000 números aleatorios a partir de una distribución chi-cuadrado, considere que el cuadrado de una distribución normal estándar se distribuye chi cuadrado con 1 grado de libertad.</p></li>
</ul></section><section class="slide level2"><h3 id="transformación-de-variables-y-relación-entre-distribuciones">Transformación de variables y relación entre distribuciones</h3>

<img data-src="images/distribution_relationship_map.png" class="r-stretch quarto-figure-center"><p class="caption">Ejemplo de algunas relaciones entre distribuciones univariadas</p></section><section class="slide level2"><p><strong>Enlaces con información más detallada:</strong></p>
<ul>
<li class="fragment"><p><a href="https://www.johndcook.com/blog/distribution_chart/">Diagrama de relaciones entre distribuciones</a></p></li>
<li class="fragment"><p><a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">Un diagrama un poco más detallado</a></p></li>
</ul></section></section><section><section id="generación-de-números-pseudo-aleatorios" class="title-slide slide level1 center" data-background-color="#00A499" data-number="2"><h1>
<span class="header-section-number">2</span> Generación de números pseudo-aleatorios</h1>

</section><section id="contexto" class="slide level2" data-number="2.1"><h2>
<span class="header-section-number">2.1</span> Contexto</h2>
<ul>
<li class="fragment">
<p>En los <span class="green">primeros días</span> de la simulación, la aleatoriedad se generaba mediante <span class="orange">técnicas manuales</span>:</p>
<ul>
<li class="fragment"><p>lanzamiento de monedas</p></li>
<li class="fragment"><p>lanzamiento de dados</p></li>
<li class="fragment"><p>barajada de cartas</p></li>
<li class="fragment"><p>giro de la ruleta</p></li>
</ul>
</li>
<li class="fragment"><p>Más tarde, se conectaron dispositivos físicos, como diodos de ruido y contadores Geiger, a las computadoras con el mismo propósito.</p></li>
<li class="fragment"><p>La creencia predominante sostenía que solo los dispositivos mecánicos o electrónicos podían producir secuencias verdaderamente aleatorias.</p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment">
<p>Aunque los dispositivos mecánicos todavía son de utilidad en el juego y las loterías, estos métodos ya no son empleados en aplicaciones computacionales y de análisis por varios motivos:</p>
<ul>
<li class="fragment"><p>Los métodos mecánicos eran demasiado lentos para uso general,</p></li>
<li class="fragment"><p>las secuencias generadas no pueden ser reproducidas y,</p></li>
<li class="fragment"><p>se ha encontrado que los números generados exhiben tanto sesgo como dependencia.</p></li>
</ul>
</li>
</ul>
<div class="fragment">
<div class="alert">
<p>Aunque ciertos métodos físicos de generación modernos son rápidos y pasarían la mayoría de las pruebas estadísticas de aleatoriedad (por ejemplo, aquellos basados en la radiación de fondo universal o en el ruido de un chip de PC), su principal desventaja sigue siendo su falta de reproducibilidad</p>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>La mayoría de los generadores de números aleatorios de hoy en día no se basan en dispositivos físicos, sino en algoritmos simples que se pueden implementar fácilmente en una computadora.</p></li>
<li class="fragment"><p>Son métodos rápidos, requieren poco espacio de almacenamiento y pueden reproducir fácilmente una secuencia dada de números aleatorios.</p></li>
</ul>
<div class="alert">
<p>Es importante destacar que un buen generador de números aleatorios captura todas las propiedades estadísticas importantes de las secuencias aleatorias verdaderas, aunque la secuencia se genere mediante un algoritmo determinista. Por esta razón, a estos generadores a veces se les llama pseudorandom.</p>
</div>
</section><section class="slide level2"><p>El componente fundamental de un estudio de simulación es la capacidad de <span class="green">generar números aleatorios</span>, donde un número aleatorio representa el <span class="green">valor de una variable aleatoria distribuida uniformemente en (0,1)</span>.</p>
<p>Mientras que originalmente los números aleatorios se generaban manual o mecánicamente, utilizando técnicas como girar ruedas, lanzar dados o barajar cartas, el enfoque moderno es utilizar computación para generar sucesivamente números pseudo aleatorios Estos números pseudo aleatorios constituyen una secuencia de valores que, aunque se generan de manera determinista, tienen todas las apariencias de ser variables aleatorias uniformes independientes (0,1).</p>
</section><section id="métodos-congruenciales" class="slide level2" data-number="2.2"><h2>
<span class="header-section-number">2.2</span> Métodos Congruenciales</h2>
<p>Consideremos la siguiente <span class="green">secuencia de 100 números</span>, generada en R, parecen ser aleatorios, ¿cierto?:</p>
<div class="alert">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.50000000 0.40810728 0.58342256 0.19995311 0.61707744 0.18960591
  [7] 0.20656207 0.75336388 0.42318121 0.65187749 0.56721709 0.73441689
 [13] 0.83104986 0.45814651 0.44273811 0.61666370 0.77680949 0.72995251
 [19] 0.80450243 0.83649141 0.25332014 0.96528698 0.31478070 0.29105900
 [25] 0.59410869 0.54647416 0.32911075 0.60207293 0.33499109 0.88276385
 [31] 0.55832126 0.35890085 0.58913651 0.71756336 0.97617735 0.88747819
 [37] 0.75549994 0.88394823 0.11250067 0.87996813 0.89692892 0.26651384
 [43] 0.79663157 0.33197375 0.68261844 0.91709167 0.35257423 0.85665304
 [49] 0.75645357 0.98427681 0.57663485 0.68933159 0.12133686 0.86093372
 [55] 0.23784003 0.77707536 0.04337541 0.73695267 0.69647589 0.84394413
 [61] 0.62048056 0.59188530 0.38397178 0.68232607 0.60448698 0.70890958
 [67] 0.42190796 0.62456833 0.69495839 0.19879479 0.89549425 0.35971429
 [73] 0.20010115 0.70937298 0.93135996 0.84816307 0.95432161 0.80084249
 [79] 0.40745700 0.06738798 0.27926031 0.45948509 0.56740071 0.90814229
 [85] 0.26360899 0.84046038 0.23310057 0.69491270 0.14929459 0.98018450
 [91] 0.65912623 0.10144566 0.72397223 0.10739251 0.02506461 0.42364202
 [97] 0.02403674 0.90719104 0.98491985 0.50861252 0.01697735</code></pre>
</div>
</div>
</div>
</section><section class="slide level2"><p>Los números pseudo aleatorios tienen la <span class="green"><em>apariencia</em></span> de ser aleatorios. Sin embargo son generados de una manera muy poco aleatoria. Tomemos por ejemplo la siguiente fórmula recursiva</p>
<p><span class="math display">\[ x_{i+1} = \mbox{parte fraccional de }(\pi + x_i )^5 \qquad \mbox{para } i\geq 0 \]</span></p>
<p>donde <span class="math inline">\(x_0\)</span> es un número dado que se encuentra en el rango <span class="math inline">\(0 &lt; x_0 &lt; 1\)</span></p>
</section><section class="slide level2"><div class="definition">
<p><span class="blue">Tarea:</span> Replicar la secuencia de números presentada anteriormente (en <em>R</em> y/o <em>Python</em>).</p>
</div>
</section><section class="slide level2"><p>Uno de los enfoques más comunes para generar números pseudo aleatorios comienza con un valor inicial <span class="math inline">\(x_0\)</span>, llamado la <span class="orange">semilla</span>, y luego calcula recursivamente los valores sucesivos <span class="math inline">\(x_i\)</span>, para <span class="math inline">\(i \geq 1\)</span>, dejando que</p>
<p><span id="eq-congruencial"><span class="math display">\[
x_{i+1} = a x_{i} + b \mod m
\qquad(1)\]</span></span></p>
<p>donde <span class="math inline">\(a\)</span> (multiplicador), <span class="math inline">\(b\)</span> (incremento) y <span class="math inline">\(m\)</span> (módulo) son constantes enteras positivas dadas, y donde lo anterior significa que <span class="math inline">\(ax_{i}+b\)</span> se divide por <span class="math inline">\(m\)</span> y el resto se toma como el valor de <span class="math inline">\(x_{i+1}\)</span>. Así, cada <span class="math inline">\(x_i\)</span> es <span class="math inline">\(0, 1, \ldots, m - 1\)</span> y la cantidad <span class="math inline">\(\frac{x_i}{m}\)</span>, llamada <span class="orange">número pseudo aleatorio</span>, se toma como una aproximación al valor de la variable aleatoria uniforme (0,1) <span class="math inline">\(\sim U(0,1)\)</span>.</p>
</section><section class="slide level2"><p>Método Congruencial Aditivo <span class="math display">\[ x_i = (x_{i-1} + b) \mod m\]</span></p>
<p>Método Congruencial Multiplicativo <span class="math display">\[ x_i = a x_{i-1} \pmod m\]</span></p>
<p>Método Congruencial Mixto <span class="math display">\[ x_i = (a x_{i-1} + b) \pmod m\]</span></p>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplos:</span></p>
<p>Probemos algunas combinaciones de parámetros y sus resultados:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(x_0 = 89, a=1573, b=19, m=10^3\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(b=0, a=2^{16} + 3\)</span> y <span class="math inline">\(m=2^{31}\)</span>, generador <em>RANDU</em> de IBM. Este generador tiene varios problemas, que pueden ser descritos <a href="https://young.physics.ucsc.edu/115/randu.pdf">acá</a>. <a href="https://demonstrations.wolfram.com/PoorStatisticalQualitiesForTheRANDURandomNumberGenerator/">Wolfram.com</a> entrega una visualización referente a este mismo problema.</p></li>
<li class="fragment"><p><span class="math inline">\(b=0, a=7^5\)</span> y <span class="math inline">\(m=2^{31}-1\)</span>, el primo de Mersenne, empleado por librerías IMSL (<em>International Mathematics and Statistics Library</em>) y NAG <em>(Numerical Algorithms Group Ltd.</em>), propuesto por <span class="citation" data-cites="Park1988">Park y Miller (<a href="#/referencias" role="doc-biblioref" onclick="">1988</a>)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(b=0, a=48271\)</span> y <span class="math inline">\(m=2^31 -1\)</span>, actualización del anterior, propuesta por <span class="citation" data-cites="Marsaglia1993">Marsaglia et&nbsp;al. (<a href="#/referencias" role="doc-biblioref" onclick="">1993</a>)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="blue">Algunas consideraciones</span></p>
<div class="small">
<ul>
<li class="fragment"><p>La <span class="green">elección de las constantes <span class="math inline">\(a, b\)</span> y <span class="math inline">\(m\)</span></span> tiene un razonamiento que considera varios objetivos. Para empezar, se quiere que la <span class="orange">aritmética sea eficiente</span>. Los seres humanos hacen aritmética en base 10, así que si la <a href="#/eq-congruencial" class="quarto-xref">Ecuación&nbsp;1</a> se operara manualmente, usando lápiz y papel, sería sensato que <span class="orange"><span class="math inline">\(m\)</span> fuera alguna potencia entera positiva de 10</span>.</p></li>
<li class="fragment">
<p>Si uno calcula naturalmente en <span class="green">base numérica <span class="math inline">\(r\)</span></span>, entonces la operación de división por <span class="math inline">\(m\)</span> es <span class="orange">más eficiente si <span class="math inline">\(m = r^k\)</span></span> para algún entero positivo <span class="math inline">\(k\)</span>.</p>
<ul>
<li class="fragment">Para la mayoría de los computadores, esto implica establecer <span class="math inline">\(m = 2^k\)</span>, donde <span class="math inline">\(k\)</span> se selecciona para que <span class="math inline">\(m\)</span> sea “<em>grande</em>” y los números involucrados estén dentro de la precisión de la máquina.</li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="definition">
<p><span class="blue">Definición:</span></p>
<p>El generador de la <a href="#/eq-congruencial" class="quarto-xref">Ecuación&nbsp;1</a> no puede producir más de <span class="math inline">\(m\)</span> números diferentes antes de que el ciclo se repita. Sea <span class="math inline">\(p\)</span> el período de una secuencia, cuando <span class="math inline">\(p\)</span> es igual a su máximo, es decir, <span class="math inline">\(p=m\)</span>. Decimos que el generador de números aleatorios <span class="green">tiene un período completo</span>.</p>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="green">Teorema: Hull-Dobell (Generador de período completo)</span> Sea el Generador Congruencial Lineal (GCL) de la forma: <span class="math display">\[ x_i = (a x_{i-1} + b) \pmod m\]</span></p>
<p>Para <span class="math inline">\(b &gt; 0\)</span>, el GCL tiene un período completo si y solo si se cumplen las siguientes tres condiciones <span class="citation" data-cites="Morgan2018">(<a href="#/referencias" role="doc-biblioref" onclick="">Morgan 2018</a>)</span>:</p>
<div class="small">
<ol type="i">
<li class="fragment"><p>El único entero positivo que divide exactamente tanto a <span class="math inline">\(m\)</span> como a <span class="math inline">\(b\)</span> es 1.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(q\)</span> es un número primo (divisible solo por sí mismo y 1) que divide a <span class="math inline">\(m\)</span>, entonces <span class="math inline">\(q\)</span> divide a <span class="math inline">\((a-1)\)</span>. Es decir, <span class="math inline">\(a \equiv 1 \pmod{q}\)</span>, para todo factor primo <span class="math inline">\(q\)</span> de <span class="math inline">\(m\)</span>. Dicho de otra manera, <span class="math inline">\((a-1)\)</span> es múltiplo de cada número primo que divide a <span class="math inline">\(m\)</span>.</p></li>
<li class="fragment"><p>Si 4 divide a <span class="math inline">\(m\)</span>, entonces 4 divide a <span class="math inline">\((a-1)\)</span>. Es decir, <span class="math inline">\(a \equiv 1 \pmod{4}\)</span>, si <span class="math inline">\(m\)</span> es múltiplo de 4.</p></li>
</ol>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(m = 2^k\)</span>, la relación (iii) implicaría que <span class="math inline">\(a = 4b + 1\)</span> para <span class="math inline">\(b\)</span> entero positivo, lo cual también satisface la relación (ii).</p></li>
<li class="fragment"><p>Cuando <span class="math inline">\(m = 2^k\)</span>, la relación (i) se logra fácilmente estableciendo <span class="math inline">\(b\)</span> como cualquier constante positiva impar.</p></li>
</ul>
</div>
</div>
</section><section id="propiedades-de-los-generadores-congruenciales" class="slide level2" data-number="2.3"><h2>
<span class="header-section-number">2.3</span> Propiedades de los generadores congruenciales</h2>
<div class="definition">
<p>Se podría esperar que los números resultantes del generador congruencial mixto (<a href="#/eq-congruencial" class="quarto-xref">Ecuación&nbsp;1</a>) tengan dependencias inusuales, y esto puede ser ilustrado en lo siguiente:</p>
<ul>
<li class="fragment"><p>Sea <span class="math inline">\(x_{i+1} = 5x_i \pmod{m}\)</span></p></li>
<li class="fragment"><p>Aquí, <span class="math inline">\(x_{i+1} = 5x_i - h_{i}m\)</span>, donde <span class="math inline">\(h\)</span> toma uno de los valores 0, 1, 2, 3, 4.</p></li>
</ul>
<p>Por lo tanto, los pares de valores sucesivos <span class="math inline">\((x_i, x_{i+1})\)</span> representan las coordenadas cartesianas de puntos que se encuentran en una de las cinco rectas dadas por la ecuación, y cuanto mayor es <span class="math inline">\(m\)</span>, más larga será la secuencia de números generados que permanecerá en una de estas líneas antes de pasar a otra.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span></p>
<p>Si <span class="math inline">\(x_1 = 1\)</span> y <span class="math inline">\(m = 11\)</span>, entonces: <span class="math display">\[x_1 = 5, x_2 = 3, x_3 = 4, x_4 = 9, x_5 = 1\]</span></p>
<p>y la línea utilizada cambia con cada iteración.</p>
<p>Sin embargo, si <span class="math inline">\(x_1 = 1\)</span> y <span class="math inline">\(m = 1000\)</span>, entonces: <span class="math display">\[x_1 = 5, x_2 = 25, x_3 = 125, x_4 = 625, x_5 = 125\]</span></p>
<p>y la secuencia de <span class="math inline">\(x_1\)</span> a <span class="math inline">\(x_4\)</span> se obtiene de la línea <span class="math inline">\(x_{i+1} = 5x_i\)</span>, tras lo cual la secuencia degenera en una alternancia simple. Pares de valores sucesivos dan puntos que yacen en un número limitado de líneas rectas, tríos de valores sucesivos se encuentran en un número limitado de planos, etc.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span></p>
<p>Si tomamos el generador congruencial dado por: <span class="math display">\[ x_{n-1} = 781 x_n + 387 \pmod{1000}\]</span> con <span class="math inline">\(u_i = x_i/1000\)</span>, para <span class="math inline">\(0 \leq i \leq 999\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><div class="alert">
<ul>
<li class="fragment"><p>La <span class="green">marcada tendencia de <em>vacíos</em></span> en el plano se debe al pequeño valor de <span class="math inline">\(m\)</span> utilizado, lo que también permite observar el tipo de patrón que puede aparecer. Por lo tanto, en muchos casos, <span class="orange">se sugiere modificar la salida de los generadores</span> congruenciales antes de ser utilizada, lo cual siempre implica una revisión.</p></li>
<li class="fragment">
<p>Una manera de modificar la salida es <span class="orange">tomar los números en grupos de tamaño <span class="math inline">\(g\)</span>, para luego <em>mezclarlos</em></span> mediante una permutación, antes de ser utilizados.</p>
<ul>
<li class="fragment"><p><span class="citation" data-cites="Andrews1972">Andrews et&nbsp;al. (<a href="#/referencias" role="doc-biblioref" onclick="">1972</a>)</span> utiliza <span class="math inline">\(g=500\)</span>.</p></li>
<li class="fragment"><p><span class="citation" data-cites="Egger1979">Egger (<a href="#/referencias" role="doc-biblioref" onclick="">1979</a>)</span> y <span class="citation" data-cites="Atkinson1980">Atkinson (<a href="#/referencias" role="doc-biblioref" onclick="">1980</a>)</span> proponen <span class="math inline">\(g=100\)</span>.</p></li>
</ul>
</li>
<li class="fragment"><p>Un enfoque alternativo, propuesto por <span class="citation" data-cites="MacLaren1965">MacLaren y Marsaglia (<a href="#/referencias" role="doc-biblioref" onclick="">1965</a>)</span>, es tener un conjunto de <span class="math inline">\(g\)</span> números almacenados, a partir de generador congruencial, y elegir cuál de estos números usar a continuación mediante un dígito indicador aleatorio del rango 1 a <span class="math inline">\(g\)</span>, obtenido, por ejemplo, por un generador congruencial separado. El lugar que dejó el número utilizado del conjunto es reemplazado entonces con el siguiente número del generador original, y así sucesivamente.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="método-de-los-cuadrados-medios" class="slide level2" data-number="2.4"><h2>
<span class="header-section-number">2.4</span> Método de los Cuadrados Medios</h2>
<p>Otra alternativa para generar números pseudo-aleatorios es utilizar el <span class="green">Método de los Cuadrados Medios</span>. Este método tiene la desventaja de que en generan resulta en un período corto. Al aplicarlo repetidamente, el método <span class="orange">tiende a producir el mismo número de manera recurrente o entra en un ciclo</span>, repitiendo una secuencia de números anterior, lo que resulta en un bucle infinito. Esto limita su efectividad para generar secuencias de números aleatorios confiables y variados.</p>
</section><section class="slide level2"><div class="definition small">
<p><span class="blue">Método de los cuadrados medios</span></p>
<p>Se inicia con un número entero positivo de cuatro dígitos <span class="math inline">\(x_0\)</span>, posteriormente se debe seguir la siguiente secuencia:</p>
<ol type="1">
<li class="fragment"><p>Elevar al cuadrado <span class="math inline">\(x_0\)</span> para obtener un entero de hasta ocho dígitos; si es necesario, añadir ceros a la izquierda para que tenga exactamente ocho dígitos.</p></li>
<li class="fragment"><p>Tomar los cuatro dígitos del medio de este número de ocho dígitos como el siguiente número de cuatro dígitos <span class="math inline">\(x_1\)</span>.</p></li>
<li class="fragment"><p>Colocar un punto decimal a la izquierda de <span class="math inline">\(x_1\)</span> para obtener el primer <span class="green">número aleatorio <span class="math inline">\(u_1 \sim U(0,1)\)</span></span>.</p></li>
<li class="fragment"><p>Repetir los pasos 1 a 3 <span class="math inline">\(n\)</span> veces para generar un vector de números aleatorios de largo <span class="math inline">\(n\)</span>.</p></li>
</ol>
</div>
</section></section><section><section id="analizando-la-calidad-de-los-números-pseudo-aleatorios" class="title-slide slide level1 center" data-background-color="#00A499" data-number="3"><h1>
<span class="header-section-number">3</span> Analizando la calidad de los números pseudo aleatorios</h1>

</section><section class="slide level2"><p>Para verificar si un generador tiene las propiedades estadísticas deseadas hay disponibles una gran cantidad de test de hipótesis y métodos gráficos, incluyendo métodos genéricos (de bondad de ajuste y aleatoriedad) y contrastes específicos para generadores aleatorios. Se trata principalmente de contrastar si las muestras generadas son i.i.d. <span class="math inline">\(U(0,1)\)</span>.</p>
<p>Hay que destacar algunas diferencias entre el uso de este tipo de métodos en inferencia y en simulación.</p>
<div class="alert">
<ul>
<li class="fragment"><p>Si empleamos un test de hipótesis del modo habitual, desconfiamos del generador si la muestra (secuencia) no se ajusta a la distribución teórica <span class="math inline">\((\mbox{p-valor} \leq \alpha)\)</span>.</p></li>
<li class="fragment"><p>En simulación, además, también se sospecha si se ajusta demasiado bien a la distribución teórica <span class="math inline">\((\mbox{p-valor} \geq 1-\alpha)\)</span>, lo que indicaría que no reproduce adecuadamente la variabilidad.</p></li>
</ul>
</div>
</section><section id="métodos-de-bondad-de-ajuste" class="slide level2" data-number="3.1"><h2>
<span class="header-section-number">3.1</span> Métodos de bondad de ajuste</h2>
<p>A partir de <span class="math inline">\(x_1, \ldots, x_n\)</span> m.a.s. de <span class="math inline">\(X\)</span> con función de distribución <span class="math inline">\(F\)</span>, establecemos un test de hipótesis de la forma</p>
<p><span class="math display">\[\left\{\begin{matrix}
H_0 : F = F_0\\
H_1: F \neq F_0
\end{matrix}\right.\]</span></p>
</section><section class="slide level2"><h3 id="histograma-1">Histograma</h3>
<div class="definition">
<p>Agrupando los datos en intervalos <span class="math inline">\(I_k = \left[ L_{k-1}, L_{k} \right)\)</span> con <span class="math inline">\(k = 1, \ldots, K\)</span> y a cada intervalo se le asocia un valor (altura de la barra) igual a la frecuencia absoluta de ese intervalo <span class="math inline">\(n_{k} = \sum_{i=1}^{n} \mathbf{1} \left( X_i \in \left[ L_{k-1}, L_{k} \right) \right)\)</span>, si la longitud de los intervalos es constante, o proporcional a dicha frecuencia (de forma que el área coincida con la frecuencia relativa y pueda ser comparado con una función de densidad):</p>
<p><span class="math display">\[\hat{f}_{n}(x) = \frac{n_i}{n(L_k - L_{k-1})} \]</span></p>
</div>
</section><section class="slide level2"><div class="example">
<p>Ejemplo:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>datos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">22.56</span>,<span class="fl">22.33</span>,<span class="fl">24.58</span>,<span class="fl">23.14</span>,<span class="fl">19.03</span>,<span class="fl">26.76</span>,<span class="fl">18.33</span>,<span class="fl">23.10</span>,</span>
<span id="cb19-2"><a href=""></a>  <span class="fl">21.53</span>,<span class="fl">9.06</span>,<span class="fl">16.75</span>,<span class="fl">23.29</span>,<span class="fl">22.14</span>,<span class="fl">16.28</span>,<span class="fl">18.89</span>,<span class="fl">27.48</span>,<span class="fl">10.44</span>,</span>
<span id="cb19-3"><a href=""></a>  <span class="fl">26.86</span>,<span class="fl">27.27</span>,<span class="fl">18.74</span>,<span class="fl">19.88</span>,<span class="fl">15.76</span>,<span class="fl">30.77</span>,<span class="fl">21.16</span>,<span class="fl">24.26</span>,<span class="fl">22.90</span>,</span>
<span id="cb19-4"><a href=""></a>  <span class="fl">27.14</span>,<span class="fl">18.02</span>,<span class="fl">21.53</span>,<span class="fl">24.99</span>,<span class="fl">19.81</span>,<span class="fl">11.88</span>,<span class="fl">24.01</span>,<span class="fl">22.11</span>,<span class="fl">21.91</span>,</span>
<span id="cb19-5"><a href=""></a>  <span class="fl">14.35</span>,<span class="fl">11.14</span>,<span class="fl">9.93</span>,<span class="fl">20.22</span>,<span class="fl">17.73</span>,<span class="fl">19.05</span>)</span>
<span id="cb19-6"><a href=""></a><span class="fu">hist</span>(datos, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-7"><a href=""></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="fu">mean</span>(datos), <span class="fu">sd</span>(datos)), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section><section class="slide level2"><h3 id="función-de-distribución-empírica">Función de distribución empírica</h3>
<div class="definition">
<p>La función de distribución empírica <span class="math inline">\(F_n(x) = \frac{1}{n} \sum_{i=1}^n \mathbf{1} (X_i \leq x)\)</span> asigna a cada número real <span class="math inline">\(x\)</span> la frecuencia relativa de observaciones menores o iguales que <span class="math inline">\(x\)</span>. Para obtener las frecuencias relativas acumuladas, se ordena la muestra <span class="math inline">\(X_{(1)} \leq X_{(2)} \leq \cdots \leq X_{(n)}\)</span> y</p>
<p><span class="math display">\[ F_n (x) = \left\{\begin{matrix}
&amp; 0 &amp; si \quad &amp; x &gt; X_{(1)}\\
&amp; \frac{i}{n} &amp; si \quad &amp; x &gt; X_{(i)} \leq x \leq X_{(i+1)} \\
&amp; 1 &amp; si \quad &amp; X_{(n)} \leq x
\end{matrix}\right.\]</span></p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo</span></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(datos)</span>
<span id="cb20-2"><a href=""></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(datos)(x), <span class="at">xlim =</span> <span class="fu">extendrange</span>(datos), <span class="at">type =</span> <span class="st">'s'</span>, </span>
<span id="cb20-3"><a href=""></a>      <span class="at">ylab =</span> <span class="st">'Función de distribución'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb20-4"><a href=""></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x, <span class="fu">mean</span>(datos), <span class="fu">sd</span>(datos)), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section><section class="slide level2"><h3 id="prueba-chi-cuadrado">Prueba Chi cuadrado</h3>
<p>La <span class="green">prueba chi cuadrado de bondad de ajuste</span> es adecuada en términos de probar si existe diferencia significativa entre un número observaciones clasificado en distintas categorías y su valor esperado. Por lo anterior, puede ser utilizada para comprobar si la muestra sigue algún tipo de distribución determinado.</p>
<!-- Supuestos: -->
<!-- - La muestra es aleatoria. -->
<!-- - La escala de medida es al menos nominal -->
<p>Este test de hipótesis desarrollado inicialmente para variables categóricas. En el caso general, podemos pensar que los datos están agrupados en <span class="math inline">\(k\)</span> clases <span class="math inline">\(C_1, \ldots, C_n\)</span>.</p>
<ul>
<li class="fragment"><p>Si la variable es categórica o discreta, cada clase se puede corresponder con una modalidad. Si la variable es contínua habrá que categorizarla en intervalos.</p></li>
<li class="fragment"><p>Si la hipótesis nula es simple, cada clase tendrá asociada una probabilidad <span class="math inline">\(p_i = P(X \in C_i)\)</span> bajo <span class="math inline">\(H_0\)</span>.</p></li>
<li class="fragment"><p>Si por el contrario es compuesta, se trabajará con una estimación de dicha probabilidad (y habrá que correguir la distribución aproximada del estadístico del contraste).</p></li>
</ul></section><section class="slide level2"><div class="small">
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 29%">
</colgroup>
<thead><tr class="header">
<th>Clases</th>
<th>Discreta</th>
<th>Contínua</th>
<th>
<span class="math inline">\(H_0\)</span> simple</th>
<th>
<span class="math inline">\(H_0\)</span> compuesta</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(C_1\)</span></td>
<td><span class="math inline">\(x_1\)</span></td>
<td><span class="math inline">\(\left[ L_0, L_1 \right)\)</span></td>
<td><span class="math inline">\(p_1\)</span></td>
<td><span class="math inline">\(\hat{p}_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_k\)</span></td>
<td><span class="math inline">\(x_k\)</span></td>
<td><span class="math inline">\(\left[ L_{k-1}, L_{k} \right)\)</span></td>
<td><span class="math inline">\(p_k\)</span></td>
<td><span class="math inline">\(\hat{p}_k\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\(\sum_{i=1}^k p_i = 1\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^k \hat{p}_i = 1\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="alert">
<p><span class="green">Hipótesis</span></p>
<p>Sea <span class="math inline">\(F(x)\)</span> la distribución verdadera, pero desconocida de <span class="math inline">\(X\)</span> y sea <span class="math inline">\(F^*(x)\)</span> una distribución hipotética, especificada completamente.</p>
<p><span class="math display">\[\begin{eqnarray*}
    H_0&amp;:&amp; F(x) = F^*(x) \qquad \mbox{La función de distribución de la v.a. es $F^*(x)$.}\\
    H_1&amp;:&amp; F(x) \neq F^*(x) \qquad \mbox{La función de distribución de la v.a. es distinta de $F^*(x)$.}
\end{eqnarray*}\]</span></p>
</div>
</section><section class="slide level2"><p>Si <span class="math inline">\(H_0\)</span> es cierta, la frecuencia relativa <span class="math inline">\(f_i\)</span> de la clase <span class="math inline">\(C_i\)</span> es una aproximación de la probabilidad teórica, <span class="math inline">\(f_i \approx p_i\)</span>. Equivalentemente, las frecuencias observadas <span class="math inline">\(n_i = n \dot f_i\)</span> deberían ser próximas a las esperadas <span class="math inline">\(e_i = n \dot p_i\)</span> bajo <span class="math inline">\(H_0\)</span>, sugiriendo el estadístico del contraste <span class="citation" data-cites="Pearson1900">(<a href="#/referencias" role="doc-biblioref" onclick="">Pearson 1900</a>)</span>:</p>
<p><span class="math display">\[\begin{equation*}
    T = \sum_{i=1}^k \frac{(n_i - e_i)^2}{e_i} \sim \chi^2_{k-r-1}
\end{equation*} \qquad \mbox{Si se cumple $H_0$}\]</span></p>
<p>donde <span class="math inline">\(k\)</span> el número de clases y <span class="math inline">\(r\)</span> el número de parámetros estimados del test de hipótesis compuesto.</p>
</section><section class="slide level2"><div class="small">
<table>
<colgroup>
<col style="width: 7%">
<col style="width: 21%">
<col style="width: 22%">
<col style="width: 21%">
<col style="width: 26%">
</colgroup>
<thead><tr class="header">
<th>Clases</th>
<th>
<span class="math inline">\(n_i\)</span> observadas</th>
<th>
<span class="math inline">\(p_i\)</span> bajo <span class="math inline">\(H_0\)</span>
</th>
<th>
<span class="math inline">\(e_i\)</span> bajo <span class="math inline">\(H_0\)</span>
</th>
<th><span class="math inline">\(\frac{(n_i - e_i)^2}{e_i}\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(C_1\)</span></td>
<td><span class="math inline">\(n_1\)</span></td>
<td><span class="math inline">\(p_1\)</span></td>
<td><span class="math inline">\(e_1\)</span></td>
<td><span class="math inline">\(\frac{(n_1 - e_1)^2}{e_1}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_k\)</span></td>
<td><span class="math inline">\(n_k\)</span></td>
<td><span class="math inline">\(p_k\)</span></td>
<td><span class="math inline">\(e_k\)</span></td>
<td><span class="math inline">\(\frac{(n_k - e_k)^2}{e_k}\)</span></td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(\sum_{i=1}^k n_i = n\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^k p_i = 1\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^k e_i = n\)</span></td>
<td><span class="math inline">\(T = \sum_{i=1}^k \frac{(n_i - e_i)^2}{e_i}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>con <span class="math inline">\(p_i^*\)</span> la probabilidad que una observación cualquiera de <span class="math inline">\(X\)</span> pertenezca a la clase <span class="math inline">\(i\)</span>. Bajo el supuesto de que <span class="math inline">\(F^*(x)\)</span> es la función de distribución de <span class="math inline">\(X\)</span>. Siendo <span class="math inline">\(e_i\)</span> la esperanza de las observaciones de la clase <span class="math inline">\(i\)</span> bajo el supuesto de que <span class="math inline">\(H_0\)</span> es verdadero.</p>
</section><section class="slide level2"><div class="alert">
<p><span class="green">Dócima de hipótesis</span></p>
<p>Rechazamos <span class="math inline">\(H_0\)</span> con un nivel <span class="math inline">\(\alpha\)</span> de significancia, si</p>
<p><span class="math display">\[\sum_{i=1}^k \frac{(n_i - e_i)^2}{e_i} \geq \chi_{k-r-1, 1-\alpha}^2\]</span> </p>
<p>Si se efectúa el contraste a partir del p-valor o nivel crítico</p>
<p><span class="math display">\[p = P \left( \chi_{k-r-1}^2 \geq \sum_{i=1}^k \frac{(n_i-e_i)^2}{e_i} \right)\]</span></p>
<p>se rechaza <span class="math inline">\(H_0\)</span> si <span class="math inline">\(p \leq \alpha\)</span> y se aceptará <span class="math inline">\(H_0\)</span> si <span class="math inline">\(p &gt; \alpha\)</span>.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo</span> Un ejemplo empleando la función <code>chisq.test</code> en R, para el caso discreto. Probaremos evaluar el generador de números aleatorios de R:</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># En el caso discreto</span></span>
<span id="cb21-2"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">100</span>))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-3"><a href=""></a><span class="fu">table</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x
 1  2  3  4  5  6 
16 13 15 14 18 24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(x))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(x)
X-squared = 4.76, df = 5, p-value = 0.4459</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Algunas consideraciones para el caso contínuo:</p>
<div class="small">
<ul>
<li class="fragment"><p>El tamaño muestral debe ser suficientemente grande (e.g.&nbsp;<span class="math inline">\(n &gt; 30\)</span>).</p></li>
<li class="fragment"><p>La muestra debe ser una muestra aleatoria simple.</p></li>
<li class="fragment"><p>Los parámetros deben estimarse (si es necesario) por máxima verosimilitud.</p></li>
<li class="fragment"><p>Las frecuencias esperadas <span class="math inline">\(e_i = n \cdot p_i\)</span> deberían ser todas <span class="math inline">\(\geq 5\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="co"># En el caso contínuo, agrupamos las observaciones en percentiles.</span></span>
<span id="cb25-2"><a href=""></a>x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb25-3"><a href=""></a>quant <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>))))</span>
<span id="cb25-4"><a href=""></a>quant</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         0%   16.66667%   33.33333%         50%   66.66667%   83.33333% 
0.006246689 0.130709554 0.300613914 0.461148495 0.730929349 0.901319154 
       100% 
0.999931238 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">table</span>(<span class="fu">cut</span>(x, quant))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
(0.00625,0.131]   (0.131,0.301]   (0.301,0.461]   (0.461,0.731]   (0.731,0.901] 
             16              17              16              17              16 
      (0.901,1] 
             17 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(<span class="fu">cut</span>(x, quant)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(cut(x, quant))
X-squared = 0.090909, df = 5, p-value = 0.9999</code></pre>
</div>
</div>
</section><section class="slide level2"><h3 id="prueba-de-kolmogorov-smirnov">Prueba de Kolmogorov-Smirnov</h3>
<p>Prueba que mide el grado de acuerdo entre distribución de un conjunto de valores muestreados (observaciones) y alguna distribución teórica específica.</p>
<div class="definition">
<ul>
<li class="fragment"><p>Sea <span class="math inline">\(X_1, X_2, ..., X_n\)</span> una muestra aleatoria. La función de distribución empírica <span class="math inline">\(S(x)\)</span> (o también denominada FDE) es una función de <span class="math inline">\(x\)</span>, que iguala la fracción de los <span class="math inline">\(X_i\)</span>s que son menores que , o iguales a <span class="math inline">\(x\)</span>, para cada <span class="math inline">\(x\)</span>, <span class="math inline">\(-\infty &lt; x &lt; \infty\)</span>. La FDE es siempre una función del tipo escalón, que aumenta en <span class="math inline">\(\frac{1}{n}\)</span> en cada valor de la muestra.</p></li>
<li class="fragment"><p>Una forma de comparar la muestra aleatoria, con la distribución <span class="math inline">\(F^*(x)\)</span>, especificada completamente, es a través de la FDE <span class="math inline">\(S(x)\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(S(x)\)</span> es de ayuda en la estimación de <span class="math inline">\(F(x)\)</span>, la distribución desconocida de los <span class="math inline">\(X_i\)</span>s. Entonces, podemos comparar la FDE <span class="math inline">\(S(x)\)</span> con una función de distribución hipotética <span class="math inline">\(F(x)'\)</span>, y evaluar su ajuste.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>El test de Kolmogorov-Smirnov evalúa la distancia más grande entre <span class="math inline">\(S(x)\)</span> y <span class="math inline">\(F(x)'\)</span> asociados a los valores de la muestra</p>

<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">Ejemplo de la FDE <span class="math inline">\(S(x)\)</span> vs una función de distribución conocida <span class="math inline">\(F(x)'\)</span> para una muestra.</p></section><section class="slide level2"><div class="definition">
<p>Sea una muestra aleatoria <span class="math inline">\(X_1, X_2, ..., X_n\)</span> de tamaño <span class="math inline">\(n\)</span> y asociada a alguna distribución desconocida denotada por <span class="math inline">\(F(x)\)</span>.</p>
<p><span class="blue">Estadístico de prueba:</span> Sea <span class="math inline">\(S(x)\)</span> la FDE basada en la muestra aleatoria <span class="math inline">\(X_1, X_2, ..., X_n\)</span>, definida anteriormente. El estadístico de prueba <span class="math inline">\(T\)</span>, denotado por el supremo de la diferencia entre <span class="math inline">\(S(x)\)</span> y <span class="math inline">\(F^*(x)\)</span>, se define para la hipótesis de dos colas de la siguiente manera:</p>
<p><span class="math display">\[ T = \underset{x}{sup}|F(x)' - S(x)| \]</span></p>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="green">Hipótesis para dos colas:</span> Sea <span class="math inline">\(KS_{1-\alpha}\)</span> el cuantil <span class="math inline">\(1-\alpha\)</span> de la distribución del estadístico <span class="math inline">\(T\)</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
        H_0 &amp;:&amp; F(x) = F^*(x) \qquad \forall x \in ]-\infty, \infty [\\
        H_1&amp;:&amp; F(x) \neq F^*(x) \qquad \mbox{Para al menos un valor de $x$}
    \end{eqnarray*}\]</span></p>
<p>Si <span class="math inline">\(T &gt; KS_{(1-\alpha)}\)</span>, rechazar <span class="math inline">\(H_0\)</span>, si no, no rechazar.</p>
</div>
</section><section class="slide level2"><p>Ejemplo: Sean los siguientes datos generados por un generador de números aleatorios con distribución <span class="math inline">\(X \sim N(\mu = 20, \sigma = 5)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>datos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">22.56</span>,<span class="fl">22.33</span>,<span class="fl">24.58</span>,<span class="fl">23.14</span>,<span class="fl">19.03</span>,<span class="fl">26.76</span>,<span class="fl">18.33</span>,<span class="fl">23.10</span>,</span>
<span id="cb31-2"><a href=""></a>           <span class="fl">21.53</span>,<span class="fl">9.06</span>,<span class="fl">16.75</span>,<span class="fl">23.29</span>,<span class="fl">22.14</span>,<span class="fl">16.28</span>,<span class="fl">18.89</span>,<span class="fl">27.48</span>,<span class="fl">10.44</span>,</span>
<span id="cb31-3"><a href=""></a>           <span class="fl">26.86</span>,<span class="fl">27.27</span>,<span class="fl">18.74</span>,<span class="fl">19.88</span>,<span class="fl">15.76</span>,<span class="fl">30.77</span>,<span class="fl">21.16</span>,<span class="fl">24.26</span>,<span class="fl">22.90</span>,</span>
<span id="cb31-4"><a href=""></a>           <span class="fl">27.14</span>,<span class="fl">18.02</span>,<span class="fl">21.53</span>,<span class="fl">24.99</span>,<span class="fl">19.81</span>,<span class="fl">11.88</span>,<span class="fl">24.01</span>,<span class="fl">22.11</span>,<span class="fl">21.91</span>,</span>
<span id="cb31-5"><a href=""></a>           <span class="fl">14.35</span>,<span class="fl">11.14</span>,<span class="fl">9.93</span>,<span class="fl">20.22</span>,<span class="fl">17.73</span>,<span class="fl">19.05</span>)</span>
<span id="cb31-6"><a href=""></a><span class="fu">ks.test</span>(datos, pnorm, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># Una muestra</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  datos
D = 0.13239, p-value = 0.4688
alternative hypothesis: two-sided</code></pre>
</div>
</div>
</section></section><section><section id="aplicación-uso-de-rng-para-evaluar-integrales" class="title-slide slide level1 center" data-background-color="#00A499" data-number="4"><h1>
<span class="header-section-number">4</span> Aplicación: Uso de RNG para evaluar integrales</h1>

</section><section id="caso-univariado" class="slide level2" data-number="4.1"><h2>
<span class="header-section-number">4.1</span> Caso univariado</h2>
<p>Una de las aplicaciones más intuitivas de los generadores de números aleatorios es la aproximación de integrales. Sea <span class="math inline">\(g(x)\)</span> una función y supongamos que queremos calcular <span class="math inline">\(\theta\)</span> donde</p>
<p><span class="math display">\[ \theta = \int_{0}^{1} g(x) dx\]</span></p>
<p>Para calcular el valor de <span class="math inline">\(\theta\)</span> podemos emplear <span class="math inline">\(U\)</span>, que se encuentra distribuído uniformemente entre <span class="math inline">\((0,1)\)</span>. Entonces podemos escribir <span class="math inline">\(\theta\)</span> como</p>
<p><span class="math display">\[ \theta = \mathbb{E}\left[ g(U) \right]\]</span></p>
</section><section class="slide level2"><p>Si <span class="math inline">\(U_1, \ldots, U_k\)</span> son variables aleatorias i.i.d Uniformes en <span class="math inline">\((0,1)\)</span>, la transformación de las variables aleatorias <span class="math inline">\(g(U_1), \ldots g(U_k)\)</span> son también variables aleatorias i.i.d con media <span class="math inline">\(\theta\)</span>. Entonces por la <span class="green">Ley Fuerte de los Grandes Números</span> se tiene que con probabilidad 1</p>
<p><span class="math display">\[ \sum_{i=1}^{k} \frac{g(U_i)}{k} \rightarrow \mathbb{E}\left[ g(U) \right] = \theta \qquad \mbox{cuando } k\rightarrow \infty \]</span></p>
<p>Entonces, es posible aproximar <span class="math inline">\(\theta\)</span> al generar una gran cantidad de números aleatorios <span class="math inline">\(u_i\)</span> y considerarlos como una aproximación al valor esperado de <span class="math inline">\(g(u_i)\)</span>. Este enfoque para aproximar integrales es conocido como el <span class="green">Método Monte Carlo</span>.</p>
</section><section class="slide level2"><p>Si se quiere efectuar una estimación de una integral de la siguiente forma</p>
<p><span class="math display">\[\int_{a}^{b} g(x) dx\]</span></p>
<p>Podemos hacer la sustitución de <span class="math inline">\(u = \frac{x-a}{b-a}\)</span> cuando <span class="math inline">\(x \rightarrow a\)</span>, entonces cuando <span class="math inline">\(x \rightarrow b\)</span>, <span class="math inline">\(u \rightarrow 1\)</span>. Además tenemos que <span class="math inline">\(du = \frac{dx}{b-a}\)</span>, lo que implica que <span class="math inline">\(x = (b-a)u +a\)</span>, y <span class="math inline">\(dx = (b-a)du\)</span>.</p>
<p>Entonces, podemos escribir la integral de la siguiente manera</p>
<p><span class="math display">\[\int_{0}^{1} g((b-a)u+a)(b-a) du = \int_{0}^{1} h(u) du\]</span></p>
<p>con <span class="math inline">\(h(u) = (b-a)g(a+(b-a)u)\)</span></p>
</section><section id="caso-multivariado" class="slide level2" data-number="4.2"><h2>
<span class="header-section-number">4.2</span> Caso multivariado</h2>
<p>Digamos que ahora <span class="math inline">\(g\)</span> es una función con argumento <span class="math inline">\(n\)</span>-dimensional y estamos interesados en el cálculo de la siguiente integral multivariada</p>
<p><span class="math display">\[
\theta = \int_{0}^{1} \int_{0}^{1} \cdots \int_{0}^{1} g(x_1, x_2, \ldots, x_n) \, dx_1 \, dx_2 \cdots dx_n
\]</span></p>
<p>La aproximación de Monte Carlo para estimar <span class="math inline">\(\theta\)</span> puede expresarse como el valor esperado:</p>
<p><span class="math display">\[
\theta = \mathbb{E}[g(U_1, U_2, \ldots, U_n)]
\]</span></p>
<p>donde <span class="math inline">\(U_1, U_2, \ldots, U_n\)</span> son v.a. i.i.d. uniformes en <span class="math inline">\((0,1)\)</span>.</p>
</section><section class="slide level2"><p>Entonces, generando <span class="math inline">\(k\)</span> conjuntos independientes, cada uno de <span class="math inline">\(n\)</span> v.a. independientes uniformes <span class="math inline">\((0,1)\)</span></p>
<p><span class="math display">\[
\begin{matrix}
U_{11} &amp; U_{12} &amp; \cdots &amp; U_{1n} \\
U_{21} &amp; U_{22} &amp; \cdots &amp; U_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
U_{k1} &amp; U_{k2} &amp; \cdots &amp; U_{kn}
\end{matrix}
\]</span></p>
<p>Dado que <span class="math inline">\(g(U_{i1}, U_{i2}, \ldots, U_{in})\)</span> para <span class="math inline">\(i=1, \ldots, k\)</span>, son todas v.a. i.i.d. con media <span class="math inline">\(\theta\)</span>, podemos estimar <span class="math inline">\(\theta\)</span> como</p>
<p><span class="math display">\[
\theta \approx \frac{1}{k} \sum_{i=1}^{k} g(U_{i1}, U_{i2}, \ldots, U_{in})
\]</span></p>
</section><section id="ejemplos" class="slide level2" data-number="4.3"><h2>
<span class="header-section-number">4.3</span> Ejemplos</h2>
<h3 id="ejemplo-1">Ejemplo 1</h3>
<div class="example">
<p><span class="green">Ejemplo 1:</span> Aproximar la siguiente integral por el Método de Monte Carlo</p>
<p><span class="math display">\[\int_{0}^{1} e^{-x^2}dx\]</span></p>
</div>
</section><section class="slide level2"><p><span class="green">Solución:</span> Primero escribimos la función, y evaluamos su forma gráficamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>g <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb33-2"><a href=""></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-3"><a href=""></a>}</span>
<span id="cb33-4"><a href=""></a><span class="fu">curve</span>(g,<span class="at">xlab=</span><span class="st">"Función"</span>,<span class="at">ylab=</span><span class="st">""</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"></section><section class="slide level2"><p>Luego, generamos <code>1000</code> números aleatorios en el intervalo <span class="math inline">\((0,1)\)</span>, evaluamos cada valor de la secuencia generada y computamos la media de los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb34-2"><a href=""></a>U <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb34-3"><a href=""></a><span class="fu">head</span>(U)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8369425 0.3208675 0.6803633 0.6981731 0.4570092 0.7014203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="co"># Estimación de la integral</span></span>
<span id="cb36-2"><a href=""></a><span class="fu">mean</span>(<span class="fu">g</span>(U))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7472925</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Podemos evaluar gráficamente la convergencia de nuestra aproximación de la integral</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-3"><a href=""></a>n <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb38-4"><a href=""></a>sim <span class="ot">=</span> <span class="fu">data.frame</span>(n, <span class="at">Int =</span> <span class="fu">cumsum</span>(<span class="fu">g</span>(U))<span class="sc">/</span>n)</span>
<span id="cb38-5"><a href=""></a>sim <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>Int)) <span class="sc">+</span></span>
<span id="cb38-7"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb38-8"><a href=""></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"><p> Además, comparamos con la estimación que efectúa R directamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="fu">integrate</span>(g, <span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7468241 with absolute error &lt; 8.3e-15</code></pre>
</div>
</div>
</section><section class="slide level2"><h3 id="ejemplo-2">Ejemplo 2</h3>
<div class="example">
<p><span class="green">Ejemplo 2:</span> Aproximar la siguiente integral por el Método de Monte Carlo</p>
<p><span class="math display">\[\int_{-2}^{2} \left[ cos(50x) + sin(20x) \right]^2 dx\]</span></p>
</div>
</section><section class="slide level2"><p><span class="green">Solución:</span> Primero escribimos la función, y evaluamos su forma gráficamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a>g <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb41-2"><a href=""></a>  (<span class="fu">cos</span>(<span class="dv">50</span><span class="sc">*</span>x)<span class="sc">+</span><span class="fu">sin</span>(<span class="dv">20</span><span class="sc">*</span>x))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-3"><a href=""></a>}</span>
<span id="cb41-4"><a href=""></a><span class="fu">curve</span>(g,<span class="at">from=</span> <span class="sc">-</span><span class="dv">2</span>,<span class="at">to =</span> <span class="dv">2</span>,<span class="at">xlab=</span><span class="st">"Función"</span>,<span class="at">ylab=</span><span class="st">""</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section><section class="slide level2"><p>Generamos una secuencia suficientemente larga de números aleatorios en el intervalo <span class="math inline">\((0,1)\)</span>. Luego evaluamos cada valor de <span class="math inline">\(U\)</span> con la sustitución <span class="math inline">\(h(u) = (b-a)g(a+(b-a)u)\)</span> y promediamos los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb42-2"><a href=""></a>U <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb42-3"><a href=""></a><span class="fu">head</span>(U)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8369425 0.3208675 0.6803633 0.6981731 0.4570092 0.7014203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a>a <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb44-2"><a href=""></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb44-3"><a href=""></a>h <span class="ot">=</span> (b<span class="sc">-</span>a)<span class="sc">*</span><span class="fu">g</span>((b<span class="sc">-</span>a)<span class="sc">*</span>U<span class="sc">+</span>a)</span>
<span id="cb44-4"><a href=""></a><span class="fu">mean</span>(h)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.079631</code></pre>
</div>
</div>
</section><section class="slide level2"><p>También podemos evaluar gráficamente la convergencia de nuestra aproximación de la integral y comparamos con el valor estimado de la integral en R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-3"><a href=""></a>n <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb46-4"><a href=""></a>sim <span class="ot">=</span> <span class="fu">data.frame</span>(n, <span class="at">Int =</span> <span class="fu">cumsum</span>(<span class="fu">g</span>((b<span class="sc">-</span>a)<span class="sc">*</span>U<span class="sc">+</span>a)<span class="sc">*</span>(b<span class="sc">-</span>a))<span class="sc">/</span>n)</span>
<span id="cb46-5"><a href=""></a>sim <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>Int)) <span class="sc">+</span></span>
<span id="cb46-7"><a href=""></a>  <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="fu">integrate</span>(g, <span class="at">lower =</span> <span class="sc">-</span><span class="dv">2</span>,<span class="at">upper =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4.016114 with absolute error &lt; 5.8e-10</code></pre>
</div>
</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section><section class="slide level2"><h3 id="ejemplo-3">Ejemplo 3</h3>
<div class="example">
<p><span class="green">Ejemplo 2:</span> Aproximar la siguiente integral multivariada por el Método de Monte Carlo</p>
<p><span class="math display">\[\int_{0}^{1} \int_{0}^{1} (x_1^2 + x_2^2) dx_2 dx_1\]</span></p>
</div>
</section><section class="slide level2"><p><span class="green">Solución:</span> Siguiendo el procedimiento, consideramos <span class="math inline">\(X = [x_1, x_2]\)</span>, generamos la función y luego simulamos valores de <span class="math inline">\(U=[u_1, u_2]\)</span> en el intervalo <span class="math inline">\((0,1)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a>g <span class="ot">=</span> <span class="cf">function</span>(X){</span>
<span id="cb49-2"><a href=""></a>  X[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>X[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-3"><a href=""></a>}</span>
<span id="cb49-4"><a href=""></a></span>
<span id="cb49-5"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb49-6"><a href=""></a>U1 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb49-7"><a href=""></a>U2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb49-8"><a href=""></a>U <span class="ot">=</span> <span class="fu">cbind</span>(U1,U2)</span>
<span id="cb49-9"><a href=""></a><span class="fu">head</span>(U)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            U1        U2
[1,] 0.8369425 0.7541860
[2,] 0.3208675 0.4017094
[3,] 0.6803633 0.5151423
[4,] 0.6981731 0.3301014
[5,] 0.4570092 0.1025579
[6,] 0.7014203 0.6809831</code></pre>
</div>
</div>
<p>Se evalúa cada valor de <span class="math inline">\(U\)</span> en la función <span class="math inline">\(g\)</span> y se extrae la media</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a>I <span class="ot">=</span> <span class="fu">apply</span>(U,<span class="dv">1</span>,g)</span>
<span id="cb51-2"><a href=""></a><span class="fu">mean</span>(I)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6621755</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Evaluamos la convergencia de la estimación de la integral</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-3"><a href=""></a>n <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb53-4"><a href=""></a>sim <span class="ot">=</span> <span class="fu">data.frame</span>(n, <span class="at">Int =</span> <span class="fu">cumsum</span>(I)<span class="sc">/</span>n)</span>
<span id="cb53-5"><a href=""></a>sim <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>Int)) <span class="sc">+</span></span>
<span id="cb53-7"><a href=""></a>  <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section><section class="slide level2"><p>Evaluando de manera analítica la integral</p>
<p><span class="math display">\[\begin{eqnarray}
\theta &amp; = \int_{0}^{1} \int_{0}^{1} (x_{1}^{2} + x_{2}^{2}) \, dx_{2} \, dx_{1} \\

&amp; = \int_{0}^{1} \left. \left(\frac{1}{3}x_{2}^{3} + x_{1}^{2}x_{2} \right) \right|_{x_{2}=0}^{x_{2}=1} \, dx_{1} \\

&amp; = \int_{0}^{1} \left(x_{1}^{2} + \frac{1}{3} \right) \, dx_{1} \\

&amp; = \left. \left(\frac{1}{3}x_{1}^{3} + \frac{1}{3}x_{1} \right) \right|_{x_{1}=0}^{x_{1}=1} \\

&amp; = \frac{1}{3} + \frac{1}{3} = \frac{2}{3} = 0.6666667
\end{eqnarray}\]</span></p>
</section><section id="estimando-el-valor-de-pi" class="slide level2" data-number="4.4"><h2>
<span class="header-section-number">4.4</span> Estimando el valor de <span class="math inline">\(\pi\)</span>
</h2>
<p>La idea detrás de esta simulación es generar puntos aleatorios uniformes <span class="math inline">\((x, y)\)</span> dentro del dominio. Al estimar <span class="math inline">\(\pi\)</span>, el dominio es el sistema de coordenadas cartesianas bidimensional del cuadrado delimitador de un círculo. Para cada punto generado calculamos la distancia al origen para determinar si la coordenada simulada cae dentro del círculo. Luego agregamos los resultados y aproximamos el valor de <span class="math inline">\(\pi\)</span> tomando la relación de puntos que caen dentro del círculo y el número total de puntos y multiplicando por 4.</p>

<img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-38-1.png" class="quarto-figure quarto-figure-center r-stretch" width="480"></section><section class="slide level2"><p>El área de un círculo está dada por <span class="math inline">\(\pi \cdot r^2\)</span>, y el área del cuadrado que lo delimita corresponde a <span class="math inline">\((2r)^2 = 4r^2\)</span>. Dividiendo ambas áreas resulta</p>
<p><span class="math display">\[\frac{\mbox{área del círculo}}{\mbox{área del cuadrado}} = \frac{\pi \cdot r^2}{4\cdot r^2} = \frac{\pi}{4}\]</span> A partir de lo cual, podemos estimar <span class="math inline">\(\pi\)</span> usando la siguiente fórmula</p>
<p><span class="math display">\[ \pi \approx 4 \cdot \frac{\mbox{puntos simulados en el círculo}}{\mbox{puntos simulados totales}} \]</span></p>
<p>Al simular números aleatorios dentro de este cuadrado, obtenemos valores aproximados para el área del círculo y el área del cuadrado. Por lo tanto, podemos estimar <span class="math inline">\(\pi\)</span> tomando la proporción de puntos simulados que caen dentro del círculo y el número total de puntos simulados, y multiplicar por 4.</p>
<p>Para identificar qué puntos caen dentro del círculo usamos la ecuación del círculo: <span class="math inline">\((x-a)^2 + (y-b)^2 = r^2\)</span>, donde <span class="math inline">\((a, b)\)</span> es el centro del círculo. En nuestro ejemplo, el centro del círculo es <span class="math inline">\((0,0)\)</span> y el radio es 1, así que los puntos simulados que satisfacen <span class="math inline">\(\sqrt{x^2 + y^2} \leq 1\)</span> están dentro del círculo.</p>
</section><section class="slide level2"><div class="example">
<p><span class="green">Práctica 1:</span></p>
<p>Programar una <span class="green">Función para la Simulación</span> que deberá tomar dos argumentos, <code>semilla</code> para la reproducibilidad e <code>iteraciones</code> para poder escoger cuántos puntos simulados se quiere generar.</p>
<p>La función deberá seguir los siguientes pasos:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Establecer la semilla.</p></li>
<li class="fragment"><p>Generar el número elegido de puntos aleatorios de la distribución uniforme, los valores mínimos y máximos se establecen a los límites de nuestro dominio, aquí -1 y 1. Estos números aleatorios se almacenan en dos vectores, uno para las coordenadas <span class="math inline">\(x\)</span> y otro para las coordenadas <span class="math inline">\(y\)</span>.</p></li>
<li class="fragment"><p>Calcula <span class="math inline">\(\sqrt{x^2 + y^2}\)</span> para cada punto <span class="math inline">\((x, y)\)</span> y los almacena en un vector.</p></li>
<li class="fragment"><p>Calcula cuántos puntos caen dentro del círculo evaluando <span class="math inline">\(\sqrt{x^2 + y^2} \leq 1\)</span>.</p></li>
<li class="fragment"><p>Estima <span class="math inline">\(\pi\)</span> multiplicando 4 con la proporción de puntos dentro del círculo y el número total de puntos.</p></li>
<li class="fragment"><p>Devuelve el valor de <span class="math inline">\(\pi\)</span> estimado.</p></li>
</ol>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Práctica 2:</span> Generar una función en R que permita analizar la convergencia al valor verdadero de <span class="math inline">\(\pi\)</span> en la medida que <span class="math inline">\(n \rightarrow \infty\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/figure-revealjs/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section><section><section id="ejercicios-1" class="title-slide slide level1 center" data-background-color="#00A499" data-number="5"><h1>
<span class="header-section-number">5</span> Ejercicios</h1>

</section><section id="generadores-congruenciales" class="slide level2" data-number="5.1"><h2>
<span class="header-section-number">5.1</span> Generadores congruenciales</h2>
<div class="small">
<ol type="1">
<li class="fragment"><p>Si <span class="math inline">\(x0 = 5\)</span> y <span class="math inline">\(x_n = 3x_{n−1} \pmod{150}\)</span>, generar <span class="math inline">\(x_1, \ldots, x_{100}\)</span>. Visualizar la secuencia generada en un histograma de frecuencias y comentar los resultados.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(x_0 = 3\)</span> y <span class="math inline">\(x_n = (5x_{n−1} + 7) \pmod{200}\)</span>, generar <span class="math inline">\(x_1, \ldots, x_{1000}\)</span>. Visualizar la secuencia generada en un histograma de frecuencias y comentar los resultados.</p></li>
</ol>
</div>
</section><section id="calidad-de-los-rng" class="slide level2" data-number="5.2"><h2>
<span class="header-section-number">5.2</span> Calidad de los RNG</h2>
</section><section id="aproximación-de-integrales" class="slide level2" data-number="5.3"><h2>
<span class="header-section-number">5.3</span> Aproximación de integrales</h2>
<p>Aproxime las siguientes integrales mediante el método de Monte Carlo y de ser posible, compare con su valor analítico.</p>
<div class="small">
<ol type="1">
<li class="fragment"><p><span class="math inline">\(\int_{0}^{1} \exp(\exp(x)) \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{0}^{1} (1 - x^2)^{3/2} \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{-2}^{2} \exp(x + x^2) \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{0}^{\infty} x(1 + x^2)^{-2} \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{-\infty}^{\infty} \exp(-x^2) \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{0}^{1} \int_{0}^{1} \exp(- (x^2 + y^2)) \, dy \, dx\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\int_{0}^{\infty} \int_{0}^{x} \exp(- (x + y)) \, dy \, dx\)</span>.</p></li>
</ol>
</div>
</section></section><section id="referencias" class="title-slide slide level1 smaller scrollable" data-number="6"><h1>
<span class="header-section-number">6</span> Referencias</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Andrews1972" class="csl-entry" role="listitem">
Andrews, DF, PJ Bickel, FR Hampel, PJ Huber, WH Rogers, y JW Tuckey. 1972. <span>«Robust estimates of location, Princeton Univ»</span>. Princeton University Press, Princeton.
</div>
<div id="ref-Atkinson1980" class="csl-entry" role="listitem">
Atkinson, AC. 1980. <span>«Tests of pseudo-random numbers»</span>. <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 29 (2): 164-71.
</div>
<div id="ref-bhattacharjee2022search" class="csl-entry" role="listitem">
Bhattacharjee, Kamalika, y Sukanta Das. 2022. <span>«A search for good pseudo-random number generators: Survey and empirical studies»</span>. <em>Computer Science Review</em> 45: 100471.
</div>
<div id="ref-Egger1979" class="csl-entry" role="listitem">
Egger, Marlene J. 1979. <span>«Power transformations to achieve symmetry in quantal bioassay»</span>. <em>Tech. Report</em> 47.
</div>
<div id="ref-hammersley1955million" class="csl-entry" role="listitem">
Hammersley, JM. 1955. <span>«A Million Random Digits with 100,000 Normal Deviates»</span>. Wiley Online Library.
</div>
<div id="ref-MacLaren1965" class="csl-entry" role="listitem">
MacLaren, M Donald, y George Marsaglia. 1965. <span>«Uniform random number generators»</span>. <em>Journal of the ACM (JACM)</em> 12 (1): 83-89.
</div>
<div id="ref-Marsaglia1993" class="csl-entry" role="listitem">
Marsaglia, George, Stephen J Sullivan, Stephen K Park, Keith W Miller, y Paul K Stockmeyer. 1993. <span>«Technical correspondence.»</span> <em>Communications of the ACM</em> 36 (7): 105-11.
</div>
<div id="ref-Morgan2018" class="csl-entry" role="listitem">
Morgan, Byron JT. 2018. <em>Elements of simulation</em>. Routledge.
</div>
<div id="ref-Park1988" class="csl-entry" role="listitem">
Park, Stephen K., y Keith W. Miller. 1988. <span>«Random number generators: good ones are hard to find»</span>. <em>Communications of the ACM</em> 31 (10): 1192-1201.
</div>
<div id="ref-Pearson1900" class="csl-entry" role="listitem">
Pearson, Karl. 1900. <span>«X. On the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling»</span>. <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 50 (302): 157-75.
</div>
</div>
<div class="quarto-auto-generated-content">
<p><img src="images/Usach_P2.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/notes/notes.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/search/search.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="Simulacion_1_Generando_numeros_pseudo_aleatorios_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"b2d725beed1f3159","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>