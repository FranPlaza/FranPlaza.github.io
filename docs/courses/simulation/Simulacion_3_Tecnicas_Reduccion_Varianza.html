<!DOCTYPE html>
<html lang="es"><head>
<script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/clipboard/clipboard.min.js"></script>
<script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/tabby.min.js"></script>
<script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/popper.min.js"></script>
<script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="author" content="Francisco Plaza Vega">
<title>Simulación Estadística</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/dist/theme/quarto.css">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Simulación Estadística</h1>
  <p class="subtitle">Unidad 3: Técnicas de reducción de varianza</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Francisco Plaza Vega 
</div>
<div class="quarto-title-author-email">
<a href="mailto:francisco.plaza.v@usach.cl">francisco.plaza.v@usach.cl</a>
</div>
        <p class="quarto-title-affiliation">
            Ingeniería en Estadística
          </p>
    </div>
</div>

</section><section><section id="introducción" class="title-slide slide level1 center" data-background-color="#00A499" data-number="1"><h1>
<span class="header-section-number">1</span> Introducción</h1>

</section><section id="integración-con-el-método-de-monte-carlo" class="slide level2" data-number="1.1"><h2>
<span class="header-section-number">1.1</span> Integración con el método de Monte Carlo</h2>
<ul>
<li class="fragment"><p>Supongamos que <span class="math inline">\(g(x)\)</span> es una función y que <span class="green">queremos calcular <span class="math inline">\(\int_a^b g(x)dx\)</span></span> (suponiendo que esta integral existe).</p></li>
<li class="fragment"><p>Recordemos que si <span class="math inline">\(X\)</span> es una variable aleatoria con densidad <span class="math inline">\(f(x)\)</span>, entonces <span class="green">el valor esperado de la variable aleatoria <span class="math inline">\(Y = g(X)\)</span></span> es</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[ \mathbb{E}[g(X)] = \int_{-\infty}^{\infty} g(x)f(x)dx.\]</span></p>
</div>
<div class="fragment">
<div class="alert">
<p>Si es posible obtener una muestra aleatoria a partir de la distribución de (X), un estimador insesgado de (E[g(X)]) es la media de la muestra.</p>
</div>
</div>
</section><section id="estimador-simple-de-monte-carlo" class="slide level2" data-number="1.2"><h2>
<span class="header-section-number">1.2</span> Estimador simple de Monte Carlo</h2>
<p>Consideremos la estimación de <span class="math inline">\(\theta = \int_0^1 g(x)dx\)</span>. Si <span class="math inline">\(X_1, \ldots, X_m\)</span> es una muestra aleatoria Uniforme(0,1), entonces</p>
<p><span class="math display">\[ \hat{\theta} = g_m(X) = \frac{1}{m} \sum_{i=1}^{m} g(X_i) \]</span></p>
<p>converge a <span class="math inline">\(E[g(X)] = \theta\)</span> con probabilidad 1, por la <a href="https://es.wikipedia.org/wiki/Ley_de_los_grandes_n%C3%BAmeros">Ley Fuerte de los Grandes Números</a>. <span class="green">El estimador simple de Monte Carlo de <span class="math inline">\(\int_0^1 g(x)dx\)</span> es <span class="math inline">\(g_m(X)\)</span></span>.</p>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Integración simple de Monte Carlo</span></p>
<p>Estimar a través de Monte Carlo la siguiente integral:</p>
<p><span class="math display">\[ \theta = \int_0^1 e^{-x} dx \]</span></p>
<p>y comparar la estimación con el valor exacto.</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-2"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb1-3"><a href=""></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="sc">-</span>x))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La estimación es <span class="math inline">\(\hat{\theta} \approx 0.6309514\)</span> y <span class="math inline">\(\theta = 1 - e^{-1} \approx 0.6321206\)</span>.</p>
</section><section class="slide level2"><h3 id="integración-con-monte-carlo-intervalo-a-b">Integración con Monte Carlo, intervalo <span class="math inline">\([a, b]\)</span>
</h3>
<p>En el caso que se necesite calcular <span class="math inline">\(\int_a^b g(t)dt\)</span>, se deberá efectuar un cambio de variables de manera que los límites de integración sean de 0 a 1. La transformación lineal es <span class="math inline">\(y = (t - a)/(b - a)\)</span> y <span class="math inline">\(dy = (1/(b - a))dt\)</span>. Sustituyendo,</p>
<p><span class="math display">\[ \int_a^b g(t)dt = \int_0^1 g(y(b - a) + a)(b - a)dy. \]</span></p>
<p>Alternativamente, podemos reemplazar la densidad Uniforme(0,1) con cualquier otra densidad soportada en el intervalo entre los límites de integración. Por ejemplo,</p>
<p><span class="math display">\[ \int_a^b g(t)dt = (b - a) \int_a^b g(t) \frac{1}{b - a}dt \]</span></p>
<p>es <span class="math inline">\(b - a\)</span> veces el valor esperado de <span class="math inline">\(g(Y)\)</span>, donde <span class="math inline">\(Y\)</span> tiene la densidad uniforme en <span class="math inline">\((a, b)\)</span>. La integral es, por lo tanto, <span class="math inline">\(b - a\)</span> veces el valor promedio de <span class="math inline">\(g(\cdot)\)</span> sobre <span class="math inline">\((a, b)\)</span>.</p>
</section><section class="slide level2"><div class="example">
<p>Calcular una estimación de Monte Carlo de</p>
<p><span class="math display">\[\theta = \int_2^4 e^{-x} dx \]</span></p>
<p>y comparar la estimación con el valor exacto de la integral.</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb2-2"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">2</span>, <span class="at">max=</span><span class="dv">4</span>)</span>
<span id="cb2-3"><a href=""></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p></p>
<p>La estimación es <span class="math inline">\(\hat{\theta} \approx 0.116655\)</span> y <span class="math inline">\(\theta = e^{-2} - e^{-4} \approx 0.1170196\)</span>.</p>
</section><section class="slide level2"><div class="alert">
<p>Resumiendo: </p>
<p>El estimador simple de Monte Carlo de la integral <span class="math inline">\(\theta = \int_a^b g(x)dx\)</span> se calcula de la siguiente manera:</p>
<div class="small">
<ul>
<li class="fragment"><p>Generar <span class="math inline">\(X_1, \ldots, X_m\)</span>, iid de Uniforme<span class="math inline">\((a, b)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(g(\bar{X}) = \frac{1}{m} \sum g(X_i)\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\hat{\theta} = (b - a) g(\bar{X})\)</span>.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><h3 id="integración-de-monte-carlo-intervalo-no-acotado">Integración de Monte Carlo, intervalo no acotado</h3>
<p>Usaremos el método de Monte Carlo para estimar la cdf normal estándar</p>
<p><span class="math display">\[ \Phi(x) = \int_{-\infty}^x \frac{1}{\sqrt{2\pi}} e^{-t^2/2} \, dt.\]</span></p>
<ul>
<li class="fragment"><p>Notar que <span class="green">no podemos aplicar directamente el algoritmo</span> anterior porque los límites de integración cubren un <span class="orange">intervalo no acotado</span>.</p></li>
<li class="fragment"><p>Sin embargo, podemos dividir este problema en dos casos: <span class="math inline">\(x \geq 0\)</span> y <span class="math inline">\(x &lt; 0\)</span>, y usar la simetría de la densidad normal para manejar el segundo caso.</p></li>
<li class="fragment"><p>Entonces, el problema se traduce en estimar <span class="math inline">\(\theta = \int_0^x e^{-t^2/2} \, dt \quad \text{para} \ x &gt; 0.\)</span></p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>Lo anterior se puede efectuar generando números Uniformes<span class="math inline">\((0, x)\)</span> aleatorios, pero significaría cambiar los parámetros de la distribución uniforme para cada valor diferente de la cdf requerida. Supongamos que preferimos un algoritmo que siempre muestree de Uniforme(0,1).</p></li>
<li class="fragment"><p>Esto se puede lograr mediante un cambio de variables. Haciendo la sustitución <span class="math inline">\(y = t/x\)</span>, tenemos <span class="math inline">\(dt = x \, dy\)</span> y</p></li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[\theta = \int_0^1 x e^{-(xy)^2/2} \, dy.\]</span></p>
</div>
</div>
</section><section class="slide level2"><p>Así, <span class="math inline">\(\theta = E_Y [xe^{-(xY)^2/2}]\)</span>, donde la variable aleatoria <span class="orange"><span class="math inline">\(Y\)</span> tiene la distribución Uniforme(0,1)</span>.</p>
<div class="small">
<ul>
<li class="fragment">Generar números aleatorios iid Uniforme(0,1) <span class="math inline">\(u_1, \ldots, u_m\)</span>, y calcular</li>
</ul>
</div>
<div class="fragment">
<div>
<p><span class="math display">\[\hat{\theta} = g_m(u) = \frac{1}{m} \sum_{i=1}^{m} x e^{-(u_i x)^2 / 2}.\]</span></p>
</div>
</div>
<div class="fragment">
<div class="small">
<ul>
<li class="fragment"><p>La media muestral <span class="math inline">\(\hat{\theta}\)</span> converge a <span class="math inline">\(E[\hat{\theta}] = \theta\)</span> cuando <span class="math inline">\(m \to \infty\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(x &gt; 0\)</span>, la estimación de <span class="math inline">\(\Phi(x)\)</span> es <span class="math inline">\(0.5 + \hat{\theta} / \sqrt{2\pi}\)</span>. Si <span class="math inline">\(x &lt; 0\)</span>, calcular <span class="math inline">\(\Phi(x) = 1 - \Phi(-x)\)</span>.</p></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb3-2"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-3"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb3-4"><a href=""></a>cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb3-5"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb3-6"><a href=""></a>  g <span class="ot">&lt;-</span> x[i] <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(u <span class="sc">*</span> x[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb3-7"><a href=""></a>  cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb3-8"><a href=""></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section class="slide level2"><p>Las estimaciones <span class="math inline">\(\hat{\theta}\)</span> para diez valores de <span class="math inline">\(x\)</span> se almacenan en el vector cdf. Comparar las estimaciones con el valor <span class="math inline">\(\Phi(x)\)</span> computado (numéricamente) por la función <code>pnorm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>Phi <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb4-2"><a href=""></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x, cdf, Phi), <span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
x   0.10 0.367 0.633 0.900 1.167 1.433 1.700 1.967 2.233 2.500
cdf 0.54 0.643 0.737 0.817 0.880 0.927 0.959 0.980 0.994 1.001
Phi 0.54 0.643 0.737 0.816 0.878 0.924 0.955 0.975 0.987 0.994</code></pre>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejercicio</span> </p>
<p>Notar que en el ejemplo anterior habría sido más simple generar variables aleatorias Uniforme<span class="math inline">\((0, x)\)</span> y omitir la transformación. <span class="orange">Esto se deja como un ejercicio</span>.</p>
<p>De hecho, la integral de los ejemplos anteriores es en sí una función de densidad, y es posible generar variables aleatorias de esta densidad. Esto proporciona un enfoque más directo a la integral.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span> </p>
<p>Sea <span class="math inline">\(I(\cdot)\)</span> la función indicadora, y <span class="math inline">\(Z \sim N(0, 1)\)</span>. Entonces, para cualquier constante <span class="math inline">\(x\)</span>, tenemos <span class="math inline">\(E[I(Z \leq x)] = P(Z \leq x) = \Phi(x)\)</span>, la cdf normal estándar evaluada en <span class="math inline">\(x\)</span>.</p>
<p>Generar una muestra aleatoria <span class="math inline">\(z_1, \ldots, z_m\)</span> de la distribución normal estándar. Entonces, la media muestral</p>
<p><span class="math display">\[\hat{\Phi}(x) = \frac{1}{m} \sum_{i=1}^{m} I(z_i \leq x)\]</span></p>
<p>converge con probabilidad 1 a su valor esperado <span class="math inline">\(E[I(Z \leq x)] = P(Z \leq x) = \Phi(x)\)</span>.</p>
</div>
</section><section class="slide level2"><div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb6-2"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb6-3"><a href=""></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb6-4"><a href=""></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb6-5"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x, z) {<span class="fu">mean</span>(z <span class="sc">&lt;</span> x)}, <span class="at">z =</span> z)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p></p>
<p>Ahora, las estimaciones en <code>p</code> para la secuencia de valores de <span class="math inline">\(x\)</span> se pueden comparar con el resultado de la función <code>pnorm</code> de la cdf normal en R.</p>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>Phi <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb7-2"><a href=""></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x, p, Phi), <span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
x   0.100 0.367 0.633 0.900 1.167 1.433 1.700 1.967 2.233 2.500
p   0.535 0.636 0.729 0.815 0.880 0.926 0.956 0.977 0.989 0.994
Phi 0.540 0.643 0.737 0.816 0.878 0.924 0.955 0.975 0.987 0.994</code></pre>
</div>
</div>
<p></p>
<p>En este ejemplo, comparado con los resultados del Ejemplo anterior, parece que tenemos una mejor concordancia con <code>pnorm</code> en la cola superior, pero peor concordancia cerca del centro.</p>
</section><section class="slide level2"><div class="alert">
<p>En resumen: </p>
<p>Si <span class="math inline">\(f(x)\)</span> es una función de densidad de probabilidad soportada en un conjunto <span class="math inline">\(A\)</span> (es decir, <span class="math inline">\(f(x) \geq 0\)</span> para todo <span class="math inline">\(x \in \mathbb{R}\)</span> y <span class="math inline">\(\int_A f(x) = 1\)</span>), para estimar la integral</p>
<p><span class="math display">\[\theta = \int_A g(x)f(x)dx,\]</span></p>
<p>Se debe generar una muestra aleatoria <span class="math inline">\(x_1, \ldots, x_m\)</span> de la distribución <span class="math inline">\(f(x)\)</span>, y calcular la media muestral</p>
<p><span class="math display">\[\hat{\theta} = \frac{1}{m} \sum_{i=1}^{m} g(x_i).\]</span></p>
<p>Entonces, con probabilidad uno, <span class="math inline">\(\hat{\theta}\)</span> converge a <span class="math inline">\(E[\hat{\theta}] = \theta\)</span> cuando <span class="math inline">\(m \to \infty\)</span>.</p>
</div>
</section><section id="el-error-estándar-de-la-estimación" class="slide level2" data-number="1.3"><h2>
<span class="header-section-number">1.3</span> El error estándar de la estimación</h2>
<div class="definition">
<p><span class="blue">El error estándar de <span class="math inline">\(\hat{\theta} = \frac{1}{m} \sum_{i=1}^{m} g(x_i)\)</span>:</span></p>
<ul>
<li class="fragment"><p>La <span class="green">varianza de <span class="math inline">\(\hat{\theta}\)</span></span> es <span class="math inline">\(\sigma^2 / m\)</span>, donde <span class="math inline">\(\sigma^2 = Var_f(g(X))\)</span>.</p></li>
<li class="fragment"><p>Cuando la <span class="green">distribución de <span class="math inline">\(X\)</span> es desconocida</span>, sustituimos <span class="math inline">\(F_X\)</span> por la distribución empírica <span class="math inline">\(F_m\)</span> de la muestra <span class="math inline">\(x_1, \ldots, x_m\)</span>.</p></li>
<li class="fragment"><p>La varianza de <span class="math inline">\(\hat{\theta}\)</span> <span class="green">puede estimarse por</span></p></li>
</ul>
<div class="fragment">
<p><span id="eq-varianza"><span class="math display">\[\frac{\hat{\sigma}^2}{m} = \frac{1}{m^2} \sum_{i=1}^{m} [g(x_i) - \bar{g}(x)]^2. \qquad(1)\]</span></span></p>
</div>
</div>
</section><section class="slide level2"><p>Notar que</p>
<p><span class="math display">\[\frac{1}{m} \sum_{i=1}^{m} [g(x_i) - \bar{g}(x)]^2\]</span></p>
<p>es el <span class="green">estimador <em>plug-in</em> de <span class="math inline">\(Var(g(X))\)</span></span>. Es decir, la <a href="#/el-error-estándar-de-la-estimación" class="quarto-xref">Ecuación&nbsp;1</a> es la varianza de <span class="math inline">\(U\)</span>, donde <span class="math inline">\(U\)</span> está uniformemente distribuido en el conjunto de repeticiones <span class="math inline">\(\{g(x_i)\}\)</span>.</p>
<p></p>
<p>La estimación correspondiente del error estándar de <span class="math inline">\(\hat{\theta}\)</span> es</p>
<p><span class="math display">\[\hat{s}_e(\hat{\theta}) = \frac{\hat{\sigma}}{\sqrt{m}} = \frac{1}{m} \left\{ \sum_{i=1}^{m} [g(x_i) - \bar{g}(x)]^2 \right\}^{1/2}.\]</span></p>
</section><section class="slide level2"><p>El <a href="https://es.wikipedia.org/wiki/Teorema_del_l%C3%ADmite_central">Teorema Central del Límite</a> implica que</p>
<p><span class="math display">\[\frac{\hat{\theta} - E[\hat{\theta}]}{\sqrt{Var \hat{\theta}}}\]</span></p>
<p><span class="green">converge en distribución a <span class="math inline">\(N(0, 1)\)</span> cuando <span class="math inline">\(m \to \infty\)</span></span>. Por lo tanto, si <span class="math inline">\(m\)</span> es suficientemente grande, <span class="math inline">\(\hat{\theta}\)</span> es aproximadamente normal con media <span class="math inline">\(\theta\)</span>.</p>
<p></p>
<p>La distribución normal de una gran muestra de <span class="math inline">\(\hat{\theta}\)</span> puede aplicarse para poner límites de confianza o límites de error en la estimación de Monte Carlo de la integral, y verificar la convergencia.</p>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Límites de error para la integración de MC</span></p>
<p>Estimar la varianza del estimador en el Ejemplo anterior, y construir intervalos de confianza aproximados del 95% para la estimación de <span class="math inline">\(\Phi(2)\)</span> y <span class="math inline">\(\Phi(2.5)\)</span>.</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-2"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb9-3"><a href=""></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb9-4"><a href=""></a>g <span class="ot">&lt;-</span> (z <span class="sc">&lt;</span> x)  <span class="co"># la función indicadora</span></span>
<span id="cb9-5"><a href=""></a>v <span class="ot">&lt;-</span> <span class="fu">mean</span>((g <span class="sc">-</span> <span class="fu">mean</span>(g))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> m</span>
<span id="cb9-6"><a href=""></a>cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">c</span>(cdf, v)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.734000e-01 2.589244e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">c</span>(cdf <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(v), cdf <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(v))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9702461 0.9765539</code></pre>
</div>
</div>
<p></p>
<div class="small">
<p>La probabilidad <span class="math inline">\(P(I(Z &lt; x) = 1)\)</span> es <span class="math inline">\(\Phi(2) \approx 0.973\)</span>. Aquí <span class="math inline">\(g(X)\)</span> tiene la distribución de la proporción muestral de 1’s en <span class="math inline">\(m = 10000\)</span> ensayos de Bernoulli con <span class="math inline">\(p \approx 0.973\)</span>, y la varianza de <span class="math inline">\(g(X)\)</span> es, por lo tanto, <span class="math inline">\((0.973)(1 - 0.973)/10000 = 2.6271\times 10^{-6}\)</span>. La estimación de MC <span class="math inline">\(2.589244\times 10^{-6}\)</span> de la varianza es bastante cercana a este valor.</p>
</div>
</div>
</section><section class="slide level2"><div class="small">
<p>Para <span class="math inline">\(x = 2.5\)</span>, el resultado es</p>
</div>
<p></p>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.93500e-01 6.45775e-07</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9919249 0.9950751</code></pre>
</div>
</div>
<p></p>
<div class="small">
<p>La probabilidad <span class="math inline">\(P(I(Z &lt; x) = 1)\)</span> es <span class="math inline">\(\Phi(2.5) \approx 0.994\)</span>. La estimación de Monte Carlo <span class="math inline">\(6.45775\times 10^{-7}\)</span> de la varianza es aproximadamente igual al valor teórico <span class="math inline">\((0.994)(1 - 0.994)/10000 = 5.964\times 10^{-7}\)</span>.</p>
</div>
</div>
</section><section id="varianza-y-eficiencia" class="slide level2" data-number="1.4"><h2>
<span class="header-section-number">1.4</span> Varianza y Eficiencia</h2>
<div class="alert">
<p>El <span class="green">método de Monte Carlo para estimar la integral <span class="math inline">\(\int_a^b g(x)dx\)</span></span> consiste en representar la integral como <span class="orange">el valor esperado de una función de una variable aleatoria uniforme</span>. Es decir, si <span class="math inline">\(X \sim \text{Uniforme}(a, b)\)</span>, entonces <span class="math inline">\(f(x) = \frac{1}{b - a}\)</span>, <span class="math inline">\(a &lt; x &lt; b\)</span>, y</p>
<p><span class="math display">\[\theta = \int_a^b g(x)dx = (b - a) \int_a^b g(x) \frac{1}{b - a}dx = (b - a) E[g(X)].\]</span></p>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="blue">Recordemos:</span></p>
<p>El estimador de Monte Carlo de media muestral de la integral <span class="math inline">\(\theta\)</span> se calcula de la siguiente manera:</p>
<div class="small">
<ul>
<li class="fragment"><p>Generar <span class="math inline">\(X_1, \ldots, X_m\)</span>, iid de Uniforme<span class="math inline">\((a, b)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(g(\bar{X}) = \frac{1}{m} \sum g(X_i)\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(\hat{\theta} = (b - a) g(\bar{X})\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<p>La media muestral <span class="math inline">\(g(\bar{X})\)</span> tiene un valor esperado <span class="math inline">\(g(\bar{X}) = \theta / (b - a)\)</span>, y</p>
<p><span class="math display">\[\text{Var}(g(\bar{X})) = \frac{1}{m} \text{Var}(g(X)).\]</span></p>
</div>
<div class="fragment">
<p>Por lo tanto, <span class="math inline">\(E[\hat{\theta}] = \theta\)</span> y</p>
<p><span id="eq-varianza_recall"><span class="math display">\[\text{Var}(\hat{\theta}) = (b - a)^2 \text{Var}(g(\bar{X})) = \frac{(b - a)^2}{m} \text{Var}(g(X)). \qquad(2)\]</span></span></p>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Según el Teorema Central del Límite, para <span class="math inline">\(m\)</span> grande, <span class="green"><span class="math inline">\(g(\bar{X})\)</span> es aproximadamente normalmente distribuido</span>, y por lo tanto <span class="green"><span class="math inline">\(\hat{\theta}\)</span> es aproximadamente normalmente distribuido</span> con media <span class="math inline">\(\theta\)</span> y varianza dada por la <a href="#/eq-varianza_recall" class="quarto-xref">Ecuación&nbsp;2</a>.</p></li>
<li class="fragment"><p>El enfoque de <span class="orange">“acierto-o-fallo”</span> para la integración de Monte Carlo también utiliza una media muestral para estimar la integral, pero la media muestral se toma sobre una muestra diferente y, por lo tanto, este estimador tiene una varianza diferente a la de la fórmula de la <a href="#/eq-varianza_recall" class="quarto-xref">Ecuación&nbsp;2</a>.</p></li>
</ul></section><section class="slide level2"><p>Supongamos que <span class="math inline">\(f(x)\)</span> es la densidad de una variable aleatoria <span class="math inline">\(X\)</span>. El enfoque de <span class="orange">“acierto-o-fallo”</span> para estimar <span class="math inline">\(F(x) = \int_{-\infty}^x f(t)dt\)</span> es el siguiente:</p>
<div class="small">
<ul>
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(X_1, \ldots, X_m\)</span> de la distribución de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Para cada observación <span class="math inline">\(X_i\)</span>, calcular</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[g(X_i) = I(X_i \leq x) =
\begin{cases}
1, &amp; X_i \leq x; \\
0, &amp; X_i &gt; x.
\end{cases}\]</span></p>
</div>
<ul>
<li class="fragment">Calcular <span class="math inline">\(\hat{F}(x) = g(\bar{X}) = \frac{1}{m} \sum_{i=1}^{m} I(X_i \leq x)\)</span>.</li>
</ul>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Notar que la variable aleatoria <span class="math inline">\(Y = g(X)\)</span> tiene la distribución Binomial(1, <span class="math inline">\(p\)</span>), donde la probabilidad de éxito es <span class="math inline">\(p = P(X \leq x) = F(x)\)</span>.</p></li>
<li class="fragment"><p>La muestra transformada <span class="math inline">\(Y_1, \ldots, Y_m\)</span> son los resultados de <span class="math inline">\(m\)</span> ensayos de Bernoulli independientes e idénticamente distribuidos.</p></li>
<li class="fragment"><p>El estimador <span class="math inline">\(\hat{F}(x)\)</span> es la proporción muestral <span class="math inline">\(\hat{p} = y/m\)</span>, donde <span class="math inline">\(y\)</span> es el número total de éxitos observados en <span class="math inline">\(m\)</span> ensayos.</p></li>
<li class="fragment"><p>Por lo tanto, <span class="math inline">\(E[\hat{F}(x)] = p = F(x)\)</span> y <span class="math inline">\(\text{Var}(\hat{F}(x)) = p(1 - p)/m = F(x)(1 - F(x))/m\)</span>.</p></li>
<li class="fragment"><p>La varianza de <span class="math inline">\(\hat{F}(x)\)</span> puede estimarse por <span class="math inline">\(\hat{p}(1 - \hat{p})/m = \hat{F}(x)(1 - \hat{F}(x))/m\)</span>.</p></li>
<li class="fragment"><p>La varianza máxima ocurre cuando <span class="math inline">\(F(x) = 1/2\)</span>, por lo que una estimación conservadora de la varianza de <span class="math inline">\(\hat{F}(x)\)</span> es <span class="math inline">\(1/(4m)\)</span>.</p></li>
</ul></section><section id="eficiencia" class="slide level2" data-number="1.5"><h2>
<span class="header-section-number">1.5</span> Eficiencia</h2>
<div class="small">
<ul>
<li class="fragment">Si <span class="math inline">\(\hat{\theta}_1\)</span> y <span class="math inline">\(\hat{\theta}_2\)</span> son dos estimadores para <span class="math inline">\(\theta\)</span>, entonces <span class="math inline">\(\hat{\theta}_1\)</span> es más eficiente (en un sentido estadístico) que <span class="math inline">\(\hat{\theta}_2\)</span> si</li>
</ul>
<div class="fragment">
<p><span class="math display">\[\frac{\text{Var}(\hat{\theta}_1)}{\text{Var}(\hat{\theta}_2)} &lt; 1.\]</span></p>
</div>
<ul>
<li class="fragment"><p>Si las varianzas de los estimadores <span class="math inline">\(\hat{\theta}_i\)</span> son desconocidas, podemos estimar la eficiencia sustituyendo una estimación muestral de la varianza para cada estimador.</p></li>
<li class="fragment"><p>Notar que la varianza siempre puede reducirse aumentando el número de réplicas, por lo que la eficiencia computacional también es relevante.</p></li>
</ul>
</div>
</section></section><section><section id="reducción-de-varianza" class="title-slide slide level1 center" data-background-color="#00A499" data-number="2"><h1>
<span class="header-section-number">2</span> Reducción de varianza</h1>

</section><section class="slide level2"><p>En un escenario típico para un estudio de simulación, <span class="green">estamos interesados en determinar <span class="math inline">\(\theta\)</span></span>, un parámetro posiblemente conectado con algún modelo estocástico.</p>
<div class="definition">
<p>Si <span class="math inline">\(\hat{\theta}_1\)</span> y <span class="math inline">\(\hat{\theta}_2\)</span> son estimadores del parámetro <span class="math inline">\(\theta\)</span>, y <span class="math inline">\(\text{Var}(\hat{\theta}_2) &lt; \text{Var}(\hat{\theta}_1)\)</span>, entonces el porcentaje de reducción de la varianza logrado al usar <span class="math inline">\(\hat{\theta}_2\)</span> en lugar de <span class="math inline">\(\hat{\theta}_1\)</span> es</p>
<p><span class="math display">\[ 100 \left( \frac{\text{Var}(\hat{\theta}_1) - \text{Var}(\hat{\theta}_2)}{\text{Var}(\hat{\theta}_1)} \right). \]</span></p>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Ahora, de manera más general, mediante la integración a través del <span class="green">método de Monte Carlo</span>, pudimos observar que dicho método servía para estimar funciones del tipo <span class="math inline">\(\mathbb{E}[g(X)]\)</span>.</p></li>
<li class="fragment"><p>El enfoque de Monte Carlo para estimar <span class="math inline">\(\theta = E[g(X)]\)</span> consiste en calcular la media muestral <span class="math inline">\(g(\bar{X})\)</span> para un gran número <span class="math inline">\(m\)</span> de repeticiones de la distribución de <span class="math inline">\(g(X)\)</span>. La función <span class="math inline">\(g(\cdot)\)</span> suele ser un estadístico; es decir, una función <span class="math inline">\(n\)</span>-variada de <span class="math inline">\(g(X_1, \ldots, X_n)\)</span> de una muestra. Cuando <span class="math inline">\(g(X)\)</span> se usa en ese contexto, se tiene <span class="math inline">\(g(\mathcal{X}) = g(X_1, \ldots, X_n)\)</span>, donde <span class="math inline">\(\mathcal{X}\)</span> denota los mismos elementos. Por simplicidad usamos <span class="math inline">\(g(X)\)</span>.</p></li>
</ul></section><section class="slide level2"><div>
<p>Sean:</p>
<p><span class="math display">\[X^{(j)} = \{X_1^{(j)}, \ldots, X_n^{(j)}\}, \quad j = 1, \ldots, m\]</span></p>
<p>iid provenientes desde la distribución de <span class="math inline">\(X\)</span>, y calculamos las repeticiones correspondientes al experimento</p>
<p><span id="eq-replicas"><span class="math display">\[ Y_j = g(X_1^{(j)}, \ldots, X_n^{(j)}), \quad j = 1, \ldots, m.  \qquad(3)\]</span></span></p>
</div>
<div class="fragment">
<div>
<p>Entonces <span class="math inline">\(Y_1, \ldots, Y_m\)</span> son independientes e idénticamente distribuidos con la distribución de <span class="math inline">\(Y = g(\mathcal{X})\)</span>, y</p>
<p><span class="math display">\[E[\bar{Y}] = E \left[ \frac{1}{m} \sum_{j=1}^{m} Y_j \right] = \theta.\]</span></p>
</div>
</div>
</section><section class="slide level2"><p>Así, el estimador de Monte Carlo <span class="math inline">\(\hat{\theta} = \bar{Y}\)</span> es insesgado para <span class="math inline">\(\theta = E[Y]\)</span>. La varianza del estimador de Monte Carlo es</p>
<p><span class="math display">\[\text{Var}(\hat{\theta}) = \text{Var}(\bar{Y}) = \frac{\text{Var}_f(g(X))}{m}.\]</span></p>
<div class="fragment">
<div class="alert">
<div>
<ul>
<li><p>El <span class="green">incremento del número de repeticiones <span class="math inline">\(m\)</span> reduce la varianza</span> del estimador de Monte Carlo.</p></li>
<li><p>Sin embargo, se necesita un gran aumento en <span class="math inline">\(m\)</span> para obtener incluso una pequeña mejora en el error estándar.</p></li>
<li><p>Para reducir el error estándar de 0.01 a 0.0001, necesitaríamos aproximadamente 10000 veces el número de repeticiones.</p></li>
<li><p>En general, si el error estándar debe ser como máximo <span class="math inline">\(e\)</span> y <span class="math inline">\(\text{Var}_f(g(X)) = \sigma^2\)</span>, entonces <span class="math inline">\(m \geq [\sigma^2 / e^2]\)</span> repeticiones son necesarias.</p></li>
</ul>
</div>
</div>
</div>
</section><section class="slide level2"><div class="alert">
<div>
<ul>
<li><p>Así, aunque la varianza siempre se puede reducir aumentando el número de repeticiones de Monte Carlo, el costo computacional es alto.</p></li>
<li><p>Otros métodos para reducir la varianza se pueden aplicar y son menos costosos computacionalmente que simplemente aumentar el número de repeticiones.</p></li>
</ul>
</div>
</div>
<div class="fragment">
<p>En esta unidad revisaremos algunos métodos para reducir la varianza del estimador de la media muestral obtenido por simulación <span class="math inline">\(\bar{X}\)</span> de <span class="math inline">\(\theta = E[g(X)]\)</span>.</p>
<!-- Sin embargo, antes de presentar estas técnicas de reducción de varianza, ilustremos las posibles dificultades, incluso en modelos bastante simples, de usar el estimador de simulación crudo. -->
</div>
</section></section><section><section id="variables-antitéticas" class="title-slide slide level1 center" data-background-color="#00A499" data-number="3"><h1>
<span class="header-section-number">3</span> Variables antitéticas</h1>

</section><section class="slide level2"><p>Consideremos la media de dos variables aleatorias idénticamente distribuidas <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span>. Si <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span> son independientes, entonces</p>
<p><span class="math display">\[ \text{Var} \left( \frac{U_1 + U_2}{2} \right) = \frac{1}{4} (\text{Var}(U_1) + \text{Var}(U_2)), \]</span></p>
<p>pero en general tenemos</p>
<p><span class="math display">\[ \text{Var} \left( \frac{U_1 + U_2}{2} \right) = \frac{1}{4} (\text{Var}(U_1) + \text{Var}(U_2) + 2\text{Cov}(U_1, U_2)), \]</span></p>
<p>así que la varianza de <span class="math inline">\((U_1 + U_2)/2\)</span> es menor si <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span> están negativamente correlacionadas que cuando las variables son independientes. Este hecho nos lleva a considerar variables negativamente correlacionadas como un posible método para reducir la varianza.</p>
</section><section class="slide level2"><p>Por ejemplo, supongamos que <span class="math inline">\(X_1, \ldots, X_n\)</span> son simulados mediante el método de la transformación inversa. Para cada una de las <span class="math inline">\(m\)</span> réplicas hemos generado <span class="math inline">\(U_j \sim \text{Uniform}(0,1)\)</span>, y calculamos <span class="math inline">\(X^{(j)} = F_X^{-1}(U_j)\)</span>, <span class="math inline">\(j = 1, \ldots, n\)</span>. Nótese que si <span class="math inline">\(U\)</span> está uniformemente distribuido en <span class="math inline">\((0, 1)\)</span> entonces <span class="math inline">\(1 - U\)</span> tiene la misma distribución que <span class="math inline">\(U\)</span>, pero <span class="math inline">\(U\)</span> y <span class="math inline">\(1 - U\)</span> están negativamente correlacionados. Entonces tomando en cuenta la <a href="#/eq-replicas" class="quarto-xref">Ecuación&nbsp;3</a>.</p>
<p><span class="math display">\[ Y_j = g(F_X^{-1}(U_1^{(j)}), \ldots, F_X^{-1}(U_n^{(j)})) \]</span></p>
<p>tiene la misma distribución que</p>
<p><span class="math display">\[ Y_j' = g(F_X^{-1}(1 - U_1^{(j)}), \ldots, F_X^{-1}(1 - U_n^{(j)})). \]</span></p>
</section><section class="slide level2"><div class="alert">
<p>¿Bajo qué condiciones <span class="math inline">\(Y_j\)</span> y <span class="math inline">\(Y_j'\)</span> están negativamente correlacionados?. <span class="green">Si la función <span class="math inline">\(g\)</span> es monótona, las variables <span class="math inline">\(Y_j\)</span> y <span class="math inline">\(Y_j'\)</span> están negativamente correlacionadas</span>.</p>
<ul>
<li class="fragment"><p>Definimos <span class="math inline">\((x_1, \ldots, x_n) \leq (y_1, \ldots, y_n)\)</span> si <span class="math inline">\(x_j \leq y_j\)</span>, <span class="math inline">\(j = 1, \ldots, n\)</span>.</p></li>
<li class="fragment"><p>Una función <span class="math inline">\(n\)</span>-variada <span class="math inline">\(g = g(X_1, \ldots, X_n)\)</span> es creciente si es creciente en sus coordenadas. Es decir, <span class="math inline">\(g\)</span> es creciente si <span class="math inline">\(g(x_1, \ldots, x_n) \leq g(y_1, \ldots, y_n)\)</span> siempre que <span class="math inline">\((x_1, \ldots, x_n) \leq (y_1, \ldots, y_n)\)</span>.</p></li>
<li class="fragment"><p>Similarmente, <span class="math inline">\(g\)</span> es decreciente si es decreciente en sus coordenadas. Entonces <span class="green"><span class="math inline">\(g\)</span> es monótona si es creciente o decreciente</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="definition">
<div id="prp-antitetica" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposición 1</strong></span> Si <span class="math inline">\(X_1, \ldots, X_n\)</span> son independientes, y <span class="math inline">\(f\)</span> y <span class="math inline">\(g\)</span> son funciones crecientes, entonces</p>
<p><span class="math display">\[E[f(X)g(X)] \geq E[f(X)]E[g(X)].\]</span></p>
</div>
</div>
<p></p>
<div class="definition">
<div id="cor-antitetica" class="theorem corollary">
<p><span class="theorem-title"><strong>Corolario 1</strong></span> Si <span class="math inline">\(g = g(X_1, \ldots, X_n)\)</span> es monótona, entonces</p>
<p><span class="math display">\[ Y = g(F_X^{-1}(U_1), \ldots, F_X^{-1}(U_n)) \]</span></p>
<p>y</p>
<p><span class="math display">\[ Y' = g(F_X^{-1}(1 - U_1), \ldots, F_X^{-1}(1 - U_n)).\]</span></p>
<p>están negativamente correlacionados.</p>
</div>
</div>
<p><strong>Nota</strong>: Las demostraciones de <a href="#/prp-antitetica" class="quarto-xref">Proposición&nbsp;1</a> y <a href="#/cor-antitetica" class="quarto-xref">Corolario&nbsp;1</a> pueden ser revisadas en el libro de <span class="citation" data-cites="Rizzo2019">Rizzo (<a href="#/referencias" role="doc-biblioref" onclick="">2019</a>)</span> (Proposición 5.1 p128 y Corolario 5.1 p129).</p>
</section><section id="aplicación" class="slide level2" data-number="3.1"><h2>
<span class="header-section-number">3.1</span> Aplicación</h2>
<p>Si se requieren <span class="math inline">\(m\)</span> réplicas de Monte Carlo, generamos <span class="math inline">\(m/2\)</span> réplicas</p>
<p><span class="math display">\[ Y_j = g(F_X^{-1}(U_1^{(j)}), \ldots, F_X^{-1}(U_n^{(j)}))\]</span></p>
<p>y las <span class="math inline">\(m/2\)</span> réplicas restantes</p>
<p><span class="math display">\[Y'_j = g(F_X^{-1}(1 - U_1^{(j)}), \ldots, F_X^{-1}(1 - U_n^{(j)})),\]</span></p>
<p>donde <span class="math inline">\(U_i^{(j)}\)</span> son variables iid Uniforme(0,1), <span class="math inline">\(i = 1, \ldots, n\)</span>, <span class="math inline">\(j = 1, \ldots, m/2\)</span>. Entonces, el estimador antitético es</p>
<p><span class="math display">\[\hat{\theta} = \frac{1}{m} \left\{ Y_1 + Y'_1 + Y_2 + Y'_2 + \cdots + Y_{m/2} + Y'_{m/2} \right\}
= \frac{2}{m} \sum_{j=1}^{m/2} \left( \frac{Y_j + Y'_j}{2} \right).\]</span></p>
<p>Así, se requieren <span class="math inline">\(nm/2\)</span> en lugar de <span class="math inline">\(nm\)</span> variables uniformes, y la varianza del estimador de Monte Carlo se reduce utilizando variables antitéticas.</p>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Monte Carlo para estimar la cdf normal estándar</span></p>
<p><span class="math display">\[\Phi(x) = \int_{-\infty}^x \frac{1}{\sqrt{2\pi}} e^{-t^2/2} dt.\]</span></p>
<ul>
<li class="fragment"><p>Repetir la estimación utilizando variables antitéticas y encontrar la reducción aproximada en el error estándar. En este ejemplo (después del cambio de variables) el parámetro objetivo es <span class="math inline">\(\theta = E_U[x e^{-(xU)^2/2}]\)</span>, donde <span class="math inline">\(U\)</span> tiene la distribución Uniforme(0,1).</p></li>
<li class="fragment"><p>Restringiendo la simulación a la cola superior (ver Ejemplo de la cdf, en integrales no acotadas), la función <span class="math inline">\(g(\cdot)\)</span> es monótona, por lo que se satisface la hipótesis del <a href="#/cor-antitetica" class="quarto-xref">Corolario&nbsp;1</a>.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Generar números aleatorios <span class="math inline">\(u_1, \ldots, u_{m/2} \sim \text{Uniforme}(0, 1)\)</span> y calcular la mitad de las réplicas utilizando</p>
<p><span class="math display">\[Y_j = g^{(j)}(u) = x e^{-(u_j x)^2 / 2}, \quad j = 1, \ldots, m/2\]</span></p>
<p>como antes, pero calcular la mitad restante de las réplicas utilizando</p>
<p><span class="math display">\[Y'_j = x e^{-((1 - u_j)x)^2 / 2}, \quad j = 1, \ldots, m/2.\]</span></p>
<p>La media muestral</p>
<p><span class="math display">\[\begin{align}
\hat{\theta} = \bar{g}_m(u) =&amp; \frac{1}{m} \sum_{j=1}^{m/2} \left( x e^{-(u_j x)^2 / 2} + x e^{-((1 - u_j)x)^2 / 2} \right) \\
=&amp; \frac{1}{m/2} \sum_{j=1}^{m/2} \left( \frac{x e^{-(u_j x)^2 / 2} + x e^{-((1 - u_j)x)^2 / 2}}{2} \right).
\end{align}\]</span></p>
<p>converge a <span class="math inline">\(E[\hat{\theta}] = \theta\)</span> cuando <span class="math inline">\(m \to \infty\)</span>. Si <span class="math inline">\(x &gt; 0\)</span>, la estimación de <span class="math inline">\(\Phi(x)\)</span> es <span class="math inline">\(0.5 + \hat{\theta} / \sqrt{2\pi}\)</span>. Si <span class="math inline">\(x &lt; 0\)</span>, compute <span class="math inline">\(\Phi(x) = 1 - \Phi(-x)\)</span>.</p>
</section><section class="slide level2"><p>La estimación de Monte Carlo de la integral <span class="math inline">\(\Phi(x)\)</span> se implementa en la función <code>MC.Phi</code> a continuación. Opcionalmente, <code>MC.Phi</code> calculará la estimación con o sin muestreo antitético. La función <code>MC.Phi</code> podría hacerse más general si se añade un argumento que nombre una función, el integrando (se puede ver <code>integrate</code> para un ejemplo de este tipo de argumento a una función).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb16-2"><a href=""></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href=""></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span></span>
<span id="cb16-4"><a href=""></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb16-5"><a href=""></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb16-6"><a href=""></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb16-7"><a href=""></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb16-8"><a href=""></a>    g <span class="ot">&lt;-</span> x[i] <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(u <span class="sc">*</span> x[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb16-9"><a href=""></a>    cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb16-10"><a href=""></a>  }</span>
<span id="cb16-11"><a href=""></a>  cdf</span>
<span id="cb16-12"><a href=""></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section class="slide level2"><p>Una comparación de las estimaciones obtenidas de un solo experimento de Monte Carlo se muestra a continuación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length=</span><span class="dv">5</span>)</span>
<span id="cb17-2"><a href=""></a>Phi <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb17-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-4"><a href=""></a>MC1 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-5"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-6"><a href=""></a>MC2 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x)</span>
<span id="cb17-7"><a href=""></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x, MC1, MC2, Phi), <span class="dv">5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]    [,2]    [,3]    [,4]    [,5]
x   0.10000 0.70000 1.30000 1.90000 2.50000
MC1 0.53983 0.75825 0.90418 0.97311 0.99594
MC2 0.53983 0.75805 0.90325 0.97132 0.99370
Phi 0.53983 0.75804 0.90320 0.97128 0.99379</code></pre>
</div>
</div>
<p>La reducción aproximada en la varianza puede estimarse para un <span class="math inline">\(x\)</span> dado mediante una simulación con ambos métodos, el enfoque de integración de Monte Carlo simple y el enfoque de variables antitéticas.</p>
</section><section class="slide level2"><div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb19-2"><a href=""></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb19-3"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fl">1.95</span></span>
<span id="cb19-4"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb19-5"><a href=""></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-6"><a href=""></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb19-7"><a href=""></a>}</span>
<span id="cb19-8"><a href=""></a><span class="fu">print</span>(<span class="fu">sd</span>(MC1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.006874616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">print</span>(<span class="fu">sd</span>(MC2))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004392972</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">print</span>((<span class="fu">var</span>(MC1) <span class="sc">-</span> <span class="fu">var</span>(MC2)) <span class="sc">/</span> <span class="fu">var</span>(MC1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9959166</code></pre>
</div>
</div>
<p>El enfoque de variables antitéticas logró aproximadamente una reducción del 99.6% en la varianza en <span class="math inline">\(x = 1.95\)</span>.</p>
</section></section><section><section id="variables-de-control" class="title-slide slide level1 center" data-background-color="#00A499" data-number="4"><h1>
<span class="header-section-number">4</span> Variables de Control</h1>

</section><section class="slide level2"><p>Otro enfoque para reducir la varianza en un estimador de Monte Carlo de <span class="math inline">\(\theta = E[g(X)]\)</span> es el uso de variables de control. Supongamos que hay una función <span class="math inline">\(f\)</span>, tal que <span class="math inline">\(\mu = E[f(X)]\)</span> es conocido, y <span class="math inline">\(f(X)\)</span> está correlacionado con <span class="math inline">\(g(X)\)</span>. Entonces, para cualquier constante <span class="math inline">\(c\)</span>, es fácil comprobar que <span class="math inline">\(\hat{\theta}_c = g(X) + c(f(Y) - \mu)\)</span> es un estimador insesgado de <span class="math inline">\(\theta\)</span>.</p>
<p>La varianza</p>
<p><span class="math display">\[\text{Var}(\hat{\theta}_c) = \text{Var}(g(X)) + c^2 \text{Var}(f(X)) + 2c \text{Cov}(g(X), f(X))\]</span></p>
<p>es una función cuadrática de <span class="math inline">\(c\)</span>. Se minimiza en <span class="math inline">\(c = c^*\)</span>, donde</p>
<p><span class="math display">\[c^* = -\frac{\text{Cov}(g(X), f(X))}{\text{Var}(f(X))}\]</span></p>
<p>y la varianza mínima es</p>
<p><span id="eq-varianza_minima_control"><span class="math display">\[\text{Var}(\hat{\theta}_{c^*}) = \text{Var}(g(X)) - \frac{[\text{Cov}(g(X), f(X))]^2}{\text{Var}(f(X))}. \qquad(4)\]</span></span></p>
</section><section class="slide level2"><p>La variable aleatoria <span class="math inline">\(f(X)\)</span> se llama una variable de control para el estimador <span class="math inline">\(g(X)\)</span>. En la <a href="#/eq-varianza_minima_control" class="quarto-xref">Ecuación&nbsp;4</a> vemos que <span class="math inline">\(\text{Var}(g(X))\)</span> se reduce por</p>
<p><span class="math display">\[\frac{[\text{Cov}(g(X), f(X))]^2}{\text{Var}(f(X))}.\]</span></p>
<p>por lo tanto, la reducción porcentual en la varianza es</p>
<p><span class="math display">\[100 \frac{[\text{Cov}(g(X), f(X))]^2}{\text{Var}(g(X)) \text{Var}(f(X))} = 100 [\text{Cor}(g(X), f(X))]^2.\]</span></p>
<p>Así, es ventajoso si <span class="math inline">\(f(X)\)</span> y <span class="math inline">\(g(X)\)</span> están fuertemente correlacionados. No es posible una reducción de la varianza en el caso de que <span class="math inline">\(f(X)\)</span> y <span class="math inline">\(g(Y)\)</span> no estén correlacionados.</p>
<p>Para calcular la constante <span class="math inline">\(c^*\)</span>, necesitamos <span class="math inline">\(\text{Cov}(g(X), f(X))\)</span> y <span class="math inline">\(\text{Var}(f(X))\)</span>, pero estos parámetros pueden estimarse si es necesario, a partir de un experimento preliminar de Monte Carlo.</p>
</section></section><section id="referencias" class="title-slide slide level1 smaller scrollable" data-background-color="#00A499" data-number="5"><h1>
<span class="header-section-number">5</span> Referencias</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Rizzo2019" class="csl-entry" role="listitem">
Rizzo, Maria L. 2019. <em>Statistical Computing with <span>R</span></em>. Second. The <span>R</span> Series. Chapman &amp; Hall/CRC.
</div>
</div>
<div class="quarto-auto-generated-content">
<p><img src="images/Usach_P2.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/notes/notes.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/search/search.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="Simulacion_3_Tecnicas_Reduccion_Varianza_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"2843736be0b670ed","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>