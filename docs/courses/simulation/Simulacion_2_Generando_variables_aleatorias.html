<!DOCTYPE html>
<html lang="es"><head>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/clipboard/clipboard.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tabby.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/popper.min.js"></script>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="author" content="Francisco Plaza Vega">
<title>Simulación Estadística</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/theme/quarto.css">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="Simulacion_2_Generando_variables_aleatorias_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="Simulacion_2_Generando_variables_aleatorias_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Simulación Estadística</h1>
  <p class="subtitle">Unidad 2: Generando variables aleatorias</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Francisco Plaza Vega 
</div>
<div class="quarto-title-author-email">
<a href="mailto:francisco.plaza.v@usach.cl">francisco.plaza.v@usach.cl</a>
</div>
        <p class="quarto-title-affiliation">
            Ingeniería en Estadística
          </p>
    </div>
</div>

</section><section><section id="introducción" class="title-slide slide level1 center" data-background-color="#00A499" data-number="1"><h1>
<span class="header-section-number">1</span> Introducción</h1>

</section><section class="slide level2"><ul>
<li class="fragment"><p>La <span class="green">simulación de variables aleatorias</span> a partir de distribuciones de probabilidad específicas es una <span class="orange">herramienta fundamental</span> en la estadística computacional.</p></li>
<li class="fragment"><p>El caso más elemental, podría corresponder a <span class="orange">simular la extracción de una observación al azar</span> desde una población finita. Para lograrlo, se hace <span class="orange">necesario el poder generar observaciones aleatorias de la distribución uniforme discreta</span>. <em>Por lo que es <span class="orange">esencial tener un generador adecuado de números pseudoaleatorios</span> uniformes (Unidad anterior)</em>.</p></li>
<li class="fragment"><p>Los métodos para generar variables aleatorias de otras distribuciones de probabilidad dependen del generador de números aleatorios uniformes.</p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>En R, el generador de números pseudoaleatorios uniformes se utiliza con la función <code>runif</code>. Para generar un vector de números (pseudo) aleatorios entre 0 y 1 se usa <code>runif(n)</code>.</p></li>
<li class="fragment"><p>Para generar <span class="math inline">\(n\)</span> números aleatorios <span class="math inline">\(Uniforme(a, b)\)</span> se usa <code>runif(n, a, b)</code>; para una matriz de números aleatorios se utilizan las funciones <code>matrix(runif(n*m), nrow=n, ncol=m)</code> o <code>matrix(runif(n*m), n, m)</code>.</p></li>
<li class="fragment"><p>En esta unidad revisaremos algunas funciones para generar variables aleatorias de distribuciones de probabilidad continuas y discretas, algunas disponibles en R (como <code>rbeta</code>, <code>rgeom</code>, <code>rchisq</code>, etc.), aunque los métodos que describiremos son generales y aplicables a otros tipos de distribuciones y para su uso en bibliotecas externas, programas autónomos o problemas de simulación no estándar.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Muestreando desde una población finita</span></p>
<p>La función <code>sample</code> puede ser utilizada para obtener muestras desde una población, con o sin reemplazo.</p>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Lanzamiento de monedas</span></span>
<span id="cb1-2"><a href=""></a><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 1 0 1 0 1 1 1 1 1</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># Escoger números del loto</span></span>
<span id="cb3-2"><a href=""></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35 32 10 31  4  6</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Permuación de letras a-z</span></span>
<span id="cb5-2"><a href=""></a><span class="fu">sample</span>(letters)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "o" "t" "n" "c" "w" "g" "v" "s" "b" "r" "d" "f" "x" "z" "a" "e" "m" "k" "q"
[20] "l" "u" "j" "i" "y" "p" "h"</code></pre>
</div>
</div>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Muestrear desde una distribución multinomial</span></span>
<span id="cb7-2"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">5</span>))</span>
<span id="cb7-3"><a href=""></a><span class="fu">table</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x
 1  2  3 
22 30 48 </code></pre>
</div>
</div>
</section><section id="algunos-generadores-aleatorios-en-r" class="slide level2" data-number="1.1"><h2>
<span class="header-section-number">1.1</span> Algunos generadores aleatorios en R</h2>
<p>En lo que sigue, revisaremos algunos generadores de números aleatorios con distribuciones conocidas, implementados en R. Sin embargo antes, necesitamos recordar algunos conceptos:</p>
<ul>
<li class="fragment"><p><strong>Función de masa de probabilidad (pmf)</strong>: Describe la probabilidad de que una variable aleatoria discreta adopte un valor específico. En R, se usa <code>d</code> al inicio del nombre de la función, como <code>dbinom</code>.</p></li>
<li class="fragment"><p><strong>Función de distribución de probabilidad (pdf)</strong>: Indica la probabilidad relativa de un valor específico para una variable aleatoria continua. En R, se identifica con <code>d</code>, como <code>dnorm</code>.</p></li>
<li class="fragment"><p><strong>Función de distribución acumulada (cdf)</strong>: Muestra la probabilidad de que una variable aleatoria sea menor o igual a un cierto valor. En R, se usa <code>p</code>, como <code>pnorm</code>.</p></li>
<li class="fragment"><p><strong>Función cuantíl</strong>: El inverso de la cdf, determina el valor de variable para una probabilidad acumulada dada. En R, se usa <code>q</code>, como <code>qnorm</code>.</p></li>
<li class="fragment"><p><strong>Función generadora de números aleatorios</strong>: Genera muestras de una distribución de probabilidad. En R, se identifica con <code>r</code>, como <code>rnorm</code>.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplos: Algunas distribuciones conocidas</span></p>
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Binomial:</strong>
<ul>
<li class="fragment"><p><code>dbinom(x, size, prob, log = FALSE)</code>: Calcula la función de masa de probabilidad (pmf) para un número <code>x</code> de éxitos, dado un <code>size</code> (número total de ensayos) y <code>prob</code> (probabilidad de éxito en un ensayo).</p></li>
<li class="fragment"><p><code>pbinom(q, size, prob, lower.tail = TRUE, log.p = FALSE)</code>: Calcula la función de distribución acumulada (cdf) para un cuantil <code>q</code>, es decir, la probabilidad de obtener un número de éxitos menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qbinom(p, size, prob, lower.tail = TRUE, log.p = FALSE)</code>: Determina el cuantil de la distribución binomial para una probabilidad acumulada <code>p</code>.</p></li>
<li class="fragment"><p><code>rbinom(n, size, prob)</code>: Genera <code>n</code> números aleatorios siguiendo una distribución binomial.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Normal:</strong>
<ul>
<li class="fragment"><p><code>dnorm(x, mean = 0, sd = 1, log = FALSE)</code>: Función de densidad de probabilidad (pdf) para la distribución normal en un punto <code>x</code>, con <code>mean</code> (media) y <code>sd</code> (desviación estándar).</p></li>
<li class="fragment"><p><code>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función de distribución acumulada (cdf) para la normal, probabilidad de que la variable sea menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función cuantil para la normal, determina el valor de variable que corresponde a la probabilidad <code>p</code>.</p></li>
<li class="fragment"><p><code>rnorm(n, mean = 0, sd = 1)</code>: Genera <code>n</code> números aleatorios con distribución normal.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<div class="small">
<ul>
<li class="fragment">
<strong>Distribución Exponencial:</strong>
<ul>
<li class="fragment"><p><code>dexp(x, rate = 1, log = FALSE)</code>: Función de densidad de probabilidad (pdf) para la exponencial en un punto <code>x</code>, con <code>rate</code> (tasa de ocurrencia).</p></li>
<li class="fragment"><p><code>pexp(q, rate = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función de distribución acumulada (cdf) para la exponencial, probabilidad de que la variable sea menor o igual a <code>q</code>.</p></li>
<li class="fragment"><p><code>qexp(p, rate = 1, lower.tail = TRUE, log.p = FALSE)</code>: Función cuantil para la exponencial, determina el valor de variable que corresponde a la probabilidad <code>p</code>.</p></li>
<li class="fragment"><p><code>rexp(n, rate = 1)</code>: Genera <code>n</code> números aleatorios con distribución exponencial.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>Algunas distribuciones de probabilidad univariadas disponibles en R</p>
<div class="alert">
<div class="small">
<table style="width:97%;">
<colgroup>
<col style="width: 30%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th>Distribución</th>
<th style="text-align: center;">cdf</th>
<th style="text-align: center;">Generador</th>
<th>Parámetros</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>beta</td>
<td style="text-align: center;"><code>pbeta</code></td>
<td style="text-align: center;"><code>rbeta</code></td>
<td>shape1, shape2</td>
</tr>
<tr class="even">
<td>binomial</td>
<td style="text-align: center;"><code>pbinom</code></td>
<td style="text-align: center;"><code>rbinom</code></td>
<td>size, prob</td>
</tr>
<tr class="odd">
<td>chi-cuadrado</td>
<td style="text-align: center;"><code>pchisq</code></td>
<td style="text-align: center;"><code>rchisq</code></td>
<td>df</td>
</tr>
<tr class="even">
<td>exponencial</td>
<td style="text-align: center;"><code>pexp</code></td>
<td style="text-align: center;"><code>rexp</code></td>
<td>rate</td>
</tr>
<tr class="odd">
<td>F</td>
<td style="text-align: center;"><code>pf</code></td>
<td style="text-align: center;"><code>rf</code></td>
<td>df1, df2</td>
</tr>
<tr class="even">
<td>gamma</td>
<td style="text-align: center;"><code>pgamma</code></td>
<td style="text-align: center;"><code>rgamma</code></td>
<td>shape, rate or scale</td>
</tr>
<tr class="odd">
<td>geométrica</td>
<td style="text-align: center;"><code>pgeom</code></td>
<td style="text-align: center;"><code>rgeom</code></td>
<td>prob</td>
</tr>
<tr class="even">
<td>lognormal</td>
<td style="text-align: center;"><code>plnorm</code></td>
<td style="text-align: center;"><code>rlnorm</code></td>
<td>meanlog, sdlog</td>
</tr>
<tr class="odd">
<td>binomial negativa</td>
<td style="text-align: center;"><code>pnbinom</code></td>
<td style="text-align: center;"><code>rnbinom</code></td>
<td>size, prob</td>
</tr>
<tr class="even">
<td>normal</td>
<td style="text-align: center;"><code>pnorm</code></td>
<td style="text-align: center;"><code>rnorm</code></td>
<td>mean, sd</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td style="text-align: center;"><code>ppois</code></td>
<td style="text-align: center;"><code>rpois</code></td>
<td>lambda</td>
</tr>
<tr class="even">
<td>T de Student</td>
<td style="text-align: center;"><code>pt</code></td>
<td style="text-align: center;"><code>rt</code></td>
<td>df</td>
</tr>
<tr class="odd">
<td>uniforme</td>
<td style="text-align: center;"><code>punif</code></td>
<td style="text-align: center;"><code>runif</code></td>
<td>min, max</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section><section id="método-de-la-transformada-inversa" class="title-slide slide level1 center" data-background-color="#00A499" data-number="2"><h1>
<span class="header-section-number">2</span> Método de la transformada inversa</h1>

</section><section id="la-idea-intuitiva" class="slide level2" data-number="2.1"><h2>
<span class="header-section-number">2.1</span> La idea intuitiva</h2>
<p>La Función de distribución acumulada (CDF) de una variable aleatoria <span class="math inline">\(X\)</span> evaluada en <span class="math inline">\(x\)</span> es la probabilidad de que <span class="math inline">\(X\)</span> tome un valor igual o menor que <span class="math inline">\(x\)</span> (<span class="math inline">\(P(X) = P(X \leq x)\)</span>). Por ejemplo tomemos la distribución Normal con parámetros <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span></p>

<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>Digamos que muestreamos una variable aleatoria desde la distribución normal <span class="math inline">\(N(\mu=0, \sigma=1)\)</span>, y obtenemos un valor de <span class="math inline">\(x=0.3\)</span>. Al revisar en la CDF podremos revisar el valor de la probabilidad acumulada de <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>x_val <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb9-2"><a href=""></a>y_val <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x_val)</span>
<span id="cb9-3"><a href=""></a>y_val</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6179114</code></pre>
</div>
</div>
</section><section class="slide level2"><p>¿Qué podemos decir de lo anterior?:</p>
<ul>
<li class="fragment"><p>Cuando extraemos una muestra aleatoria <span class="math inline">\(x\)</span> de esta distribución, existe un <span class="math inline">\(62\%\)</span> de que <span class="math inline">\(x \leq 0.3\)</span>. La CDF es una probabilidad, por lo que está en el rango <span class="math inline">\((0,1)\)</span></p></li>
<li class="fragment"><p>La CDF también es una función monótona creciente.</p></li>
</ul>
<div class="alert">
<ul>
<li class="fragment"><p>Esto es el concepto intuitivo del método de la transformada inversa. En vez de evaluar la CDF en <span class="math inline">\(x\)</span>, se evalúa la inversa de la CDF en un punto <span class="math inline">\(u\)</span>, donde <span class="math inline">\(u\)</span> es una variable aleatoria desde una distribución <span class="math inline">\(Uniforme(0,1)\)</span>.</p></li>
<li class="fragment"><p>Iniciamos con un valor aleatorio entre 0 y 1 y empleamos la inversa de la CDF para convertirlo en el valor de <span class="math inline">\(x\)</span> al cual pertenece la distribución objetivo.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>El método de la transformada inversa para generar variables aleatorias está basado en el siguiente teorema <span class="citation" data-cites="Fisher1936">(<a href="#/referencias" role="doc-biblioref" onclick="">Fisher et&nbsp;al. 1936</a>)</span>:</p>
<div class="definition">
<p><span class="blue">Teorema: Transformación integral de la probabilidad</span></p>
<p>Si <span class="math inline">\(X\)</span> es una variable aleatoria contínua con <span class="math inline">\(cdf\)</span> <span class="math inline">\(F_{X}(x)\)</span>, entonces</p>
<p><span class="math display">\[U=F_{X}(X) \sim Uniforme(0,1)\]</span></p>
</div>
</section><section class="slide level2"><p>El método de la transformada inversa para generar variables aleatorias aplica el teorema anterior. Se define la transformación inversa:</p>
<p><span class="math display">\[F_{X}^{-1}(u) = inf\{ x: F_{X}(x)=u \},  \quad 0&lt;u&lt;1.\]</span></p>
<p>Si <span class="math inline">\(U\sim Uniforme(0,1)\)</span>, entonces para todo <span class="math inline">\(x \in \mathbb{R}\)</span> se tiene que</p>
<div class="small">
<span class="math display">\[\begin{array}{l}
P \left( F_{X}^{-1}(U) \leq x \right) =&amp; P \left( inf\{ t: F_{X}(t) =U \} \leq x \right) \\
                                 &amp; P(U \leq F_{X}(x)) \\
                                 &amp; F_{U}(F_{X}(x)) = F_{X}(x),

\end{array}\]</span>
</div>
<p>por lo tanto <span class="math inline">\(F_{X}^{-1}(U)\)</span> tiene la misma distribución que <span class="math inline">\(X\)</span>.</p>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Para generar una observación <span class="math inline">\(X\)</span>, primero generamos una variable aleatoria <span class="math inline">\(Uniforme(0,1)\)</span>, denotada por <span class="math inline">\(u\)</span> y computamos la inversa <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment"><p>Este método es sencillo de implementar, siempre y cuando <span class="math inline">\(F_{X}^{-1}\)</span> sea posible de computar.</p></li>
<li class="fragment"><p>Este método puede ser aplicado para generar variables aleatorias contínuas o discretas.</p></li>
</ul>
<div class="definition">
<p>El método puede ser resumido de la siguiente manera:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Encontrar la función inversa <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment"><p>Escribir una función para calcular <span class="math inline">\(F_{X}^{-1}(u)\)</span>.</p></li>
<li class="fragment">
<p>Para cada variable aleatoria requerida:</p>
<ol type="i">
<li class="fragment">Generar una variable <span class="math inline">\(u \sim Uniforme(0,1)\)</span>.</li>
<li class="fragment">Computar <span class="math inline">\(x= F_{X}^{-1}(u)\)</span>.</li>
</ol>
</li>
</ol>
</div>
</div>
</section><section id="método-de-la-transformada-inversa-caso-contínuo" class="slide level2" data-number="2.2"><h2>
<span class="header-section-number">2.2</span> Método de la transformada inversa, caso contínuo</h2>
<div class="example">
<p><span class="green">Ejemplo:</span> Supongamos que se quiere simular una muestra aleatoria desde una distribución con densidad <span class="math inline">\(f_{X}(x) = 3x^2, \; 0 &lt;x&lt;1\)</span>.</p>
</div>
<ul>
<li class="fragment"><p>En este caso <span class="math inline">\(F_{X}(x) = x^3\)</span> para <span class="math inline">\(0&lt;x&lt;1\)</span> y <span class="math inline">\(F_{X}^{-1}(u) = u^{\frac{1}{3}}\)</span>.</p></li>
<li class="fragment"><p>Generamos los <span class="math inline">\(n\)</span> números aleatorios requeridos como el vector <code>u</code>. Entonces <code>u^(1/3)</code> es un vector de largo <code>n</code> que contiene la muestra <span class="math inline">\(x_1, \ldots, x_n\)</span></p></li>
</ul></section><section class="slide level2"><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb11-3"><a href=""></a>x <span class="ot">=</span> u<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb11-4"><a href=""></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb11-5"><a href=""></a>     <span class="at">ylab=</span><span class="st">"Densidad"</span>) <span class="co">#histograma para la densidad de la muestra</span></span>
<span id="cb11-6"><a href=""></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb11-7"><a href=""></a><span class="fu">lines</span>(y, <span class="dv">3</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span>) <span class="co">#curva de la densidad f(x)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><h3 id="ejemplo-distribución-exponencial">Ejemplo: Distribución exponencial</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución exponencial</span> Es posible generar muestras aleatorias desde una distribución exponencial con media <span class="math inline">\(\frac{1}{\lambda}\)</span>.</p>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(X\sim Exp(\lambda)\)</span>, entonces para <span class="math inline">\(x&gt;0\)</span> la <em>cdf</em> de <span class="math inline">\(X\)</span> es <span class="math inline">\(F_{X}(x) = 1 - e^{-\lambda x}\)</span>.</p></li>
<li class="fragment"><p>La transformación inversa es <span class="math inline">\(F_{X}^{-1}(u) = - \frac{1}{\lambda}log(1-u)\)</span>.</p></li>
<li class="fragment"><p>Notar que <span class="math inline">\(U\)</span> y <span class="math inline">\(1-U\)</span> tienen la misma distribución y en este caso es más sencillo definir <span class="math inline">\(x = - \frac{1}{\lambda}log(u)\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Para generar una muestra aleatoria de tamaño <code>n</code> con parámetro <code>lambda</code> hacemos</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb12-2"><a href=""></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href=""></a>x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">runif</span>(n))<span class="sc">/</span>lambda</span>
<span id="cb12-4"><a href=""></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Distribución exp("</span>,lambda, <span class="st">")"</span>),</span>
<span id="cb12-5"><a href=""></a>     <span class="at">ylab=</span><span class="st">"Densidad"</span>, <span class="at">col =</span> <span class="st">'lightblue'</span>) <span class="co">#histograma para la densidad de la muestra</span></span>
<span id="cb12-6"><a href=""></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">qexp</span>(<span class="fl">0.99</span>, lambda), .<span class="dv">01</span>)</span>
<span id="cb12-7"><a href=""></a><span class="fu">lines</span>(y, <span class="fu">dexp</span>(y), <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><h3 id="ejemplo-distribución-kumaraswami">Ejemplo: Distribución Kumaraswami</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución Kumaraswami</span></p>
<p>La función de <a href="https://en.wikipedia.org/wiki/Kumaraswamy_distribution">distribución Kumaraswami</a> puede ser expresada</p>
<p><span class="math display">\[F_{X}(x) = 1- (1-x^a)^b\]</span></p>
</div>
<p>Tenemos entonces que encontrar la función inversa de la CFF de la función de distribución, al hacer <span class="math inline">\(u = F_{X}(x)\)</span></p>
<p><span class="math display">\[ x= (1-(1-u)^{\frac{1}{b}})^{\frac{1}{a}} = F_{X}^{-1}(u)\]</span></p>
</section><section class="slide level2"><div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1">Gráfico</a></li>
<li><a href="#tabset-1-2">Código en R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href=""></a></span>
<span id="cb13-4"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-5"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb13-6"><a href=""></a>a <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb13-7"><a href=""></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb13-8"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb13-9"><a href=""></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(u) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">pdf_sim =</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>b) ) <span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a),</span>
<span id="cb13-11"><a href=""></a>         <span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n),</span>
<span id="cb13-12"><a href=""></a>         <span class="at">pdf_teorica =</span> a<span class="sc">*</span>b<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span>a)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb13-13"><a href=""></a></span>
<span id="cb13-14"><a href=""></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href=""></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-16"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>pdf_sim, <span class="at">y=</span><span class="fu">after_stat</span>(density)), </span>
<span id="cb13-17"><a href=""></a>                 <span class="at">bins=</span><span class="dv">30</span>, <span class="at">colour=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>pdf_teorica), <span class="at">colour=</span><span class="st">"green4"</span>,<span class="at">lwd =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb13-19"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Densidad f(x)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> </span>
<span id="cb13-20"><a href=""></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Densidad de la distribución Kumaraswami (a="</span>, a, <span class="st">" , b="</span>, b, <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb13-21"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="ejercicios" class="slide level2" data-number="2.3"><h2>
<span class="header-section-number">2.3</span> Ejercicios</h2>
<p>Genere números aleatorios utilizando el método de la inversa de las siguientes distribuciones:</p>
<div>
<div class="small">
<ol type="1">
<li><p>Distribución Cauchy</p></li>
<li><p>Distribución Weibull</p></li>
</ol>
</div>
</div>
</section><section id="método-de-la-transformada-inversa-caso-discreto" class="slide level2" data-number="2.4"><h2>
<span class="header-section-number">2.4</span> Método de la transformada inversa (caso discreto)</h2>
<ul>
<li class="fragment"><p>Supongamos que se necesita generar el valor de una variable aleatoria discreta denotada por <span class="math inline">\(X\)</span>, cuya función de masa de probabilidad está dada por <span class="math display">\[P\{ X = x_j \} = p_j, \qquad j=0,1, \ldots, \sum_{j} p_j = 1\]</span></p></li>
<li class="fragment"><p>Para lograr lo anterior, necesitamos generar un número aleatorio <span class="math inline">\(U\)</span>, tal que <span class="math inline">\(U\)</span> tenga una distribución <span class="math inline">\((0,1)\)</span>, y además establecer que <span class="math display">\[X = \left\{\begin{array}{ll}
x_0 &amp; \mbox{Si} \; U &lt; p_0  \\
x_1 &amp; \mbox{Si} \; p_0 \leq U &lt; p_0 + p_1\\
\vdots &amp; \\
x_j &amp; \mbox{Si} \; \sum_{i=0}^{j-1} p_i \leq U &lt; \sum_{i=0}^{j} p_i  \\
\vdots &amp;
\end{array}\right.\]</span></p></li>
</ul></section><section class="slide level2"><ul>
<li class="fragment"><p>Dado que, para <span class="math inline">\(0&lt;a&lt;b&lt;1\)</span>, <span class="math inline">\(P\{a \leq U &lt; b \} = b-a\)</span>, tenemos que <span class="math display">\[ P\{X = x_j \} = P\left\{ \sum_{i=0}^{j-1} p_i \leq U &lt; \sum_{i=0}^{j} p_i \right\} = p_j \]</span></p></li>
<li class="fragment"><p>Entonces, <span class="math inline">\(X\)</span> tendrá la distribución objetivo.</p></li>
</ul>
<div class="definition">
<p>Podemos escribir el procedimiento anterior como pseudocódigo:</p>
<div class="small">
<ol type="1">
<li class="fragment">Genera un número aleatorio <span class="math inline">\(U\)</span>
<ol type="i">
<li class="fragment">Si <span class="math inline">\(U &lt; p_0\)</span>, entonces <span class="math inline">\(X = x_0\)</span>.</li>
<li class="fragment">Si <span class="math inline">\(U &lt; p_0 + p_1\)</span>, entonces <span class="math inline">\(X = x_1\)</span>
</li>
<li class="fragment">Si <span class="math inline">\(U &lt; p_0 + p_1 + p_2\)</span>, entonces <span class="math inline">\(X = x_2\)</span>
</li>
<li class="fragment"><span class="math inline">\(\vdots\)</span></li>
</ol>
</li>
<li class="fragment">Repetir</li>
</ol>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Si el <span class="math inline">\(i-\)</span>ésimo elemento <span class="math inline">\(x_i, i \geq 0\)</span> está ordenado de tal manera que <span class="math inline">\(x_0 &lt; x_1 &lt; x_2 \cdots\)</span> y dejamos que <span class="math inline">\(F\)</span> sea la función de distribución de <span class="math inline">\(X\)</span>. Así <span class="math inline">\(F(x_k) = \sum_{i=0}^{k}p_i\)</span>, entonces <span class="math display">\[X \quad \mbox{será igual a } x_j \quad \mbox{Si} \quad F(x_{j-1}) \leq U &lt; F(x_k)\]</span></p></li>
<li class="fragment"><p>En otras palabras, después de generar un número aleatorio <span class="math inline">\(U\)</span>, se determina el valor de <span class="math inline">\(X\)</span> al encontrar un intervalo <span class="math inline">\(\left[ F(x_{j−1}), F(x_{j}) \right]\)</span> en el cual se encuentra <span class="math inline">\(U\)</span> (o de forma equivalente, al encontrar la inversa de <span class="math inline">\(F(U), F^{-1}(U)\)</span>) . Por esta razón es que este método recibe su nombre: <span class="green">La transformada inversa para generar <span class="math inline">\(X\)</span></span>.</p></li>
<li class="fragment"><p>La cantidad de tiempo que este método tarda en generar una variable aleatoria discreta será proporiconal al número de intervalos que se deben buscar. Es por esta razón que es necesario considerar los posibles valores de <span class="math inline">\(x_j\)</span> de <span class="math inline">\(X\)</span> en orden decreciente para la <span class="math inline">\(p_j\)</span>.</p></li>
</ul></section><section class="slide level2"><h3 id="ejemplo">Ejemplo</h3>
<div class="example">
<p><span class="green">Ejemplo:</span> Supongamos que queremos simular desde una variable aleatoria <span class="math inline">\(X\)</span> que sigue la siguiente distribución</p>
<p><span class="math display">\[f(x) = \left\{ \begin{align}
0.1 &amp; \quad \mbox{Si } x = 1  \\
0.4 &amp; \quad \mbox{Si } x = 2  \\
0.2 &amp; \quad \mbox{Si } x = 3  \\
0.3 &amp; \quad \mbox{Si } x = 4  \\
\end{align}\right.\]</span></p>
</div>
<p></p>
<p>Tabulamos los posibles valores de <span class="math inline">\(x_i\)</span> y de sus probabilidades <span class="math inline">\(P(X=x_i)\)</span></p>
<div class="small">
<table style="width:29%;">
<colgroup>
<col style="width: 11%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(P(X=x_i)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3</td>
</tr>
</tbody>
</table>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="co"># Valores posibles de x</span></span>
<span id="cb14-2"><a href=""></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb14-3"><a href=""></a></span>
<span id="cb14-4"><a href=""></a><span class="co"># pdf evaluada en cada valor de x</span></span>
<span id="cb14-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb14-6"><a href=""></a></span>
<span id="cb14-7"><a href=""></a><span class="co"># CDF evaluada en cada valor de x</span></span>
<span id="cb14-8"><a href=""></a>(<span class="at">Fx =</span> <span class="fu">cumsum</span>(fx))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1 0.5 0.7 1.0</code></pre>
</div>
</div>
</div><div class="column">
<p>Por lo que nuestra CDF se podría escribir de la siguiente manera:</p>
<p><span class="math display">\[F_{X}(x) = \left\{ \begin{align}
0.1 &amp; \quad \mbox{Si } x = 1  \\
0.5 &amp; \quad \mbox{Si } x = 2  \\
0.7 &amp; \quad \mbox{Si } x = 3  \\
1.0 &amp; \quad \mbox{Si } x = 4  \\
\end{align}\right.\]</span></p>
</div>
</div>
<p>Ahora, en vez de encontrar la inversa de la CDF, la empleamos directamente. Generamos números aleatorios y encontramos el valor más pequeño de <span class="math inline">\(X\)</span> tal que <span class="math inline">\(F(x) \geq u\)</span>:</p>
<div class="small">
<ul>
<li class="fragment">Paso 1: Generar <span class="math inline">\(u\)</span> desde la distribución <span class="math inline">\(Uniforme(0,1)\)</span>;</li>
<li class="fragment">Paso 2: Encontrar el valor más pequeño de <span class="math inline">\(X\)</span> tal que <span class="math inline">\(F(x) \geq u\)</span>. Es decir:
<ul>
<li class="fragment">if <span class="math inline">\(u \leq 0.10\)</span>, entonces <span class="math inline">\(X=1\)</span>;</li>
<li class="fragment">else if <span class="math inline">\(0.10 &lt; u \leq 0.5\)</span>, entonces <span class="math inline">\(X=2\)</span>;</li>
<li class="fragment"><span class="math inline">\(\vdots\)</span></li>
<li class="fragment">else <span class="math inline">\(X=4\)</span>.</li>
</ul>
</li>
</ul>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb16-2"><a href=""></a><span class="fu">library</span>(kableExtra) </span>
<span id="cb16-3"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-4"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb16-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb16-6"><a href=""></a>Fx <span class="ot">=</span> <span class="fu">cumsum</span>(fx)</span>
<span id="cb16-7"><a href=""></a></span>
<span id="cb16-8"><a href=""></a><span class="co"># Especificar los valores de x</span></span>
<span id="cb16-9"><a href=""></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb16-10"><a href=""></a></span>
<span id="cb16-11"><a href=""></a><span class="co"># Encontrar el valor más pequeño de x con la CDF &gt;= u</span></span>
<span id="cb16-12"><a href=""></a>xsim <span class="ot">=</span> <span class="fu">sapply</span>(u, <span class="cf">function</span>(uval) <span class="fu">min</span>(x[Fx <span class="sc">&gt;=</span> uval]))</span>
<span id="cb16-13"><a href=""></a></span>
<span id="cb16-14"><a href=""></a><span class="co"># Mostrar tabla con los resultados</span></span>
<span id="cb16-15"><a href=""></a><span class="fu">tibble</span>(<span class="at">u =</span> u, <span class="at">xsim =</span> xsim) <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">22</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 30px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">u</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">xsim</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.2655087</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3721239</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.5728534</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.9082078</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.2016819</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.8983897</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.9446753</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.6607978</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.6291140</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.0617863</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><p>Finalmente, evaluamos el generador de números aleatorios a través de una muestra más grande.</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-3"><a href=""></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb17-4"><a href=""></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb17-5"><a href=""></a>fx <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb17-6"><a href=""></a>Fx <span class="ot">=</span> <span class="fu">cumsum</span>(fx)</span>
<span id="cb17-7"><a href=""></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb17-8"><a href=""></a></span>
<span id="cb17-9"><a href=""></a><span class="co"># Encontrar el valor más pequeño de x con la CDF &gt;= u</span></span>
<span id="cb17-10"><a href=""></a>xsim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(u, <span class="cf">function</span>(uval) <span class="fu">min</span>(x[Fx <span class="sc">&gt;=</span> uval]))</span>
<span id="cb17-11"><a href=""></a></span>
<span id="cb17-12"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">table</span>(xsim)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-13"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-14"><a href=""></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(xsim, Freq<span class="sc">/</span>n),</span>
<span id="cb17-15"><a href=""></a>           <span class="at">colour=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-16-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribuciones-de-bernoulli-p-y-binomial-n-p">Ejemplo: Distribuciones de Bernoulli (<span class="math inline">\(p\)</span>) y Binomial (<span class="math inline">\(n, p\)</span>)</h3>
<p>Supongamos que queremos generar una variable aleatoria Bernoulli (<span class="math inline">\(p\)</span>) <span class="math inline">\(X\)</span>, en cuyo caso <span class="math inline">\(P(X = 0) = 1-p\)</span> y <span class="math inline">\(P(X = 1) = p\)</span> para algún <span class="math inline">\(p \in (0, 1)\)</span>. Entonces el método de transformación inversa discreta produce:</p>
<div class="alert">
<div class="small">
<p>Algoritmo para generar una v.a. Bernoulli (<span class="math inline">\(p\)</span>) <span class="math inline">\(X\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Genera <span class="math inline">\(u_i \sim \text{unif}(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Establece <span class="math inline">\(x_i = 0\)</span> si <span class="math inline">\(u_i \leq 1-p\)</span>; <span class="math inline">\(x_i = 1\)</span> si <span class="math inline">\(u_i &gt; 1-p\)</span>.</p></li>
<li class="fragment"><p>Repetir pasos 1 y 2 <span class="math inline">\(n\)</span> veces, tal que <span class="math inline">\(i=1, 2, \ldots, n\)</span>.</p></li>
</ol>
</div>
</div>
</section><section class="slide level2"><h3 id="implementación-distribución-bernoulli">Implementación: Distribución <em>Bernoulli</em>
</h3>
<div class="example">
<p><span class="green">Ejemplo: Distribución Bernoulli</span> Aplicamos la transformada inversa discreta para generar una muestra aleatoria <span class="math inline">\(Bernoulli(p=0.4)\)</span>.</p>
<ul>
<li class="fragment"><p>En este ejemplo, <span class="math inline">\(F_{x}(0) = f_{X}(0) =1-p\)</span> y <span class="math inline">\(F_{X}(1) = 1\)</span>.</p></li>
<li class="fragment"><p>Así, <span class="math inline">\(F_{X}^{-1}(u) = 1\)</span> si <span class="math inline">\(u &gt;0.6\)</span> y <span class="math inline">\(F_{X}^{-1}(u) = 0\)</span> si <span class="math inline">\(u \leq 0.6\)</span>.</p></li>
<li class="fragment"><p>El generador de la variable aleatoria debería entregar el valor numérico de la expresión lógica <span class="math inline">\(u&gt;0.6\)</span>.</p></li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-2"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb18-3"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb18-4"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span> p)</span>
<span id="cb18-5"><a href=""></a><span class="fu">head</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0 0 1 0 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">mean</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">var</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2376937</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Podemos comparar los valores de los estadísticos muestrales con los momentos teóricos de la distribución Bernoulli.</p>
<ul>
<li class="fragment"><p>La media muestral de la muestra generada debería ser aproximadamente <span class="math inline">\(p = 0.4\)</span>, en nuestro ejemplo, la media muestral estimada <span class="math inline">\(\bar{x}=\)</span> 0.388.</p></li>
<li class="fragment"><p>La varianza muestral debería ser aproximadamente <span class="math inline">\(p(1-p) = 0.24\)</span> y nuestra varianza muestral <span class="math inline">\(s^2=\)</span> 0.2376937</p></li>
</ul>
<p></p>
<p><strong>Nota</strong>: <em>En R, se puede utilizar la función <code>rbinom</code> (</em>random binomial<em>) de tamaño 1 (<code>size=1</code>) para generar una muestra de tipo Bernoulli. Otro método podría ser utilizar la función <code>sample</code> desde el vector <span class="math inline">\(x=\{0,1\}\)</span> con probabilidades <span class="math inline">\((1-p, p)\)</span>.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb24-2"><a href=""></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">6</span>,.<span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribución-binomial">Ejemplo: Distribución Binomial</h3>
<ul>
<li class="fragment"><p>Supongamos que queremos que <span class="math inline">\(X\)</span> tenga una distribución binomial (<span class="math inline">\(n, p\)</span>), es decir, <span class="math display">\[p(k) = P(X = k) = \binom{n}{k} p^k(1-p)^{n-k}, 0 \leq k \leq n.\]</span></p></li>
<li class="fragment"><p>Uno podría, en principio, usar el método de transformación inversa discreta con estas <span class="math inline">\(p(k)\)</span>, pero también podemos notar que <span class="math inline">\(X\)</span> puede ser representado (en distribución) como la suma de <span class="math inline">\(n\)</span> v.a. Bernoulli (<span class="math inline">\(p\)</span>) i.i.d, <span class="math inline">\(Y_1, \dots, Y_n\)</span>; <span class="math display">\[X = \sum_{i=1}^n Y_i,\]</span> el número de éxitos de <span class="math inline">\(n\)</span> pruebas Bernoulli (<span class="math inline">\(p\)</span>) i.i.d.</p></li>
</ul></section><section class="slide level2"><div class="definition">
<div class="small">
<p>Algoritmo alternativo para generar una v.a. binomial (<span class="math inline">\(n, p\)</span>) <span class="math inline">\(X\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(n\)</span> v.a. i.i.d. <span class="math inline">\(U_1, U_2, \dots, U_n \sim \text{unif}(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Para cada <span class="math inline">\(1 \leq i \leq n\)</span>, establecer <span class="math inline">\(Y_i = 0\)</span> si <span class="math inline">\(U_i \leq 1-p\)</span>; <span class="math inline">\(Y_i = 1\)</span> si <span class="math inline">\(U_i &gt; 1-p\)</span>. (Esto produce <span class="math inline">\(n\)</span> v.a. Bernoulli (<span class="math inline">\(p\)</span>) i.i.d.)</p></li>
<li class="fragment"><p>Establece <span class="math inline">\(X = \sum_{i=1}^n Y_i\)</span>.</p></li>
</ol>
</div>
</div>
<p>La ventaja de este algoritmo es su simplicidad, no necesitamos hacer los diversos cálculos involucrados con las <span class="math inline">\(p(k)\)</span>. Por otro lado, este algoritmo requiere <span class="math inline">\(n\)</span> uniformes para cada copia de <span class="math inline">\(X\)</span> en lugar de solo uno cuando se usa el método de transformación inversa discreta.</p>
<!-- Por lo tanto, podríamos no querer usar este algoritmo cuando $n$ es bastante grande. -->
<!-- - De hecho, cuando $n$ es muy grande, y $p$ es pequeño, se sigue (por ejemplo, puede ser demostrado; hay un teorema aquí), que la distribución de $X$ es muy aproximadamente la distribución de Poisson con media $np$. Esto motiva nuestro próximo ejemplo. -->
</section><section class="slide level2"><!-- --- --><!-- ### Ejemplo: Distribución *Poisson* con media $\alpha$: --><!-- En este caso, --><!-- $$p(k) = P(X = k) = e^{-\alpha} \frac{\alpha^k}{k!}, k \geq 0.$$ --><!-- - Podríamos usar el método de transformación inversa discreta, pero, por supuesto, esto implica calcular (de antemano) intervalos como $\frac{\alpha^k}{k!}$.  --><!-- - Se propone un algoritmo alternativo que hace uso de las propiedades de un proceso de Poisson a tasa $\alpha$. El truco es recordar que si $\{N(t) : t \geq 0\}$ es el proceso de conteo de un proceso de Poisson a tasa $\alpha$, entonces $N(1)$ tiene una distribución de Poisson con media $\alpha$. Así que si podemos simular $N(1)$, entonces podemos establecer $X = N(1)$ y hemos terminado. Sea $Y = N(1) + 1$, y que $t_n = X_1 + \dots + X_n$ denote el $n$-ésimo punto del proceso de Poisson; los $X_i$ son iid con una distribución exponencial a tasa $\alpha$. Note que --><!-- $$Y = \min\{n \geq 1 : t_n > 1\} = \min\{n \geq 1 --><!--  : X_1 + \dots + X_n > 1\},$$ --><!-- un tiempo de parada. Usando el método de transformación inversa para generar los tiempos de llegada exponenciales iid $X_i$, podemos representar $X_i = -\frac{1}{\alpha} \ln(U_i)$. Luego podemos reescribir (recordando que $\ln(xy) = \ln(x)+\ln(y)$) --><!-- $$Y = \min\{n \geq 1 : \ln(U_1) + \dots+ \ln(U_n) < -\alpha\} = \min\{n \geq 1 : \ln(U_1 \dots U_n) < -\alpha\} = \min\{n \geq 1 : U_1 \dots U_n < e^{-\alpha}\}$$ --><!-- Así podemos simular $Y$ simplemente generando uniformes $U_i$ independientes consecutivamente y tomando el producto hasta que el producto caiga por debajo de $e^{-\alpha}$. --><!-- Así podemos simular $Y$ simplemente generando uniformes $U_i$ independientes consecutivamente y tomando el producto hasta que el producto caiga por debajo de $e^{-\alpha}$. Entonces obtenemos $X = N(1) = Y - 1$ como nuestra Poisson deseada. Aquí entonces está el algoritmo resultante: --><!-- ### Algoritmo alternativo para generar una rv Poisson $X$ con media $\alpha$: --><!-- i. Establece $X = 0$, $P = 1$ --><!-- ii. Genera $U \sim \text{unif}(0, 1)$, establece $P = UP$ --><!-- iii. Si $P < e^{-\alpha}$, entonces detente. De lo contrario, si $P \geq e^{-\alpha}$, entonces establece $X = X + 1$ y vuelve a ii. --><!-- --- --><div class="example">
<p><span class="green">Ejemplo: Generación de permutaciones aleatorias</span></p>
<ul>
<li class="fragment">
<p>Consideremos la generación de una permutación de los números <span class="math inline">\(1, 2, \ldots, n\)</span> de tal manera que todos los <span class="math inline">\(n!\)</span> ordenamientos posibles sean igualmente probables.</p>
<ul>
<li class="fragment"><p>El procedimiento inicia seleccionando de manera aleatoria uno de los números <span class="math inline">\(1,\ldots, n\)</span> y colocándolo en la posición <span class="math inline">\(n\)</span>.</p></li>
<li class="fragment"><p>Luego, se elige aleatoriamente uno de los <span class="math inline">\(n - 1\)</span> números restantes, ubicándolo en la posición <span class="math inline">\(n - 1\)</span>.</p></li>
<li class="fragment"><p>El proceso continúa, seleccionando aleatoriamente uno de los <span class="math inline">\(n - 2\)</span> números restantes para la posición <span class="math inline">\(n - 2\)</span>, y así sucesivamente.</p></li>
<li class="fragment"><p>La elección aleatoria de un número significa que cada uno de los números restantes tiene la misma probabilidad de ser seleccionado.</p></li>
</ul>
</li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p>Para simplificar el proceso y evitar tener que identificar exactamente qué números quedan por posicionar, es práctico y eficiente mantener los números en una lista ordenada. Entonces, en lugar de elegir el número directamente, se selecciona aleatoriamente la posición del número. Partiendo de un ordenamiento inicial <span class="math inline">\(P_1, P_2, \ldots, P_n\)</span>, se elige una posición de <span class="math inline">\(1, \ldots, n\)</span> al azar, intercambiando el número en esa posición con el que está en la posición <span class="math inline">\(n\)</span>. Posteriormente, se selecciona una de las posiciones <span class="math inline">\(1, \ldots, n - 1\)</span> de manera aleatoria, intercambiando el número en esta posición con el que está en la posición <span class="math inline">\(n - 1\)</span>, y este procedimiento se repite sucesivamente.</p>
</div>
</section><section class="slide level2"><p>Recordando que <span class="math inline">\(\text{Int}(kU) + 1\)</span> tendrá la misma probabilidad de tomar cualquiera de los valores <span class="math inline">\(1, 2, \ldots, k\)</span>, vemos que el algoritmo anterior para generar una permutación aleatoria puede escribirse de la siguiente manera:</p>
<div class="small">
<div class="alert">
<ul>
<li class="fragment"><p>PASO 1. Sea <span class="math inline">\(P1, P2, \ldots, Pn\)</span> cualquier permutación de <span class="math inline">\(1, 2, \ldots, n\)</span> (por ejemplo, podemos elegir <span class="math inline">\(P_j = j, j = 1,\ldots, n\)</span>).</p></li>
<li class="fragment"><p>PASO 2. Establecer <span class="math inline">\(k = n\)</span>.</p></li>
<li class="fragment"><p>PASO 3. Generar un número aleatorio <span class="math inline">\(U\)</span> y dejar <span class="math inline">\(I = \text{Int}(kU) + 1\)</span>.</p></li>
<li class="fragment"><p>PASO 4. Intercambiar los valores de <span class="math inline">\(P_I\)</span> y <span class="math inline">\(P_k\)</span>.</p></li>
<li class="fragment"><p>PASO 5. Dejar <span class="math inline">\(k = k - 1\)</span> y si <span class="math inline">\(k &gt; 1\)</span>, volver al Paso 3.</p></li>
<li class="fragment"><p>PASO 6. <span class="math inline">\(P1,...,Pn\)</span> es la permutación aleatoria deseada.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Por ejemplo, supongamos <span class="math inline">\(n = 4\)</span> y la permutación inicial es <span class="math inline">\(1, 2, 3, 4\)</span>. Si el primer valor de <span class="math inline">\(I\)</span> (que tiene la misma probabilidad de ser <span class="math inline">\(1, 2, 3\)</span> o <span class="math inline">\(4\)</span>) es <span class="math inline">\(I = 3\)</span>, entonces los elementos en las posiciones <span class="math inline">\(3\)</span> y <span class="math inline">\(4\)</span> se intercambian y así la nueva permutación es <span class="math inline">\(1, 2, 4, 3\)</span>. Si el siguiente valor de <span class="math inline">\(I\)</span> es <span class="math inline">\(I = 2\)</span>, entonces los elementos en las posiciones <span class="math inline">\(2\)</span> y <span class="math inline">\(3\)</span> se intercambian y así la nueva permutación es <span class="math inline">\(1, 4, 2, 3\)</span>. Si el valor final de <span class="math inline">\(I\)</span> es <span class="math inline">\(I = 2\)</span>, entonces la permutación final es <span class="math inline">\(1, 4, 2, 3\)</span>, y este es el valor de la permutación aleatoria.</p></li>
<li class="fragment"><p>Otra manera de generar una permutación aleatoria es generar números aleatorios <span class="math inline">\(U_1, ..., U_n\)</span>, ordenarlos y luego usar los índices de los valores sucesivos como la permutación aleatoria. Por ejemplo, si <span class="math inline">\(n = 4\)</span> y <span class="math inline">\(U_1 = 0.4, U_2 = 0.1, U_3 = 0.8, U_4 = 0.7\)</span>, entonces, debido a que <span class="math inline">\(U_2 &lt; U_1 &lt; U_4 &lt; U_3\)</span>, la permutación aleatoria es 2, 1, 4, 3. La dificultad con este enfoque, sin embargo, es que ordenar los números aleatorios típicamente requiere del orden de <span class="math inline">\(n \log(n)\)</span> comparaciones.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Práctica:</span></p>
<p>Implementar un generador de permutaciones aleatorias, utilizando lo planteado anteriormente en R</p>
</div>
</section></section><section><section id="método-de-aceptación-y-rechazo" class="title-slide slide level1 center" data-background-color="#00A499" data-number="3"><h1>
<span class="header-section-number">3</span> Método de aceptación y rechazo</h1>

</section><section id="la-idea-intuitiva-1" class="slide level2" data-number="3.1"><h2>
<span class="header-section-number">3.1</span> La idea intuitiva</h2>
<p>Supongamos que la función de densidad de probabilidad (pdf) <span class="math inline">\(f\)</span>, está acotada por u intervalo finito <span class="math inline">\(\left[a, b\right]\)</span>, y tiene valor cero fuera de dicho intervalo.</p>
<p>Sea</p>
<p><span class="math display">\[ c= sup\{ f(x): x \in \left[ a,b \right] \}.\]</span></p>

<img data-src="images/rejection_1.png" class="r-stretch quarto-figure-center"><p class="caption">Método de aceptación y rechazo</p></section><section class="slide level2"><div class="definition">
<p>En este caso, el generar una variable aleatoria <span class="math inline">\(Z\sim f\)</span> es muy sencillo, y puede ser implementado al seguir los <span class="green">siguientes pasos de aceptación-rechazo</span>:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(X \sim U(a,b)\)</span>.</p></li>
<li class="fragment"><p>Generar <span class="math inline">\(Y \sim U(0,c)\)</span> independiente de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Y \leq f(X)\)</span>, hacer <span class="math inline">\(Z=X\)</span>. En cualquier otro caso, volver al <em>Paso 1</em>.</p></li>
</ol>
</div>
</div>
<p></p>
<p>Es importante notar que cada vector <span class="math inline">\((X,Y)\)</span> es distribuído de manera uniforme sobre el rectángulo <span class="math inline">\([a, b] \times [0, c]\)</span>. Por lo tanto, el par aceptado <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido bajo la curva de <span class="math inline">\(f\)</span>. Esto implica que la distribución de los valores aceptados de <span class="math inline">\(X\)</span> tiene la densidad de probabilidad deseada <span class="math inline">\(f\)</span>.</p>
</section><section class="slide level2"><p>Podemos generalizar lo anterior de la siguiente manera:</p>
<p>Sea <span class="math inline">\(g\)</span> una densidad arbitraria tal que <span class="math inline">\(\phi(x) = C g(x)\)</span> <a href="https://es.wikipedia.org/wiki/Mayorizaci%C3%B3n"><em>mayoriza</em></a> <span class="math inline">\(f(x)\)</span> para alguna constante <span class="math inline">\(C\)</span>; es decir, que <span class="math inline">\(\phi(x) \geq f(x)\)</span> para todo <span class="math inline">\(x\)</span>. Notar que de necesidad <span class="math inline">\(C \geq 1\)</span>. Llamamos <span class="math inline">\(g(x)\)</span> la <em>pdf de propuesta</em> y asumimos que es fácil generar variables aleatorias de ella.</p>

<img data-src="images/rejection_2.png" class="r-stretch quarto-figure-center"><p class="caption">Método de aceptación y rechazo con una función de mayorización <span class="math inline">\(\phi\)</span></p></section><section class="slide level2"><div class="definition">
<p>Entonces el algoritmo de aceptación-rechazo puede ser escrito de la siguiente manera: </p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(X\)</span> desde <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>Generar <span class="math inline">\(Y \sim U(0,C\; g(X))\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Y \leq f(X)\)</span>, hacer <span class="math inline">\(Z_X\)</span>. En cualquier otro caso, volver al <em>Paso 1</em>.</p></li>
</ol>
</div>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="blue">Teorema:</span></p>
<p>La variable aleatoria generada de acuerdo con el Algoritmo anterior tiene la <em>pdf</em> deseada <span class="math inline">\(f(x)\)</span>.</p>
</div>
<p><strong>Prueba:</strong><br>
Definimos los siguientes dos subconjuntos:</p>
<p><span class="math display">\[
\mathcal{A} = \{ (x, y) : 0 \leq y \leq Cg(x) \} \quad \text{y} \quad \mathcal{B} = \{ (x, y) : 0 \leq y \leq f(x) \},
\]</span></p>
<p>los cuales representan las áreas debajo de las curvas <span class="math inline">\(C\; g(x)\)</span> y <span class="math inline">\(f(x)\)</span>, respectivamente. Note primero que los pasos 1 y 2 del Algoritmo implican que el vector aleatorio <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{A}\)</span>. Para ver esto, sea <span class="math inline">\(q(x, y)\)</span> la <em>pdf</em> conjunta de <span class="math inline">\((X, Y)\)</span>, y sea <span class="math inline">\(g(y | x)\)</span> denotando la <em>pdf</em> condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(X = x\)</span>. Entonces tenemos</p>
<p><span class="math display">\[
q(x, y) =
\begin{cases}
g(x) q(y | x) &amp; \text{si } (x,y) \in \mathcal{A} \\
0 &amp; \text{de otra forma}.
\end{cases}
\]</span></p>
</section><section class="slide level2"><div class="small">
<ul>
<li class="fragment"><p>Ahora, el Paso 2 afirma que <span class="math inline">\(q(y | x)\)</span> es igual a <span class="math inline">\(1 / (Cg(x))\)</span> para <span class="math inline">\(y \in [0, Cg(x)]\)</span> y es cero de otra forma. Por lo tanto, <span class="math inline">\(q(x, y) = C^{-1}\)</span> para cada <span class="math inline">\((x, y) \in \mathcal{A}\)</span>.</p></li>
<li class="fragment"><p>Sea <span class="math inline">\((X^*, Y^*)\)</span> el primer punto aceptado, es decir, el primero que está en <span class="math inline">\(\mathcal{B}\)</span>. Dado que el vector <span class="math inline">\((X, Y)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{A}\)</span>, entonces el vector <span class="math inline">\((X^*, Y^*)\)</span> está uniformemente distribuido en <span class="math inline">\(\mathcal{B}\)</span>. Además, dado que el área de <span class="math inline">\(\mathcal{B}\)</span> equivale a la unidad, la <em>pdf</em> conjunta de <span class="math inline">\((X^*, Y^*)\)</span> en <span class="math inline">\(\mathcal{B}\)</span> equivale a la unidad también. Así, la <em>pdf</em> marginal de <span class="math inline">\(Z = X^*\)</span> es</p></li>
</ul>
<p><span class="math display">\[ \int_0^{f(x)} 1 dy = f(x). \]</span></p>
<ul>
<li class="fragment">La eficiencia del Algoritmo se define como</li>
</ul>
<p><span class="math display">\[ P((X, Y) \text{ es aceptado}) = \frac{\text{área } \mathcal{B}}{\text{área } \mathcal{A}} = \frac{1}{C}. \]</span></p>
</div>
</section><section class="slide level2"><div class="alert">
<p><span class="green">En otras palabras:</span> </p>
<ul>
<li class="fragment"><p>Supongamos que se tiene un método para generar una variable aleatoria que tiene una función de densidad <span class="math inline">\(g(X)\)</span>.</p></li>
<li class="fragment"><p>Podemos usar esto como base para generar desde la distribución continua que tiene una función de densidad <span class="math inline">\(f(x)\)</span> generando <span class="math inline">\(Y\)</span> desde <span class="math inline">\(g\)</span> y luego aceptando este valor generado con una probabilidad proporcional a <span class="math inline">\(\frac{f(Y)}{g(Y)}\)</span>.</p></li>
<li class="fragment"><p>Sea <span class="math inline">\(c\)</span> una constante tal que <span class="math inline">\(\frac{f(y)}{g(y)} &lt; c\)</span> para todo <span class="math inline">\(y\)</span>. Luego tenemos la siguiente técnica para generar una variable aleatoria que tenga densidad <span class="math inline">\(f\)</span>.</p></li>
</ul>
<p><img data-src="images/esquema_aceptacion_rechazo.png"></p>
</div>
</section><section class="slide level2"><div class="definition">
<div class="small">
<ol type="1">
<li class="fragment"><p>Encontrar una variable aleatoria <span class="math inline">\(Y\)</span> con densidad <span class="math inline">\(g\)</span> que satisface <span class="math inline">\(\frac{f(t)}{g(t)} \leq c\)</span>, para todo <span class="math inline">\(t\)</span> tal que <span class="math inline">\(f(t) &gt;0\)</span>. Proveer de un método para generar de manera aleatoria <span class="math inline">\(Y\)</span>.</p></li>
<li class="fragment"><p>Para cada m.a. requerida:</p></li>
</ol>
<ul>
<li class="fragment"><p>PASO 1: Genera <span class="math inline">\(y\)</span> teniendo densidad <span class="math inline">\(g\)</span>.</p></li>
<li class="fragment"><p>PASO 2: Genera un número aleatorio <span class="math inline">\(u \sim U(0,1)\)</span>.</p></li>
<li class="fragment"><p>PASO 3: Si <span class="math inline">\(u &lt; \frac{f(y)}{cg(y)}\)</span>, establece <span class="math inline">\(x = y\)</span>. De lo contrario, rechazar <span class="math inline">\(y\)</span> y regresar al PASO 1.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>Notar que en el Paso 2, <span class="math display">\[ P(\text{aceptar}|Y) = P\left(U &lt; \frac{f(Y)}{cg(Y)} \Big| Y\right) = \frac{f(Y)}{cg(Y)}. \]</span></p>
<p>La última igualdad es simplemente la evaluación de la cdf de <span class="math inline">\(U\)</span>. Por lo tanto, la probabilidad total de aceptación en cualquier iteración es <span class="math display">\[ \sum_{y} P(\text{aceptar}|y)P(Y = y) = \sum_{y} \frac{f(y)}{cg(y)}g(y) = \frac{1}{c}, \]</span></p>
<p>y el número de iteraciones hasta la aceptación tiene la distribución geométrica con media <span class="math inline">\(c\)</span>. Por lo tanto, en promedio cada valor de muestra de <span class="math inline">\(X\)</span> requiere <span class="math inline">\(c\)</span> iteraciones. Para eficiencia, <span class="math inline">\(Y\)</span> debería ser fácil de simular y <span class="math inline">\(c\)</span> pequeño.</p>
</section><section class="slide level2"><p>Para ver que la muestra aceptada tiene la misma distribución que <span class="math inline">\(X\)</span>, aplicamos el Teorema de Bayes. En el caso discreto, para cada <span class="math inline">\(k\)</span> tal que <span class="math inline">\(f(k) &gt; 0\)</span>, <span class="math display">\[ P(k | \text{aceptado}) = \frac{P(\text{aceptado} | k)g(k)}{P(\text{aceptado})} = \frac{[f(k)]/([cg(k)])}{1/c} g(k) = f(k). \]</span></p>
<p>El caso continuo es similar.</p>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Notar que el método de rechazo es exactamente el mismo que en el caso de variables aleatorias discretas, con la única diferencia de que las densidades reemplazan a las funciones de masa.</p></li>
<li class="fragment"><p>De la misma manera que lo hicimos en el caso discreto podemos probar el siguiente resultado.</p></li>
</ul>
<div class="definition">
<div class="small">
<p><span class="blue">Teorema:</span> <br></p>
<ol type="1">
<li class="fragment"><p>La variable aleatoria generada por el método de rechazo tiene densidad <span class="math inline">\(f\)</span>.</p></li>
<li class="fragment"><p>El número de iteraciones del algoritmo que se necesitan es una variable aleatoria geométrica con media <span class="math inline">\(c\)</span>.</p></li>
</ol>
</div>
</div>
<p>Como en el caso discreto, se debe notar que la forma en que uno acepta el valor <span class="math inline">\(Y\)</span> con probabilidad <span class="math inline">\(\frac{f(Y)}{cg(Y)}\)</span> es generando un número aleatorio <span class="math inline">\(U\)</span> y luego aceptando si <span class="math inline">\(U \leq \frac{f(Y)}{cg(Y)}\)</span>.</p>
</section><section class="slide level2"><h3 id="ejemplo-1">Ejemplo</h3>
<p>Vamos a demostrar cómo generar una variable aleatoria <span class="math inline">\(Z\)</span> a partir de la <em>pdf</em></p>
<p><span class="math display">\[
f(x) = \begin{cases}
2x, &amp; 0 \leq x \leq 1 \\
0, &amp; \text{de lo contrario}
\end{cases}
\]</span></p>
<p>utilizando el método de aceptación-rechazo. Por simplicidad, tomemos <span class="math inline">\(g(x) = 1, 0 \leq x \leq 1\)</span>, y <span class="math inline">\(C = 2\)</span>. Es decir, nuestra distribución propuesta es simplemente la distribución uniforme en <span class="math inline">\([0, 1]\)</span>. En este caso, <span class="math inline">\(\frac{f(x)}{Cg(x)} = x\)</span> y el Algoritmo se escribe de la siguiente manera:</p>
<ol type="1">
<li class="fragment"><p>Genera <span class="math inline">\(X\)</span> de <span class="math inline">\(U(0,1)\)</span>.</p></li>
<li class="fragment"><p>Genera <span class="math inline">\(U\)</span> de <span class="math inline">\(U(0,1)\)</span> independientemente de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U \leq X\)</span>, retorna <span class="math inline">\(Z = X\)</span>. De lo contrario, vuelve al Paso 1.</p></li>
</ol>
<p>Notar que este ejemplo es meramente ilustrativo, ya que el método de transformación inversa lo maneja eficientemente.</p>
</section><section class="slide level2"><p>La eficiencia del método de aceptación-rechazo modificado se determina nuevamente por la probabilidad de aceptación <span class="math inline">\(p = P(U \leq \frac{f(X)}{(Cg(X))}) = P(Y \leq f(X)) = \frac{1}{C}\)</span> para cada intento <span class="math inline">\((X, U)\)</span>. Dado que los intentos son independientes, el número de intentos, <span class="math inline">\(N\)</span>, antes de que ocurra un par exitoso <span class="math inline">\((Z, U)\)</span> tiene la siguiente distribución geométrica:</p>
<p><span class="math display">\[
P(N = n) = p(1 - p)^{n-1}, \quad n = 1, 2, \ldots,
\]</span></p>
<p>con el número esperado de intentos igual a <span class="math inline">\(\frac{1}{p} = C\)</span>.</p>
<p>Para que este método sea de interés práctico, se deben usar los siguientes criterios al seleccionar la densidad de propuesta <span class="math inline">\(g(x)\)</span>:</p>
<ol type="1">
<li class="fragment"><p>Debe ser fácil generar una variable aleatoria de <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>La eficiencia, <span class="math inline">\(\frac{1}{C}\)</span>, del procedimiento debe ser grande, es decir, <span class="math inline">\(C\)</span> debería estar cerca de 1 (lo que ocurre cuando <span class="math inline">\(g(x)\)</span> está cerca de <span class="math inline">\(f(x)\)</span>).</p></li>
</ol></section><section class="slide level2"><h3 id="ejemplo-densidad-semicircular">Ejemplo: densidad semicircular</h3>
<div class="example">
<p><span class="green">Generar una variable aleatoria <span class="math inline">\(Z\)</span> de la densidad semicircular</span></p>
<p><span class="math display">\[
f(x) = \frac{2}{\pi R^2}\sqrt{R^2 - x^2}, \quad -R \leq x \leq R.
\]</span></p>
</div>
<p>Tomar la distribución propuesta para ser uniforme sobre <span class="math inline">\([-R, R]\)</span>, esto es, toma <span class="math inline">\(g(x) = \frac{1}{2R}\)</span>, <span class="math inline">\(-R \leq x \leq R\)</span> y elige <span class="math inline">\(C\)</span> tan pequeño como sea posible tal que <span class="math inline">\(Cg(x) \geq f(x)\)</span>; por ende, <span class="math inline">\(C = \frac{4}{\pi}\)</span>. Entonces podemos escribir el el siguiente algoritmo de generación:</p>
<ol type="1">
<li class="fragment"><p>Generar dos variables aleatorias independientes, <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span>, de <span class="math inline">\(U(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Usar <span class="math inline">\(U_2\)</span> para generar <span class="math inline">\(X\)</span> de <span class="math inline">\(g(x)\)</span> vía el método de transformación inversa, es decir, <span class="math inline">\(X = (2U_2 - 1)R\)</span>, y calcular <span class="math inline">\(\frac{f(X)}{Cg(X)} = \sqrt{1 - (2U_2 - 1)^2}\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U_1 \leq \frac{f(X)}{Cg(X)}\)</span>, lo cual es equivalente a <span class="math inline">\((2U_2 - 1)^2 \leq 1 - U_1^2\)</span>, hacer <span class="math inline">\(Z = X = (2U_2 - 1)R\)</span>; de otra manera, regresar al Paso 1.</p></li>
</ol>
<p><span class="green">El número esperado de intentos para este algoritmo es <span class="math inline">\(C = \frac{4}{\pi}\)</span>, y la eficiencia es <span class="math inline">\(\frac{1}{C} = \frac{\pi}{4} \approx 0.785\)</span>.</span></p>
</section><section class="slide level2"><h3 id="ejemplo-distribución-beta">Ejemplo: Distribución <em>Beta</em>
</h3>
<div class="example">
<p>¿Cuántos números pseudo aleatorios debenser simulados en promedio para generar 1000 muestras desde la distribución <span class="math inline">\(Beta(\alpha=2, \beta=2)\)</span>, empleando este método? <br></p>
<ul>
<li class="fragment"><p>Dependerá del límite superior <span class="math inline">\(c\)</span> de <span class="math inline">\(\frac{f(x)}{g(x)}\)</span>, que depende de la elección de la función <span class="math inline">\(g(x)\)</span>.</p></li>
<li class="fragment"><p>La densidad <span class="math inline">\(Beta(2,2)\)</span> es <span class="math inline">\(f(x)=6x(1-x), 0&lt;x&lt;1\)</span>. Sea <span class="math inline">\(g(x)\)</span> la densidad <span class="math inline">\(Uniforme(0,1)\)</span>. Entonces <span class="math inline">\(\frac{f(x)}{g(x)} \leq 6\)</span> para todo <span class="math inline">\(0&lt;x&lt;1\)</span>, así <span class="math inline">\(c=6\)</span>.</p></li>
<li class="fragment"><p>Una muestra aleatoria <span class="math inline">\(x\)</span> desde <span class="math inline">\(g(x)\)</span> es aceptada si <span class="math display">\[\frac{f(x)}{c \, g(x)} = \frac{6x(1-x)}{6(1)} = x(1-x)&gt;u\]</span></p></li>
</ul>
</div>
</section><section class="slide level2"><p>En promedio, <span class="math inline">\(c \, n = 6000\)</span> iteraciones (12000 números aleatorios) serán requeridos para un tamaño de muestra igual a 1000. Podemos comprobarlo en la siguiente simulación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-2"><a href=""></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-3"><a href=""></a><span class="co">#Contador para aceptación</span></span>
<span id="cb25-4"><a href=""></a>contador <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-5"><a href=""></a><span class="co">#iteraciones</span></span>
<span id="cb25-6"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb25-7"><a href=""></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb25-8"><a href=""></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-9"><a href=""></a>  contador <span class="ot">&lt;-</span> contador <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-10"><a href=""></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-11"><a href=""></a>  <span class="co">#muestra aleatoria desde g</span></span>
<span id="cb25-12"><a href=""></a>  <span class="cf">if</span> (x <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb25-13"><a href=""></a>    <span class="co">#aceptamos x</span></span>
<span id="cb25-14"><a href=""></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-15"><a href=""></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb25-16"><a href=""></a>  }</span>
<span id="cb25-17"><a href=""></a>}</span>
<span id="cb25-18"><a href=""></a><span class="fu">print</span>(contador)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5852</code></pre>
</div>
</div>
</section><section class="slide level2"><p>En esta simulación, 5852 iteraciones fueron requeridas para generar 1000 muestras <em>Beta</em>. Comparamos los percentiles teóricos y empíricos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-2"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb27-3"><a href=""></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb27-4"><a href=""></a><span class="co">#Comparación de percentiles teóricos y empíricos</span></span>
<span id="cb27-5"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>)</span>
<span id="cb27-6"><a href=""></a>Qhat <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, p)</span>
<span id="cb27-7"><a href=""></a><span class="co">#Cuantiles de la muestra</span></span>
<span id="cb27-8"><a href=""></a>Q <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(p, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb27-9"><a href=""></a><span class="co">#Cuantiles teóricos</span></span>
<span id="cb27-10"><a href=""></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">/</span> (n <span class="sc">*</span> <span class="fu">dbeta</span>(Q, <span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb27-11"><a href=""></a></span>
<span id="cb27-12"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(Qhat, Q, se), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href=""></a>  <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">'X'</span>)), <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">seq_along</span>(.), <span class="st">'0%'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-15"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 25px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">10%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">20%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">30%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">40%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">50%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">60%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">70%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">80%</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">90%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Qhat</td>
<td style="text-align: center;">0.194</td>
<td style="text-align: center;">0.281</td>
<td style="text-align: center;">0.366</td>
<td style="text-align: center;">0.435</td>
<td style="text-align: center;">0.499</td>
<td style="text-align: center;">0.564</td>
<td style="text-align: center;">0.638</td>
<td style="text-align: center;">0.711</td>
<td style="text-align: center;">0.807</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q</td>
<td style="text-align: center;">0.196</td>
<td style="text-align: center;">0.287</td>
<td style="text-align: center;">0.363</td>
<td style="text-align: center;">0.433</td>
<td style="text-align: center;">0.500</td>
<td style="text-align: center;">0.567</td>
<td style="text-align: center;">0.637</td>
<td style="text-align: center;">0.713</td>
<td style="text-align: center;">0.804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">se</td>
<td style="text-align: center;">0.010</td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.013</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.010</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section class="slide level2"><h3 id="ejercicios-1">Ejercicios</h3>
<div class="example">
<p>Caso discreto: </p>
<div class="small">
<p>Queremos simular valores de una v.a <span class="math inline">\(X\)</span> tal que: <span class="math inline">\(\mathbb{P}(X=j) = p_j\)</span>, <span class="math inline">\(j =1,\ldots,6\)</span>, <span class="math inline">\(p_1=0.15\)</span>, <span class="math inline">\(p_2=0.16\)</span>, <span class="math inline">\(p_3=0.18\)</span>, <span class="math inline">\(p_4=0.19\)</span>, <span class="math inline">\(p_5=0.18\)</span>, <span class="math inline">\(p_6=0.14\)</span>, con <span class="math inline">\(q_j = \frac{1}{6}\)</span>, <span class="math inline">\(j =1,\ldots,6\)</span>, ie, <span class="math inline">\(Y \sim UD(1,\ldots,6)\)</span>}</p>
<ul>
<li class="fragment"><p>Elegimos <span class="math inline">\(c=\max \frac{p_j}{q_j} = 1.14 (j=4)\)</span>.</p></li>
<li class="fragment">
<p>Pasos:</p>
<ol type="1">
<li class="fragment"><p>Generar <span class="math inline">\(u_1 \sim U(0,1)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(y=[6 u_1]+1\)</span>.</p></li>
<li class="fragment"><p>Generar <span class="math inline">\(u_2 \sim U(0,1)\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(u_2 \leq \frac{p_y}{1.14 \frac{1}{6}} \Rightarrow x=y\)</span> y parar, eoc, volver al Paso 1.</p></li>
</ol>
</li>
</ul>
<p>Implementar el ejemplo anterior en un ciclo de r = 1000 repeticiones y calcular la tasa de aceptación empírica.</p>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p>Caso contínuo: </p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar valores de una v.a. Gamma<span class="math inline">\((\frac{3}{2},1)\)</span> a partir de <span class="math inline">\(g(x)=\frac{2}{3} e^{-2\frac{x}{3}}\)</span>, <span class="math inline">\(x&gt;0\)</span></p></li>
<li class="fragment"><p>Utilizar el método de aceptación/rechazo para generar una v. a. con función de densidad <span class="math inline">\(f(x) = 20 x(1-x)^3, \qquad 0 &lt; x &lt; 1\)</span>.</p></li>
<li class="fragment"><p>Generar valores de una v.a. Normal<span class="math inline">\((0,1)\)</span> a partir de la densidad Cauchy <span class="math inline">\(g(x)=\frac{1}{\pi} \left(\frac{1}{1+y^2}\right)\)</span>, <span class="math inline">\(x \in \mathbb{R}\)</span>.</p></li>
</ol>
</div>
</div>
</section></section><section><section id="métodos-de-transformación" class="title-slide slide level1 center" data-background-color="#00A499" data-number="4"><h1>
<span class="header-section-number">4</span> Métodos de transformación</h1>

</section><section class="slide level2"><p>Muchos tipos de transformaciones además del método de transformación inversa de probabilidad pueden aplicarse para simular variables aleatorias. Algunos ejemplos son:</p>
<ol type="1">
<li class="fragment"><p>Si <span class="math inline">\(Z \sim N(0,1)\)</span>, entonces <span class="math inline">\(V = Z^2 \sim \chi^2(1)\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(U \sim \chi^2(m)\)</span> y <span class="math inline">\(V \sim \chi^2(n)\)</span> son independientes, entonces <span class="math inline">\(F = \frac{U/m}{V/n}\)</span> tiene la distribución F con <span class="math inline">\((m, n)\)</span> grados de libertad.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(Z \sim N(0,1)\)</span> y <span class="math inline">\(V \sim \chi^2(n)\)</span> son independientes, entonces <span class="math inline">\(T = \frac{Z}{\sqrt{V/n}}\)</span> tiene la distribución t de Student con <span class="math inline">\(n\)</span> grados de libertad.</p></li>
<li class="fragment"><p>Método Box-Müller: Si <span class="math inline">\(U, V \sim \text{Unif}(0,1)\)</span> son independientes, entonces</p></li>
</ol>
<p><span class="math display">\[\begin{eqnarray}
  Z_1 =&amp; \sqrt{-2 \log U} \cos(2\pi V), \\
  Z_2 =&amp; \sqrt{-2 \log V} \sin(2\pi U)
\end{eqnarray}\]</span></p>
<p>son variables normales estándar independientes.</p>
</section><section class="slide level2"><ol start="5" type="1">
<li class="fragment"><p>Si <span class="math inline">\(U \sim \text{Gamma}(r, \lambda)\)</span> y <span class="math inline">\(V \sim \text{Gamma}(s, \lambda)\)</span> son independientes, entonces <span class="math inline">\(X = \frac{U}{U+V}\)</span> tiene la distribución Beta<span class="math inline">\((r, s)\)</span>.</p></li>
<li class="fragment">
<p>Si <span class="math inline">\(U, V \sim \text{Unif}(0,1)\)</span> son independientes, entonces</p>
<p><span class="math display">\[
X = \left\lfloor 1 + \frac{\log(V)}{\log(1 - (1 - \theta)U)} \right\rfloor
\]</span></p>
<p>tiene la distribución Logarítmica<span class="math inline">\((\theta)\)</span>, donde <span class="math inline">\(\left\lfloor x \right\rfloor\)</span> denota la parte entera de <span class="math inline">\(x\)</span>.</p>
</li>
</ol></section><section class="slide level2"><p>Recuerdan esta figura?</p>

<img data-src="images/distribution_relationship_map.png" class="r-stretch quarto-figure-center"><p class="caption">Ejemplo de algunas relaciones entre distribuciones univariadas</p><div class="alert">
<p><span class="orange">Enlaces con información más detallada:</span></p>
<ul>
<li class="fragment"><p><a href="https://www.johndcook.com/blog/distribution_chart/">Diagrama de relaciones entre distribuciones</a></p></li>
<li class="fragment"><p><a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">Un diagrama un poco más detallado</a></p></li>
</ul>
</div>
</section><section class="slide level2"><h3 id="ejemplo-distribución-beta-nuevamente">Ejemplo: Distribución <em>Beta</em> (nuevamente)</h3>
<div class="example">
<p>La siguiente relación entre la <span class="green">distribución Beta y Gamma</span> nos permite implementar otro RNG para la <span class="orange">distribución Beta</span>:</p>
<blockquote>
<p>Si <span class="math inline">\(U \sim \text{Gamma}(r, \lambda)\)</span> y <span class="math inline">\(V \sim \text{Gamma}(s, \lambda)\)</span> son independientes, entonces <span class="math inline">\(X = \frac{U}{U+V}\)</span> tiene la distribución Beta<span class="math inline">\((r, s)\)</span>.</p>
</blockquote>
</div>
<p>Por lo tanto, podemos implementar un algoritmo para generar muestras aleatorias <span class="math inline">\(Beta(r,s)\)</span></p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Gamma(a,1)\)</span>.</p></li>
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(v\)</span> desde una distribución <span class="math inline">\(Gamma(b,1)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(\frac{u}{u+v}\)</span>.</p></li>
</ol>
</div>
</section><section class="slide level2"><p>Para generar una muestra aleatoria proveniente de una <span class="green">distribución <span class="math inline">\(Beta(3,2)\)</span></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-2"><a href=""></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb28-3"><a href=""></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb28-4"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>a, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb28-5"><a href=""></a>v <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>b, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb28-6"><a href=""></a>x <span class="ot">&lt;-</span> u <span class="sc">/</span> (u <span class="sc">+</span> v)</span>
<span id="cb28-7"><a href=""></a><span class="fu">print</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.1785884 0.5445075 0.6947001 0.8656039 0.7633113 0.3117103 0.5346568
  [8] 0.8551243 0.4379071 0.8046751 0.2538818 0.5789318 0.5006593 0.8055877
 [15] 0.4205466 0.6996796 0.6928022 0.7532208 0.3630649 0.7803501 0.3820578
 [22] 0.4037790 0.9615570 0.8167136 0.7110212 0.3081472 0.7873189 0.7395515
 [29] 0.6611742 0.7910903 0.3210334 0.3106950 0.7575779 0.5996522 0.2604717
 [36] 0.6301943 0.9678052 0.3886486 0.6888294 0.6467294 0.3686549 0.6521048
 [43] 0.4933808 0.7119907 0.8980924 0.6543846 0.2475923 0.7744678 0.2019214
 [50] 0.7368245 0.5550486 0.5219131 0.6740776 0.3740246 0.2638140 0.9644488
 [57] 0.3797149 0.4749358 0.5314753 0.7847241 0.9458239 0.7461899 0.4594762
 [64] 0.4362033 0.4881184 0.3436201 0.7081080 0.4732468 0.5033110 0.4796188
 [71] 0.7606784 0.5098181 0.6434120 0.5395007 0.9609418 0.3968011 0.7118716
 [78] 0.2325506 0.3684421 0.5762307 0.4399937 0.7502540 0.6135231 0.3064664
 [85] 0.6814964 0.7573213 0.8521979 0.5285770 0.7986032 0.3255244 0.6870631
 [92] 0.5110796 0.3010627 0.7351797 0.5629944 0.6352725 0.7874648 0.3909429
 [99] 0.7879142 0.7321640</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Podemos comparar la muestra obtenida con la distribución <span class="math inline">\(Beta(3,2)\)</span>, utilizando un gráfico de cuantíl-cuantíl (<span class="green">Quantile-Quantile plot, QQ plot</span>). Si las distribuciones son similares, el gráfico debería parecerse:</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1">Usando R-Base</a></li>
<li><a href="#tabset-2-2">Usando GGplot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>q <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fu">ppoints</span>(n), a, b)</span>
<span id="cb30-2"><a href=""></a><span class="fu">qqplot</span>(q, x, <span class="at">cex=</span><span class="fl">0.25</span>, <span class="at">xlab=</span><span class="st">"Beta(3, 2)"</span>, <span class="at">ylab=</span><span class="st">"Sample"</span>)</span>
<span id="cb30-3"><a href=""></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb31-3"><a href=""></a><span class="fu">data.frame</span>(x, q) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href=""></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample=</span>x), </span>
<span id="cb31-6"><a href=""></a>          <span class="at">distribution =</span> stats<span class="sc">::</span>qbeta, </span>
<span id="cb31-7"><a href=""></a>          <span class="at">dparams =</span> <span class="fu">c</span>(a,b), </span>
<span id="cb31-8"><a href=""></a>          <span class="at">color=</span><span class="st">"green4"</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href=""></a>  <span class="fu">stat_qq_line</span>(<span class="fu">aes</span>(<span class="at">sample=</span>x),</span>
<span id="cb31-10"><a href=""></a>               <span class="at">distribution =</span> stats<span class="sc">::</span>qbeta, </span>
<span id="cb31-11"><a href=""></a>               <span class="at">dparams =</span> <span class="fu">c</span>(a,b),</span>
<span id="cb31-12"><a href=""></a>               <span class="at">color=</span><span class="st">"orange1"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb31-13"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Muestra generada"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Beta(3,2)"</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-25-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>La línea <span class="math inline">\(x=q\)</span> se añade para referencia. El <span class="orange">QQplot de la muestra generada vs la <span class="math inline">\(Beta(3,2)\)</span> es muy similar a una línea recta</span>, como debería ser si es que efectivamente la distribución de la muestra generada a través del RNG es <span class="math inline">\(Beta\)</span>.</p>
</section><section class="slide level2"><h3 id="ejemplo-distribución-logarítmica">Ejemplo: Distribución <em>Logarítmica</em>
</h3>
<div class="example">
<p>Implementaremos un RNG para muestras a partir de una <span class="green">distribución Logarítmica</span>.</p>
<blockquote>
<p>Si <span class="math inline">\(U,V\)</span> son v.a. i.i.d. Uniforme<span class="math inline">\((0,1)\)</span>, entonces <span class="math display">\[ X = \left\lfloor 1+ \frac{log(V)}{log(1-1(1-\theta)^U)} \right\rfloor\]</span> Se distribuye <span class="math inline">\(Log(\theta)\)</span>.</p>
</blockquote>
</div>
<p>Por lo tanto, podemos implementar un algoritmo para generar muestras aleatorias <span class="math inline">\(Log(\theta)\)</span>:</p>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(u\)</span> desde una distribución <span class="math inline">\(Unif(0,1)\)</span>.</p></li>
<li class="fragment"><p>Generar una muestra aleatoria <span class="math inline">\(v\)</span> desde una distribución <span class="math inline">\(Unif(0,1)\)</span>.</p></li>
<li class="fragment"><p>Calcular <span class="math inline">\(x = \left\lfloor 1+ \frac{log(v)}{log(1-1(1-\theta)^u)} \right\rfloor\)</span>.</p></li>
</ol>
</div>
</section><section class="slide level2"><p>Comparamos la distribución <span class="math inline">\(Log(\frac{1}{2})\)</span> con una muestra generada a través de nuestro RNG, utilizando la transformación planteada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb32-2"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb32-3"><a href=""></a><span class="co"># Muestras Uniformes</span></span>
<span id="cb32-4"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb32-5"><a href=""></a>v <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb32-6"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(v) <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>u)) <span class="co"># Transformación a Log</span></span>
<span id="cb32-7"><a href=""></a>k <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(x)</span>
<span id="cb32-8"><a href=""></a>p <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> theta) <span class="sc">*</span> theta<span class="sc">^</span>k <span class="sc">/</span> k <span class="co">#calcula probabilidades</span></span>
<span id="cb32-9"><a href=""></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb32-10"><a href=""></a>p.hat <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(x)<span class="sc">/</span>n</span>
<span id="cb32-11"><a href=""></a></span>
<span id="cb32-12"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb32-13"><a href=""></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb32-14"><a href=""></a><span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(p.hat, p, se), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-15"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="at">col.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb32-17"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 25px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">4</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">6</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">7</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p.hat</td>
<td style="text-align: center;">0.705</td>
<td style="text-align: center;">0.177</td>
<td style="text-align: center;">0.067</td>
<td style="text-align: center;">0.031</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.005</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">p</td>
<td style="text-align: center;">0.721</td>
<td style="text-align: center;">0.180</td>
<td style="text-align: center;">0.060</td>
<td style="text-align: center;">0.023</td>
<td style="text-align: center;">0.009</td>
<td style="text-align: center;">0.004</td>
<td style="text-align: center;">0.002</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">se</td>
<td style="text-align: center;">0.014</td>
<td style="text-align: center;">0.012</td>
<td style="text-align: center;">0.008</td>
<td style="text-align: center;">0.005</td>
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">0.002</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Se muestran las probabilidades empíricas <code>p.hat</code>, las probabilidades teóricas <code>p</code>, y el error estándar <code>se</code>.</p>
</section></section><section><section id="método-polar" class="title-slide slide level1 center" data-background-color="#00A499" data-number="5"><h1>
<span class="header-section-number">5</span> Método Polar</h1>

</section><section class="slide level2"><p>Sean <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> dos variables independientes con <span class="green">distribución Normal estándar</span> y sea <span class="math inline">\(R\)</span> y <span class="math inline">\(\Theta\)</span> las coordenadas polares del vector <span class="math inline">\((X,Y)\)</span>. Esto es:</p>
<p><span class="math display">\[ \begin{eqnarray}
R^2 = &amp; X^2 + Y^2 \\
tan(\Theta) = &amp; \frac{Y}{X}
\end{eqnarray}\]</span></p>

<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><p>Dado que <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son independientes, su densidad conjunta es el producto de sus densidades individuales, dada por</p>
<p><span id="eq-polar"><span class="math display">\[\begin{eqnarray}
f(x,y) = &amp; \frac{1}{\sqrt{2 \pi}} e^{-x^2/2} \frac{1}{\sqrt{2 \pi}} e^{-y^2/2} \\
       = &amp; \frac{1}{\sqrt{2 \pi}} e^{-(x^2 + y^2)/2}
\end{eqnarray} \qquad(1)\]</span></span></p>
<p>Para determinar la densidad conjunta de <span class="math inline">\(R^2\)</span> y <span class="math inline">\(\Theta\)</span>, denotada por <span class="math inline">\(f(d, \theta)\)</span>, hacemos el cambio de variables</p>
<p><span class="math display">\[
d = x^2 + y^2, \quad \theta = \tan^{-1}\left(\frac{y}{x}\right)
\]</span></p>
<p>Dado que el Jacobiano de esta transformación (es decir, el determinante de las derivadas parciales de <span class="math inline">\(d\)</span> y <span class="math inline">\(\theta\)</span> con respecto a <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>) es fácilmente demostrado como igual a 2, se deduce de la <a href="#/eq-polar" class="quarto-xref">Ecuación&nbsp;1</a> que la función de densidad conjunta de <span class="math inline">\(R^2\)</span> y <span class="math inline">\(\Theta\)</span> está dada por</p>
<p><span class="math display">\[
f(d, \theta) = \frac{1}{2} \cdot \frac{1}{2\pi} e^{-d/2}, \quad 0 &lt; d &lt; \infty, \quad 0 &lt; \theta &lt; 2\pi
\]</span></p>
</section><section class="slide level2"><p>Sin embargo, como lo anterior es igual al producto de una densidad exponencial con media 2 (es decir, <span class="math inline">\(\frac{1}{2} e^{-d/2}\)</span>) y la densidad uniforme en <span class="math inline">\((0, 2\pi)\)</span> (es decir, <span class="math inline">\((2\pi)^{-1}\)</span>), se deduce que</p>
<blockquote>
<p><span class="math inline">\(R^2\)</span> y <span class="math inline">\(\Theta\)</span> son independientes, con <span class="math inline">\(R^2\)</span> exponencial con media 2 y <span class="math inline">\(\Theta\)</span> uniformemente distribuida en <span class="math inline">\((0, 2\pi)\)</span></p>
</blockquote>
<p>Ahora podemos generar un par de variables aleatorias normales estándar independientes <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> usando lo anterior, para generar primero sus coordenadas polares y luego transformar de nuevo a coordenadas rectangulares. Esto se logra de la siguiente manera:</p>
<ul>
<li class="fragment"><p><strong>Paso 1:</strong> Generar números aleatorios <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span>.</p></li>
<li class="fragment"><p><strong>Paso 2:</strong> <span class="math inline">\(R^2 = -2\log U_1\)</span> (y así <span class="math inline">\(R^2\)</span> es exponencial con media 2). <span class="math inline">\(\Theta = 2\pi U_2\)</span> (y así <span class="math inline">\(\Theta\)</span> es uniforme entre 0 y <span class="math inline">\(2\pi\)</span>).</p></li>
<li class="fragment"><p><strong>Paso 3:</strong> Ahora, sea</p></li>
</ul>
<p><span id="eq-boxmuller"><span class="math display">\[\begin{eqnarray}
X = &amp; R \cos \Theta = \sqrt{-2 \log U_1} \cos(2\pi U_2) \\
Y = &amp; R \sin \Theta = \sqrt{-2 \log U_1} \sin(2\pi U_2)
\end{eqnarray}
\qquad(2)\]</span></span></p>
<p>Las transformaciones dadas por la <a href="#/eq-boxmuller" class="quarto-xref">Ecuación&nbsp;2</a> son conocidas como las <span class="green">transformaciones de Box-Müller</span>.</p>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Desafortunadamente, el uso de las transformaciones de Box-Müller para generar un par de variables aleatorias normales estándar independientes no es computacionalmente muy eficiente. La razón de esto es la necesidad de calcular las funciones trigonométricas seno y coseno.</p></li>
<li class="fragment"><p>Sin embargo, hay una manera de evitar esta dificultad que consume tiempo mediante un cálculo indirecto del seno y coseno de un ángulo aleatorio (en lugar de un cálculo directo que genera <span class="math inline">\(U\)</span> y luego calcula el seno y coseno de <span class="math inline">\(2\pi U\)</span>).</p></li>
<li class="fragment"><p>Para empezar, observe que si <span class="math inline">\(U\)</span> es uniforme en <span class="math inline">\((0, 1)\)</span>, entonces <span class="math inline">\(2U\)</span> es uniforme en <span class="math inline">\((0, 2)\)</span>, y por lo tanto <span class="math inline">\(2U - 1\)</span> es uniforme en <span class="math inline">\((-1, 1)\)</span>.</p></li>
<li class="fragment"><p>Así, si generamos números aleatorios <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span> y definimos</p></li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
V_1 =&amp; 2U_1 - 1 \\
V_2 =&amp; 2U_2 - 1
\end{eqnarray} \]</span></p>
<div class="fragment">
<p>entonces <span class="math inline">\((V_1, V_2)\)</span> está uniformemente distribuido en el cuadrado de área 4 centrado en <span class="math inline">\((0, 0)\)</span></p>
</div>
</section><section class="slide level2">
<img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-28-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section><section class="slide level2"><ul>
<li class="fragment"><p>Supongamos ahora que generamos continuamente pares <span class="math inline">\((V_1, V_2)\)</span> hasta que obtenemos uno que esté contenido en el círculo de radio 1 centrado en <span class="math inline">\((0, 0)\)</span>, es decir, hasta que <span class="math inline">\((V_1, V_2)\)</span> sea tal que <span class="math inline">\(V_1^2 + V_2^2 \leq 1\)</span>. <span class="math inline">\((V_1, V_2)\)</span> está uniformemente distribuido en el círculo.</p></li>
<li class="fragment"><p>Si dejamos que <span class="math inline">\(R\)</span> y <span class="math inline">\(\Theta\)</span> representen las coordenadas polares de este par, entonces no es difícil verificar que <span class="math inline">\(R\)</span> y <span class="math inline">\(\Theta\)</span> son independientes, con <span class="math inline">\(R^2\)</span> uniformemente distribuido en <span class="math inline">\((0, 1)\)</span> y con <span class="math inline">\(\Theta\)</span> uniformemente distribuido en <span class="math inline">\((0, 2\pi)\)</span>. Dado que</p></li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
\sin \Theta =&amp; \frac{V_2}{R} = \frac{V_2}{(V_1^2 + V_2^2)^{1/2}} \\
\cos \Theta =&amp; \frac{V_1}{R} = \frac{V_1}{(V_1^2 + V_2^2)^{1/2}}
\end{eqnarray}\]</span></p>
<div class="fragment">
<p>se sigue que podemos generar el seno y el coseno de un ángulo aleatorio <span class="math inline">\(\Theta\)</span> generando un punto aleatorio <span class="math inline">\((V_1, V_2)\)</span> en el círculo y luego estableciendo</p>
<p><span class="math display">\[\begin{eqnarray}
\sin \Theta =&amp; \frac{V_2}{R} = \frac{V_2}{(V_1^2 + V_2^2)^{1/2}} \\
\cos \Theta =&amp; \frac{V_1}{R} = \frac{V_1}{(V_1^2 + V_2^2)^{1/2}}
\end{eqnarray}\]</span></p>
</div>
</section><section class="slide level2"><p>Se deduce ahora de la transformación de Box-Muller (<a href="#/eq-boxmuller" class="quarto-xref">Ecuación&nbsp;2</a>) que podemos generar normales estándar independientes generando un número aleatorio <span class="math inline">\(U\)</span> y estableciendo</p>
<p><span id="eq-polar2"><span class="math display">\[\begin{eqnarray}
X =&amp; (-2 \log U)^{1/2} \frac{V_1}{(V_1^2 + V_2^2)^{1/2}} \\
Y =&amp; (-2 \log U)^{1/2} \frac{V_2}{(V_1^2 + V_2^2)^{1/2}}
\end{eqnarray} \qquad(3)\]</span></span></p>
<p>De hecho, dado que <span class="math inline">\(R^2 = V_1^2 + V_2^2\)</span> está uniformemente distribuido en <span class="math inline">\((0, 1)\)</span> y es independiente del ángulo aleatorio <span class="math inline">\(\Theta\)</span>, podemos usarlo como el número aleatorio <span class="math inline">\(U\)</span> necesario en la <a href="#/eq-polar2" class="quarto-xref">Ecuación&nbsp;3</a>. Por lo tanto, dejando <span class="math inline">\(S = R^2\)</span>, obtenemos que</p>
<p><span class="math display">\[\begin{eqnarray}
X =&amp; (-2 \log S)^{1/2} \frac{V_1}{S^{1/2}} = V_1 \left(\frac{-2 \log S}{S}\right)^{1/2} \\
Y =&amp; (-2 \log S)^{1/2} \frac{V_2}{S^{1/2}} = V_2 \left(\frac{-2 \log S}{S}\right)^{1/2}
\end{eqnarray}\]</span></p>
<p>son normales estándar independientes cuando <span class="math inline">\((V_1, V_2)\)</span> es un punto elegido al azar en el círculo de radio 1 centrado en el origen, y <span class="math inline">\(S = V_1^2 + V_2^2\)</span>.</p>
</section><section class="slide level2"><div class="alert">
<p>Resumiendo, tenemos el siguiente enfoque para generar un par de normales estándar independientes:</p>
<ul>
<li class="fragment"><p><strong>Paso 1:</strong> Generar números aleatorios, <span class="math inline">\(U_1\)</span> y <span class="math inline">\(U_2\)</span>.</p></li>
<li class="fragment"><p><strong>Paso 2:</strong> Establecer <span class="math inline">\(V_1 = 2U_1 - 1, V_2 = 2U_2 - 1, S = V_1^2 + V_2^2\)</span>.</p></li>
<li class="fragment"><p><strong>Paso 3:</strong> Si <span class="math inline">\(S &gt; 1\)</span>, volver al Paso 1.</p></li>
<li class="fragment"><p><strong>Paso 4:</strong> Devolver las normales estándar independientes.</p></li>
</ul>
<p><span class="math display">\[
X = \sqrt{\frac{-2 \log S}{S}} V_1, \quad Y = \sqrt{\frac{-2 \log S}{S}} V_2
\]</span></p>
</div>
<p>Lo anterior se <span class="green">llama el método polar</span>. Dado que la probabilidad de que un punto aleatorio en el cuadrado caiga dentro del círculo es igual a <span class="math inline">\(\pi/4\)</span> (el área del círculo dividida por el área del cuadrado), se deduce que, en promedio, el método polar requerirá <span class="math inline">\(4/\pi \approx 1.273\)</span> iteraciones del Paso 1. Por lo tanto, en promedio, requerirá <span class="math inline">\(2.546\)</span> números aleatorios, <span class="math inline">\(1\)</span> logaritmo, <span class="math inline">\(1\)</span> raíz cuadrada, <span class="math inline">\(1\)</span> división y <span class="math inline">\(4.546\)</span> multiplicaciones para generar dos normales estándar independientes.</p>
<!-- # Método de composición {background-color="#00A499"} -->
<!-- --- -->
<!-- ## La idea intuitiva -->
<!-- Supongamos que tenemos un método eficiente para simular el valor de una variable aleatoria que toma cualquiera de las siguientes dos funciones de masa de probabilidad $\{ p_j^{(1)}, j \geq 0 \}$ o $\{ p_j^{(2)}, j \geq 0 \}$, y queremos simular el valor de la variable aleatoria $X$ que tiene función de masa de probabilidad dada por: -->
<!-- $$P\{ X=j \} = \alpha p_j^{(1)} + (1- \alpha) p_j^{(2)}, \qquad j \geq 0$$ {#eq-composition} -->
<!-- donde $0 < \alpha < 1$. Una manera para simular esta v.a. $X$ es tomar en cuenta que si $X_1$ y $X_2$ son v.a. con sus respectivas funciones de masa dadas por $\{ p_j^{(1)} \}$ y $\{ p_j^{(2)} \}$, entonces la variable aleatoria $X$ es definida por: -->
<!-- $$ X = \left\{\begin{matrix} -->
<!-- X_1 & \text{con probabilidad } \alpha\\  -->
<!-- X_2 & \text{con probabilidad } 1- \alpha  -->
<!-- \end{matrix}\right. $$  -->
<!-- tendrá su función de masa de probabilidadd dada por la @eq-composition. De esto sigue que es posible generar el valor de esta variable aleatoria al generar un número aleatorio $U$ y luego generar el valor de $X_1$ si $U > \alpha$ y de $X_2$ si $U > \alpha$. -->
<!-- --- -->
<!-- ::: {.example} -->
<!-- [Ejemplo]{.green}: </br> -->
<!-- Supongamos que queremos generar el valor de una variable aleatoria $X$ tal que -->
<!-- $$ -->
<!-- p_j = P\{X = j\} =  -->
<!-- \begin{cases}  -->
<!-- 0.05 & \text{para } j = 1, 2, 3, 4, 5 \\ -->
<!-- 0.15 & \text{para } j = 6, 7, 8, 9, 10  -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- ::: -->
<!-- --- -->
<!-- Notando que $p_j = 0.5p_j^{(1)} + 0.5p_j^{(2)}$, donde -->
<!-- $$ -->
<!-- p_j^{(1)} = 0.1, \quad j = 1, \ldots, 10 \quad \text{y} \quad p_j^{(2)} =  -->
<!-- \begin{cases}  -->
<!-- 0 & \text{para } j = 1, 2, 3, 4, 5 \\ -->
<!-- 0.2 & \text{para } j = 6, 7, 8, 9, 10  -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- podemos lograr esto generando primero un número aleatorio $U$ y luego generando de la distribución uniforme discreta sobre $1, \ldots, 10$ si $U < 0.5$ y de la uniforme discreta sobre $6, 7, 8, 9, 10$ de otro modo.  -->
<!-- Es decir, podemos simular $X$ de la siguiente manera: -->
<!-- **Paso 1:** Generar un número aleatorio $U_1$.   -->
<!-- **Paso 2:** Generar un número aleatorio $U_2$.   -->
<!-- **Paso 3:** Si $U_1 < 0.5$, entonces $X = \text{Int}(10U_2) + 1$. De lo contrario, $X = \text{Int}(5U_2) + 6$. -->
<!-- --- -->
<!-- Si $F_i, \, i = 1, \ldots, n$ son funciones de distribución y $\alpha_i, \, i = 1, \ldots, n$ son números no negativos que suman 1, entonces la función de distribución $F$ dada por -->
<!-- $$ -->
<!-- F(x) = \sum_{i=1}^{n} \alpha_i F_i(x) -->
<!-- $$ -->
<!-- se dice que es una mezcla, o [una composición]{.green}, de las funciones de distribución $F_i, \, i = 1, \ldots, n$. Una forma de simular a partir de $F$ es primero simular una variable aleatoria $I$, igual a $i$ con probabilidad $\alpha_i, \, i = 1, \ldots, n$, y luego simular a partir de la distribución $F_I$. (Es decir, si el valor simulado de $I$ es $j$, entonces la segunda simulación es de $F_j$.) Este enfoque para simular a partir de $F$ se conoce como el método de composición. -->
<!-- --- -->
<!-- ::: {.definition} -->
<!-- Aplicable cuando la función de distribución deseada puede expresarse como una combinación convexa de varias funciones de distribución. Este método asume que una función de distribución acumulada (cdf), $F$, puede expresarse como una mezcla de cdfs $\{G_i\}$, es decir: -->
<!-- $$ -->
<!-- F(x) = \sum_{i=1}^{m} p_i G_i(x) , -->
<!-- $$ -->
<!-- donde -->
<!-- $$ -->
<!-- p_i > 0, -->
<!-- $$ -->
<!-- $$ -->
<!-- \sum_{i=1}^{m} p_i = 1 . -->
<!-- $$ -->
<!-- ::: -->
<!-- --- -->
<!-- Sea $X_i \sim G_i$ y sea $Y$ una variable aleatoria discreta con $\mathbb{P}(Y = i) = p_i$, independiente de $X_i$, para $1 \leq i \leq m$. Entonces una variable aleatoria $X$ con cdf $F$ puede representarse como -->
<!-- $$ -->
<!-- X = \sum_{i=1}^{m} X_i \mathbb{I}_{(Y = i)}. -->
<!-- $$ -->
<!-- Se deduce que, para generar $X$ a partir de $F$, primero debemos generar la variable aleatoria discreta $Y$ y luego, dado $Y = i$, generar $X_i$ de $G_i$. Así, tenemos el siguiente método. -->
<!-- ::: {.alert} -->
<!-- ::: {.small} -->
<!-- - **Paso 1**: Generar la variable aleatoria $Y$ de acuerdo con -->
<!-- $$ -->
<!-- \mathbb{P}(Y = i) = p_i, \quad i = 1, \ldots, m . -->
<!-- $$ -->
<!-- - **Paso 2**: Dado $Y = i$, generar $X$ de la cdf $G_i$. -->
<!-- ::: -->
<!-- ::: -->
<!-- --- -->
</section></section><section><section id="método-de-composición-sumas-y-mixturas" class="title-slide slide level1 center" data-background-color="#00A499" data-number="6"><h1>
<span class="header-section-number">6</span> Método de composición (Sumas y Mixturas)</h1>

</section><section id="la-idea-intuitiva-2" class="slide level2" data-number="6.1"><h2>
<span class="header-section-number">6.1</span> La idea intuitiva</h2>
<div class="definition">
<p><span class="blue">Sumas de Variables Aleatorias</span> </p>
<ul>
<li class="fragment"><p>Imaginemos que se tienen <span class="green">dos variables aleatorias diferentes</span>, como la <span class="orange">altura de una persona y su peso</span>.</p></li>
<li class="fragment"><p>Si se quiere encontrar la distribución conjunta de la <strong>suma</strong> de estas dos variables, podemos pensar en cada posible combinación de altura y peso y sumar esos valores.</p></li>
<li class="fragment"><p>La <span class="green">suma de variables aleatorias tiende a mezclar sus distribuciones</span>, resultando en una nueva distribución que combina las características de ambas.</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Método:</strong></p>
<div class="small">
<ul>
<li class="fragment"><p>Paso 1. Generar un valor aleatorio para cada una de las variables.</p></li>
<li class="fragment"><p>Paso 2. Sumar estos valores para obtener un nuevo valor aleatorio.</p></li>
<li class="fragment"><p>Paso 3. Repetir Paso 1.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span> </p>
<p>Supongamos que se tienen dos variables aleatorias, <span class="math inline">\(X_1 \sim N(0, 1)\)</span> y <span class="math inline">\(X_2 \sim N(3, 1)\)</span>. Para encontrar la distribución de su suma, <span class="math inline">\(S = X_1 + X_2\)</span>:</p>
</div>
<div class="small">
<ol type="1">
<li class="fragment"><p>Generar un valor <span class="math inline">\(x_1\)</span> de <span class="math inline">\(N(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Generar un valor <span class="math inline">\(x_2\)</span> de <span class="math inline">\(N(3, 1)\)</span>.</p></li>
<li class="fragment"><p>Sumar estos valores: <span class="math inline">\(s = x_1 + x_2\)</span>.</p></li>
</ol>
</div>
<div class="fragment">
<p>El resultado es una nueva variable aleatoria <span class="math inline">\(S\)</span> que sigue una distribución normal con media 3 y varianza 2.</p>
</div>
</section><section class="slide level2"><div class="definition">
<p><span class="blue">Mezclas de Variables Aleatorias</span> </p>
<ul>
<li class="fragment"><p>Pensemos en una mezcla de variables aleatorias como un chef que elige entre <span class="green">dos recetas diferentes para cocinar una comida</span>.</p></li>
<li class="fragment"><p>En lugar de combinar todos los ingredientes de ambas recetas, el chef decide <em>aleatoriamente</em> cuál receta seguir cada vez que cocina.</p></li>
<li class="fragment"><p>Así, algunas comidas seguirán una receta y otras seguirán la otra, creando una <span class="green">mezcla de dos tipos de comidas</span> en el menú.</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Método:</strong></p>
<div class="small">
<ul>
<li class="fragment"><p>Paso 1. Decidir de manera aleatoria cuál de las variables aleatorias utilizar.</p></li>
<li class="fragment"><p>Paso 2. Generar un valor aleatorio de la variable elegida.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo:</span> </p>
<p>Supongamos que tenemos dos variables aleatorias, <span class="math inline">\(X_1 \sim N(0, 1)\)</span> y <span class="math inline">\(X_2 \sim N(3, 1)\)</span>. Para crear una mezcla de estas variables:</p>
</div>
<div class="small">
<ol type="1">
<li class="fragment"><p>Elegimos aleatoriamente entre <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_2\)</span> con probabilidad igual.</p></li>
<li class="fragment"><p>Si escogemos <span class="math inline">\(X_1\)</span>, generamos un valor <span class="math inline">\(x\)</span> de <span class="math inline">\(N(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Si escogemos <span class="math inline">\(X_2\)</span>, generamos un valor <span class="math inline">\(x\)</span> de <span class="math inline">\(N(3, 1)\)</span>.</p></li>
</ol>
</div>
<div class="fragment">
<p>El resultado es una nueva variable aleatoria <span class="math inline">\(X\)</span> que tiene una distribución bimodal, ya que mezcla las dos distribuciones normales originales.</p>
<!-- ::: {.alert} -->
<!-- - **Sumas:** La suma de variables aleatorias tiende a "suavizar" la distribución resultante. Por ejemplo, sumar dos distribuciones normales produce otra distribución normal. -->
<!-- - **Mezclas:** Una mezcla de variables aleatorias puede crear una distribución más compleja y multimodal. La mezcla no suaviza, sino que mantiene las características distintivas de las distribuciones individuales. -->
<!-- ::: -->
</div>
</section><section id="convoluciones" class="slide level2" data-number="6.2"><h2>
<span class="header-section-number">6.2</span> Convoluciones</h2>
<ul>
<li class="fragment"><p>Sean <span class="math inline">\(X_1, \ldots, X_n\)</span> independientes e idénticamente distribuidas con distribución <span class="math inline">\(X_j \sim X\)</span>, y sea <span class="math inline">\(S = X_1 + \cdots + X_n\)</span>. La <span class="green">función de distribución de la suma <span class="math inline">\(S\)</span> se llama la <span class="math inline">\(n\)</span>-ésima convolución de <span class="math inline">\(X\)</span></span> y se denota <span class="math inline">\(F_X^{*(n)}\)</span>.</p></li>
<li class="fragment"><p>Es sencillo simular una convolución generando directamente <span class="math inline">\(X_1, \ldots, X_n\)</span> y calculando la suma.</p></li>
<li class="fragment">
<p>Varias distribuciones están relacionadas por convolución.</p>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(\nu &gt; 0\)</span> es un entero, la distribución chi-cuadrado con <span class="math inline">\(\nu\)</span> grados de libertad es la convolución de <span class="math inline">\(\nu\)</span> variables aleatorias normales estándar iid al cuadrado.</p></li>
<li class="fragment"><p>La distribución binomial negativa <span class="math inline">\(\text{NegBin}(r, p)\)</span> es la convolución de <span class="math inline">\(r\)</span> variables aleatorias geométricas iid <span class="math inline">\(\text{Geom}(p)\)</span>.</p></li>
<li class="fragment"><p>La convolución de <span class="math inline">\(r\)</span> variables aleatorias exponenciales independientes <span class="math inline">\(\text{Exp}(\lambda)\)</span> tiene la distribución Gamma<span class="math inline">\((r, \lambda)\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="fragment">
<p>Consultar <a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">el siguiente enlace</a> para una presentación introductoria de estas y muchas otras relaciones interesantes entre familias de distribuciones.</p>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo: Distribución Chi-cuadrado</span> </p>
<p>Podemos generar una variable aleatoria chi cuadrado <span class="math inline">\(\chi^2(\nu)\)</span> como la convolución de <span class="math inline">\(\nu\)</span> normales al cuadrado. Si <span class="math inline">\(Z_1, \ldots, Z_\nu\)</span> son variables aleatorias iid <span class="math inline">\(N(0,1)\)</span>, entonces <span class="math inline">\(V = Z_1^2 + \cdots + Z_\nu^2\)</span> tiene la distribución <span class="math inline">\(\chi^2(\nu)\)</span>. Los pasos para generar una muestra aleatoria de tamaño <span class="math inline">\(n\)</span> de <span class="math inline">\(\chi^2(\nu)\)</span> son los siguientes:</p>
<div class="small">
<ul>
<li class="fragment"><p>Paso 1. Llenar una matriz <span class="math inline">\(n \times \nu\)</span> con <span class="math inline">\(n\nu\)</span> muestras aleatorias <span class="math inline">\(N(0,1)\)</span>.</p></li>
<li class="fragment"><p>Paso 2. Elevar al cuadrado cada entrada en la matriz (1).</p></li>
<li class="fragment"><p>Paso 3. Calcular las sumas de las filas de los normales al cuadrado. Cada suma de fila es una observación aleatoria de la distribución <span class="math inline">\(\chi^2(\nu)\)</span>.</p></li>
<li class="fragment"><p>Paso 4. Entregar el vector de sumas de filas.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>Un ejemplo con <span class="math inline">\(n = 1000\)</span> y <span class="math inline">\(\nu = 2\)</span> se muestra a continuación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb33-2"><a href=""></a>nu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb33-3"><a href=""></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> nu), n, nu)<span class="sc">^</span><span class="dv">2</span>  <span class="co"># matriz de normales al cuadrado</span></span>
<span id="cb33-4"><a href=""></a><span class="co"># sumar los normales al cuadrado a través de cada fila: método 1</span></span>
<span id="cb33-5"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(X)</span>
<span id="cb33-6"><a href=""></a><span class="co"># método 2</span></span>
<span id="cb33-7"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="at">MARGIN=</span><span class="dv">1</span>, <span class="at">FUN=</span>sum)  <span class="co"># un vector de longitud n</span></span>
<span id="cb33-8"><a href=""></a><span class="fu">mean</span>(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.998142</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">var</span>(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.830044</code></pre>
</div>
</div>
<p>Una variable aleatoria <span class="math inline">\(\chi^2(\nu)\)</span> tiene media <span class="math inline">\(\nu\)</span> y varianza <span class="math inline">\(2\nu\)</span>. Nuestros parámetros calculados concuerdan muy de cerca con los parámetros teóricos.</p>
</section><section id="mixturas" class="slide level2" data-number="6.3"><h2>
<span class="header-section-number">6.3</span> Mixturas</h2>
<div class="definition">
<p>Una variable aleatoria <span class="math inline">\(X\)</span> <span class="green">es una mezcla discreta</span> si la distribución de <span class="math inline">\(X\)</span> es una suma ponderada <span class="math inline">\(F_X(x) = \sum \theta_i F_{X_i}(x)\)</span> para alguna secuencia de variables aleatorias <span class="math inline">\(X_1, X_2, \ldots\)</span> y <span class="math inline">\(\theta_i &gt; 0\)</span> tal que <span class="math inline">\(\sum \theta_i = 1\)</span>. Las constantes <span class="math inline">\(\theta_i\)</span> se llaman pesos de mezcla o probabilidades de mezcla. Aunque la notación es similar para sumas y mezclas, las distribuciones representadas son diferentes.</p>
</div>
<div class="definition">
<p>Una variable aleatoria <span class="math inline">\(X\)</span> <span class="green">es una mezcla continua</span> si la distribución de <span class="math inline">\(X\)</span> es <span class="math inline">\(F_X(x) = \int_{-\infty}^{\infty} F_{X|Y=y}(x) f_Y(y) \, dy\)</span> para una familia <span class="math inline">\(X|Y = y\)</span> indexada por los números reales <span class="math inline">\(y\)</span> y la función de ponderación <span class="math inline">\(f_Y\)</span> tal que <span class="math inline">\(\int_{-\infty}^{\infty} f_Y(y) \, dy = 1\)</span>.</p>
</div>
</section><section class="slide level2"><p>Comparamos los métodos para la simulación <span class="green">de una convolución</span> y <span class="green">una mixtura de variables</span> normales. Supongamos <span class="math inline">\(X_1 \sim N(0, 1)\)</span> y <span class="math inline">\(X_2 \sim N(3, 1)\)</span> son independientes. La notación <span class="math inline">\(S = X_1 + X_2\)</span> denota la convolución de <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_2\)</span>. La distribución de <span class="math inline">\(S\)</span> es normal con media <span class="math inline">\(\mu_1 + \mu_2 = 3\)</span> y varianza <span class="math inline">\(\sigma_1^2 + \sigma_2^2 = 2\)</span>.</p>
<div class="alert">
<p>Para simular la convolución:</p>
<div class="small">
<ul>
<li class="fragment"><p>Paso 1. Generar <span class="math inline">\(x_1 \sim N(0, 1)\)</span>.</p></li>
<li class="fragment"><p>Paso 2. Generar <span class="math inline">\(x_2 \sim N(3, 1)\)</span>.</p></li>
<li class="fragment"><p>Paso 3. Hacer <span class="math inline">\(s = x_1 + x_2\)</span>.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><p>También podemos definir una mezcla normal al 50%, denotada <span class="math inline">\(F_X(x) = 0.5F_{X_1}(x) + 0.5F_{X_2}(x)\)</span>. A diferencia de la convolución anterior, la distribución de la mezcla <span class="math inline">\(X\)</span> es claramente no normal; es bimodal.</p>
<div class="alert">
<p>Para simular la mezcla:</p>
<div class="small">
<ul>
<li class="fragment"><p>Paso 1. Generar un entero <span class="math inline">\(k \in \{1, 2\}\)</span>, donde <span class="math inline">\(P(1) = P(2) = 0.5\)</span>.</p></li>
<li class="fragment"><p>Paso 2. Si <span class="math inline">\(k = 1\)</span>, entregar un valor aleatorio <span class="math inline">\(x\)</span> de <span class="math inline">\(N(0, 1)\)</span>; si <span class="math inline">\(k = 2\)</span>, entregar un valor aleatorio <span class="math inline">\(x\)</span> de <span class="math inline">\(N(3, 1)\)</span>.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Comparación entre Convoluciones y mezclas</span> </p>
<p>Sean <span class="math inline">\(X_1 \sim \text{Gamma}(2, 2)\)</span> y <span class="math inline">\(X_2 \sim \text{Gamma}(2, 4)\)</span> independientes. Comparamos los histogramas de las muestras generadas por la convolución <span class="math inline">\(S = X_1 + X_2\)</span> y la mezcla <span class="math inline">\(F_X = 0.5F_{X_1} + 0.5F_{X_2}\)</span>.</p>
</div>
<p></p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-2"><a href=""></a><span class="fu">library</span>(reshape2)</span>
<span id="cb37-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-4"><a href=""></a>x1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb37-5"><a href=""></a>x2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb37-6"><a href=""></a>s <span class="ot">&lt;-</span> x1 <span class="sc">+</span> x2          <span class="co"># la convolución</span></span>
<span id="cb37-7"><a href=""></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb37-8"><a href=""></a>k <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u <span class="sc">&gt;</span> <span class="fl">0.5</span>)  <span class="co"># vector de 0's y 1's</span></span>
<span id="cb37-9"><a href=""></a>x <span class="ot">&lt;-</span> k <span class="sc">*</span> x1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">*</span> x2  <span class="co"># la mezcla</span></span>
<span id="cb37-10"><a href=""></a></span>
<span id="cb37-11"><a href=""></a><span class="fu">data.frame</span>(s, x) <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href=""></a>  <span class="fu">melt</span>(<span class="at">key =</span> <span class="fu">c</span>(<span class="st">"s"</span>, <span class="st">"x"</span>), <span class="at">value.name=</span><span class="st">"sim"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-13"><a href=""></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-14"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>sim), <span class="at">color =</span> <span class="st">"green4"</span>, <span class="at">fill=</span><span class="st">"orange3"</span>) <span class="sc">+</span></span>
<span id="cb37-15"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable) <span class="sc">+</span></span>
<span id="cb37-16"><a href=""></a>  <span class="fu">xlab</span>(<span class="st">"Histogramas"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb37-17"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-31-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><p>El método de generación de la mezcla del ejemplo anterior es simple para una mezcla de dos distribuciones, pero no para mezclas arbitrarias. El siguiente ejemplo ilustra cómo generar una mezcla de varias distribuciones con probabilidades de mezcla arbitrarias.</p>
<div class="example">
<p><span class="green">Mezcla de varias distribuciones gamma</span> </p>
<p>Este ejemplo es similar al anterior, pero hay varios componentes en la mezcla y los pesos de mezcla no son uniformes. La mezcla está dada por</p>
<p><span class="math display">\[
F_X = \sum_{i=1}^{5} \theta_j F_{X_j},
\]</span></p>
<p>donde <span class="math inline">\(X_j \sim \text{Gamma}(r = 3, \lambda_j = 1/j)\)</span> son independientes y las probabilidades de mezcla son <span class="math inline">\(\theta_j = j/15, \, j = 1, \ldots, 5\)</span>.</p>
<p>Para simular una variable aleatoria de la mezcla <span class="math inline">\(F_X\)</span>:</p>
<ul>
<li class="fragment"><p>Paso 1. Generar un entero <span class="math inline">\(k \in \{1, 2, 3, 4, 5\}\)</span>, donde <span class="math inline">\(P(k) = \theta_k, \, k = 1, \ldots, 5\)</span>.</p></li>
<li class="fragment"><p>Paso 2. Entregar un valor aleatorio <span class="math inline">\(\text{Gamma}(r, \lambda_k)\)</span>.</p></li>
</ul>
</div>
<!-- --- -->
<!-- ::: {.alert} -->
<!-- [Eficiencia del cómputo]{.blue} -->
<!-- - Para generar una muestra de tamaño $n$, los pasos (1) y (2) se repiten $n$ veces. Notar que el algoritmo mencionado anteriormente implica usar un ciclo `for`, pero [los ciclos `for` son realmente ineficientes en R]{.orange}. El algoritmo se puede traducir a un enfoque vectorizado. -->
<!--   - Paso 1. Generar una muestra aleatoria $k_1, \ldots, k_n$ de enteros en un vector $k$, donde $P(k) = \theta_k$, $k = 1, \ldots, 5$. Luego, $k[i]$ indica cuál de las cinco distribuciones gamma se muestreará para obtener el elemento $i$-ésimo de la muestra (usa `sample`). -->
<!--   - Paso 2. Establecer `tasa` igual al vector de longitud $n$ $\lambda = (\lambda_k)$. -->
<!--   - Paso 3. Generar una muestra gamma de tamaño $n$, con el parámetro de forma $r$ y el vector de tasas `tasa` (usar `rgamma`). -->
<!-- ::: -->
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb38-2"><a href=""></a><span class="co"># Generar datos</span></span>
<span id="cb38-3"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb38-4"><a href=""></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">TRUE</span>, </span>
<span id="cb38-5"><a href=""></a>            <span class="at">prob=</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="sc">/</span><span class="dv">15</span>)</span>
<span id="cb38-6"><a href=""></a>tasa <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>k</span>
<span id="cb38-7"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">rate=</span>tasa)</span>
<span id="cb38-8"><a href=""></a></span>
<span id="cb38-9"><a href=""></a><span class="co"># Crear un dataframe para ggplot2</span></span>
<span id="cb38-10"><a href=""></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> x, <span class="at">tipo =</span> <span class="st">"Mezcla"</span>)</span>
<span id="cb38-11"><a href=""></a></span>
<span id="cb38-12"><a href=""></a><span class="co"># Agregar las densidades de los componentes</span></span>
<span id="cb38-13"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb38-14"><a href=""></a>  df_componente <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-15"><a href=""></a>    <span class="at">value =</span> <span class="fu">rgamma</span>(n, <span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span>i), </span>
<span id="cb38-16"><a href=""></a>    <span class="at">tipo =</span> <span class="fu">paste</span>(<span class="st">"Componente"</span>, i))</span>
<span id="cb38-17"><a href=""></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, df_componente)</span>
<span id="cb38-18"><a href=""></a>}</span>
<span id="cb38-19"><a href=""></a></span>
<span id="cb38-20"><a href=""></a><span class="co"># Graficar usando ggplot2</span></span>
<span id="cb38-21"><a href=""></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> tipo)) <span class="sc">+</span></span>
<span id="cb38-22"><a href=""></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb38-23"><a href=""></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb38-24"><a href=""></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb38-25"><a href=""></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb38-26"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-33-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Mezcla de varias distribuciones gamma</span> </p>
<p>Sea</p>
<p><span class="math display">\[
F_X = \sum_{j=1}^{5} \theta_j F_{X_j},
\]</span></p>
<p>donde <span class="math inline">\(X_j \sim \text{Gamma}(3, \lambda_j)\)</span> son independientes, con tasas <span class="math inline">\(\lambda = (1, 1.5, 2, 2.5, 3)\)</span> y probabilidades de mezcla <span class="math inline">\(\theta = (0.1, 0.2, 0.2, 0.3, 0.2)\)</span>.</p>
</div>
</section><section class="slide level2"><p>Este ejemplo es similar al anterior. Muestrea de 1:5 con pesos de probabilidad <span class="math inline">\(\theta\)</span> para obtener un vector de longitud <span class="math inline">\(n\)</span>. La posición <span class="math inline">\(i\)</span>-ésima en este vector indica cuál de las cinco distribuciones gamma se muestreará para obtener el elemento <span class="math inline">\(i\)</span>-ésimo de la muestra. Este vector se usa para seleccionar el parámetro de tasa correcto del vector <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb39-2"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb39-3"><a href=""></a></span>
<span id="cb39-4"><a href=""></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>)</span>
<span id="cb39-5"><a href=""></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span>p)</span>
<span id="cb39-6"><a href=""></a>tasa <span class="ot">&lt;-</span> lambda[k]</span>
<span id="cb39-7"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">rate=</span>tasa)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comparar las primeras entradas de <code>k</code> y los valores correspondientes de <code>tasa</code> con <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>k[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 5 4 5 4 1 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a>tasa[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.0 2.5 3.0 2.5 3.0 2.5 1.0 2.5</code></pre>
</div>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Mezcla Poisson-Gamma</span> </p>
<p>Este es un ejemplo de una mezcla continua. La distribución binomial negativa es una mezcla de distribuciones de Poisson(<span class="math inline">\(\Lambda\)</span>), donde <span class="math inline">\(\Lambda\)</span> tiene una distribución gamma. Específicamente, si <span class="math inline">\((X|\Lambda = \lambda) \sim \text{Poisson}(\lambda)\)</span> y <span class="math inline">\(\Lambda \sim \text{Gamma}(r, \beta)\)</span>, entonces <span class="math inline">\(X\)</span> tiene la distribución binomial negativa con parámetros <span class="math inline">\(r\)</span> y <span class="math inline">\(p = \beta / (1 + \beta)\)</span> (ver, por ejemplo, [23]). Este ejemplo ilustra un método de muestreo de una mezcla Poisson-Gamma y compara la muestra con la distribución binomial negativa.</p>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="co"># Generar una mezcla Poisson-Gamma</span></span>
<span id="cb44-2"><a href=""></a><span class="fu">library</span>(knitr)</span>
<span id="cb44-3"><a href=""></a><span class="fu">library</span>(kableExtra) </span>
<span id="cb44-4"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-5"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb44-6"><a href=""></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb44-7"><a href=""></a>beta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb44-8"><a href=""></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta) <span class="co"># lambda es aleatoria</span></span>
<span id="cb44-9"><a href=""></a></span>
<span id="cb44-10"><a href=""></a><span class="co"># Ahora suministrar la muestra de lambda como la media de Poisson</span></span>
<span id="cb44-11"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda) <span class="co"># la mezcla</span></span>
<span id="cb44-12"><a href=""></a></span>
<span id="cb44-13"><a href=""></a><span class="co"># Comparar con la binomial negativa</span></span>
<span id="cb44-14"><a href=""></a>mix <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(x <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb44-15"><a href=""></a>negbin <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dnbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x), r, beta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>beta)), <span class="dv">3</span>)</span>
<span id="cb44-16"><a href=""></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(negbin <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> negbin) <span class="sc">/</span> n)</span>
<span id="cb44-17"><a href=""></a><span class="fu">round</span>(<span class="fu">rbind</span>(mix, negbin, se), <span class="dv">3</span>)</span>
<span id="cb44-18"><a href=""></a></span>
<span id="cb44-19"><a href=""></a><span class="fu">tibble</span>(<span class="at">mix =</span> mix, <span class="at">negbin =</span> negbin, <span class="at">se =</span> se) <span class="sc">%&gt;%</span> </span>
<span id="cb44-20"><a href=""></a>  <span class="fu">kbl</span>(<span class="at">align =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-21"><a href=""></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb44-22"><a href=""></a>  <span class="fu">kable_styling</span>(<span class="at">font_size=</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
mix    0.314 0.325 0.218 0.084 0.038 0.014 0.004 0.003
negbin 0.316 0.316 0.198 0.099 0.043 0.017 0.006 0.002
se     0.015 0.015 0.013 0.009 0.006 0.004 0.002 0.001</code></pre>
</div>
<div class="cell-output-display">
<div>
<table class="lightable-paper lightable-hover table" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 20px; margin-left: auto; margin-right: auto;">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">mix</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">negbin</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">se</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.314</td>
<td style="text-align: center;">0.316</td>
<td style="text-align: center;">0.0147018</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.325</td>
<td style="text-align: center;">0.316</td>
<td style="text-align: center;">0.0147018</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.218</td>
<td style="text-align: center;">0.198</td>
<td style="text-align: center;">0.0126014</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.084</td>
<td style="text-align: center;">0.099</td>
<td style="text-align: center;">0.0094445</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.038</td>
<td style="text-align: center;">0.043</td>
<td style="text-align: center;">0.0064149</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.014</td>
<td style="text-align: center;">0.017</td>
<td style="text-align: center;">0.0040879</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.004</td>
<td style="text-align: center;">0.006</td>
<td style="text-align: center;">0.0024421</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">0.002</td>
<td style="text-align: center;">0.0014128</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section></section><section><section id="normal-multivariada" class="title-slide slide level1 center" data-background-color="#00A499" data-number="7"><h1>
<span class="header-section-number">7</span> Normal multivariada</h1>

</section><section class="slide level2"><div class="definition">
<p>Un vector aleatorio <span class="math inline">\(X = (X_1, \ldots, X_d)\)</span> tiene una <span class="green">distribución normal multivariante</span> de <span class="math inline">\(d\)</span> dimensiones denotada <span class="math inline">\(N_d(\mu, \Sigma)\)</span> si la densidad de <span class="math inline">\(X\)</span> es</p>
<p><span class="math display">\[
f(x) = \frac{1}{(2\pi)^{d/2} |\Sigma|^{1/2}} \exp \left\{-\frac{1}{2}(x - \mu)^T \Sigma^{-1} (x - \mu)\right\}, \quad x \in \mathbb{R}^d,
\]</span></p>
<p>donde <span class="math inline">\(\mu = (\mu_1, \ldots, \mu_d)^T\)</span> es el vector de medias y <span class="math inline">\(\Sigma\)</span> es una matriz simétrica positiva definida de <span class="math inline">\(d \times d\)</span></p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
\sigma_{11} &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1d} \\
\sigma_{21} &amp; \sigma_{22} &amp; \cdots &amp; \sigma_{2d} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\sigma_{d1} &amp; \sigma_{d2} &amp; \cdots &amp; \sigma_{dd}
\end{bmatrix}
\]</span></p>
<p>con entradas <span class="math inline">\(\sigma_{ij} = \text{Cov}(X_i, X_j)\)</span>. Aquí <span class="math inline">\(\Sigma^{-1}\)</span> es la inversa de <span class="math inline">\(\Sigma\)</span>, y <span class="math inline">\(|\Sigma|\)</span> es el determinante de <span class="math inline">\(\Sigma\)</span>. La distribución normal bivariada es el caso especial <span class="math inline">\(N_2(\mu, \Sigma)\)</span>.</p>
</div>
</section><section class="slide level2"><div class="alert">
<p>Un vector <span class="math inline">\(N_d(\mu, \Sigma)\)</span> aleatorio puede generarse en dos pasos:</p>
<ul>
<li class="fragment"><p>Paso 1: Generar <span class="math inline">\(Z = (Z_1, \ldots, Z_d)\)</span>, donde <span class="math inline">\(Z_1, \ldots, Z_d\)</span> son normales estándar iid.</p></li>
<li class="fragment"><p>Paso 2: Transformar el vector aleatorio <span class="math inline">\(Z\)</span> para que tenga la estructura de media <span class="math inline">\(\mu\)</span> y covarianza <span class="math inline">\(\Sigma\)</span> deseada. La transformación requiere factorizar la matriz de covarianza <span class="math inline">\(\Sigma\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<div>
<p>Si <span class="math inline">\(Z \sim N_d(\mu, \Sigma)\)</span>, entonces la transformación lineal <span class="math inline">\(CZ + b\)</span> es normal multivariante con media <span class="math inline">\(C\mu + b\)</span> y covarianza <span class="math inline">\(C \Sigma C^T\)</span>. Si <span class="math inline">\(Z \sim N_d(0, I_d)\)</span>, entonces</p>
<p><span class="math display">\[
CZ + b \sim N_d(b, C \Sigma C^T).
\]</span></p>
<p>Supongamos que <span class="math inline">\(\Sigma\)</span> puede factorizarse de modo que <span class="math inline">\(\Sigma = C C^T\)</span> para alguna matriz <span class="math inline">\(C\)</span>. Entonces</p>
<p><span class="math display">\[
CZ + \mu \sim N_d(\mu, \Sigma),
\]</span></p>
<p>y <span class="math inline">\(CZ + \mu\)</span> es la transformación requerida.</p>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>La factorización requerida de <span class="math inline">\(\Sigma\)</span> puede obtenerse mediante el método de descomposición espectral (descomposición en valores propios), factorización de Cholesky o descomposición en valores singulares (svd). Las funciones de R correspondientes son <code>eigen</code>, <code>chol</code> y <code>svd</code>.</p></li>
<li class="fragment"><p>Usualmente, no se aplica una transformación lineal a los vectores aleatorios de una muestra uno a la vez. Típicamente, se aplica la transformación a una matriz de datos y se transforma toda la muestra.</p></li>
</ul>
<p></p>
<div class="fragment">
<div>
<p>Supongamos que <span class="math inline">\(Z = (Z_{ij})\)</span> es una matriz <span class="math inline">\(n \times d\)</span> donde <span class="math inline">\(Z_{ij}\)</span> son iid <span class="math inline">\(N(0, 1)\)</span>. Entonces las filas de <span class="math inline">\(Z\)</span> son <span class="math inline">\(n\)</span> observaciones aleatorias de la distribución estándar <span class="math inline">\(d\)</span>-dimensional MVN. La transformación requerida aplicada a la matriz de datos es</p>
<p><span class="math display">\[
X = ZQ + J\mu^T,
\]</span></p>
<p>donde <span class="math inline">\(Q^TQ = \Sigma\)</span> y <span class="math inline">\(J\)</span> es un vector columna de unos. Las filas de <span class="math inline">\(X\)</span> son observaciones aleatorias de la distribución <span class="math inline">\(d\)</span>-dimensional MVN con vector de medias <span class="math inline">\(\mu\)</span> y matriz de covarianza <span class="math inline">\(\Sigma\)</span>.</p>
</div>
</div>
</section><section id="método-para-generar-muestras-normales-multivariadas" class="slide level2" data-number="7.1"><h2>
<span class="header-section-number">7.1</span> Método para generar muestras normales multivariadas</h2>
<div class="definition">
<p>Para generar una muestra aleatoria de tamaño <span class="math inline">\(n\)</span> de la distribución <span class="math inline">\(N_d(\mu, \Sigma)\)</span>:</p>
<ul>
<li class="fragment"><p>Paso 1. Generar una matriz <span class="math inline">\(n \times d\)</span> <span class="math inline">\(Z\)</span> que contenga <span class="math inline">\(nd\)</span> varíates aleatorios <span class="math inline">\(N(0, 1)\)</span> (n vectores aleatorios en <span class="math inline">\(\mathbb{R}^d\)</span>).</p></li>
<li class="fragment"><p>Paso 2. Calcular una factorización <span class="math inline">\(\Sigma = Q^TQ\)</span>.</p></li>
<li class="fragment"><p>Paso 3. Aplicar la transformación <span class="math inline">\(X = ZQ + J\mu^T\)</span>.</p></li>
<li class="fragment"><p>Paso 4. Entregar la matriz <span class="math inline">\(n \times d\)</span> <span class="math inline">\(X\)</span>. Cada fila de <span class="math inline">\(X\)</span> es un varíate aleatorio de <span class="math inline">\(N_d(\mu, \Sigma)\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>La transformación <span class="math inline">\(X = ZQ + J\mu^T\)</span> se puede codificar en R de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> d), <span class="at">nrow =</span> n, <span class="at">ncol =</span> d)</span>
<span id="cb46-2"><a href=""></a>X <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> Q <span class="sc">+</span> <span class="fu">matrix</span>(mu, n, d, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote>
<p>El producto de matrices <span class="math inline">\(J\mu^T\)</span> es igual a <code>matrix(mu, n, d, byrow = TRUE)</code>. Esto ahorra una multiplicación de matrices. El argumento <code>byrow = TRUE</code> es necesario aquí; el valor por defecto es <code>byrow = FALSE</code>. La matriz se llena fila por fila con las entradas del vector de medias <code>mu</code>.</p>
</blockquote>
<blockquote>
<p>Existen funciones en los paquetes de R para generar muestras normales multivariadas directmente. Revisar la función <code>mvrnorm</code> en el paquete <code>MASS</code> y <code>rmvnorm</code> en el paquete <code>mvtnorm</code>.</p>
</blockquote>
</section><section id="método-de-descomposición-espectral-para-generar-muestras-n_dmu-sigma" class="slide level2" data-number="7.2"><h2>
<span class="header-section-number">7.2</span> Método de descomposición espectral para generar muestras <span class="math inline">\(N_d(\mu, \Sigma)\)</span>
</h2>
<ul>
<li class="fragment"><p>La raíz cuadrada de la covarianza es <span class="math inline">\(\Sigma^{1/2} = P\Lambda^{1/2}P^{-1}\)</span>, donde <span class="math inline">\(\Lambda\)</span> es la matriz diagonal con los valores propios de <span class="math inline">\(\Sigma\)</span> en la diagonal y <span class="math inline">\(P\)</span> es la matriz cuyas columnas son los vectores propios de <span class="math inline">\(\Sigma\)</span> correspondientes a los valores propios en <span class="math inline">\(\Lambda\)</span>.</p></li>
<li class="fragment"><p>Este método también puede llamarse el <span class="green">método de descomposición en valores propios</span>. En la descomposición en valores propios tenemos <span class="math inline">\(P^{-1} = P^T\)</span> y por lo tanto <span class="math inline">\(\Sigma^{1/2} = P\Lambda^{1/2}P^T\)</span>. La matriz <span class="math inline">\(Q = \Sigma^{1/2}\)</span> es una factorización de <span class="math inline">\(\Sigma\)</span> tal que <span class="math inline">\(Q^TQ = \Sigma\)</span>.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Método de descomposición espectral</span> </p>
<p>Este ejemplo proporciona una función <code>rmvn.eigen</code> para generar una muestra aleatoria normal multivariada. Se aplica para generar una muestra normal bivariada con vector de medias cero y</p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
1.0 &amp; 0.9 \\
0.9 &amp; 1.0
\end{bmatrix}.
\]</span></p>
</div>
<div class="columns">
<div class="column">
<p>Definiendo los parámetros</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="co"># parámetros de media y covarianza</span></span>
<span id="cb47-2"><a href=""></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb47-3"><a href=""></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">9</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<p>La función <code>eigen</code> devuelve los valores propios y vectores propios de una matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a>rmvn.eigen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, Sigma) {</span>
<span id="cb48-2"><a href=""></a>  <span class="co"># generar n vectores aleatorios de MVN(mu, Sigma)</span></span>
<span id="cb48-3"><a href=""></a>  <span class="co"># la dimensión se infiere de mu y Sigma</span></span>
<span id="cb48-4"><a href=""></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(mu)</span>
<span id="cb48-5"><a href=""></a>  ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-6"><a href=""></a>  lambda <span class="ot">&lt;-</span> ev<span class="sc">$</span>values</span>
<span id="cb48-7"><a href=""></a>  V <span class="ot">&lt;-</span> ev<span class="sc">$</span>vectors</span>
<span id="cb48-8"><a href=""></a>  R <span class="ot">&lt;-</span> V <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(lambda)) <span class="sc">%*%</span> <span class="fu">t</span>(V)</span>
<span id="cb48-9"><a href=""></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> d), <span class="at">nrow =</span> n, <span class="at">ncol =</span> d)</span>
<span id="cb48-10"><a href=""></a>  X <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> R <span class="sc">+</span> <span class="fu">matrix</span>(mu, n, d, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-11"><a href=""></a>  X</span>
<span id="cb48-12"><a href=""></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section class="slide level2"><p>Verificamos los resultados de la simulación:</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="co"># generar la muestra</span></span>
<span id="cb49-2"><a href=""></a>X <span class="ot">&lt;-</span> <span class="fu">rmvn.eigen</span>(<span class="dv">1000</span>, mu, Sigma)</span>
<span id="cb49-3"><a href=""></a><span class="fu">print</span>(<span class="fu">colMeans</span>(X))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.05928216 -0.07082142</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="fu">print</span>(<span class="fu">cor</span>(X))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 1.0000000 0.9077065
[2,] 0.9077065 1.0000000</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a><span class="fu">plot</span>(X, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-42-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>La salida del ejemplo muestra que el vector de medias de la muestra es (-0.059, -0.071) y la correlación de la muestra es 0.908, lo cual concuerda estrechamente con los parámetros especificados. El diagrama de dispersión de los datos de la muestra exhibe la simetría elíptica de las distribuciones normales multivariadas.</p>
</section><section id="método-svd-para-generar-muestras-n_dmu-sigma" class="slide level2" data-number="7.3"><h2>
<span class="header-section-number">7.3</span> Método SVD para generar muestras <span class="math inline">\(N_d(\mu, \Sigma)\)</span>
</h2>
<div class="definition">
<p>La descomposición en valores singulares (svd) generaliza la idea de los vectores propios a las matrices rectangulares.</p>
<ul>
<li class="fragment"><p>La svd de una matriz <span class="math inline">\(X\)</span> es <span class="math inline">\(X = UDV^T\)</span>, donde <span class="math inline">\(D\)</span> es un vector que contiene los valores singulares de <span class="math inline">\(X\)</span>, <span class="math inline">\(U\)</span> es una matriz cuyas columnas contienen los vectores singulares izquierdos de <span class="math inline">\(X\)</span>, y <span class="math inline">\(V\)</span> es una matriz cuyas columnas contienen los vectores singulares derechos de <span class="math inline">\(X\)</span>. La matriz <span class="math inline">\(X\)</span> en este caso es la matriz de covarianza poblacional <span class="math inline">\(\Sigma\)</span>, y <span class="math inline">\(UV^T = I\)</span>.</p></li>
<li class="fragment"><p>La svd de una matriz simétrica positiva definida <span class="math inline">\(\Sigma\)</span> da <span class="math inline">\(U = V = P\)</span> y <span class="math inline">\(\Sigma^{1/2} = UD^{1/2}V^T\)</span>.</p></li>
<li class="fragment"><p>El método svd para en este caso es equivalente al método de descomposición espectral, pero es menos eficiente porque el método svd no aprovecha el hecho de que la matriz <span class="math inline">\(\Sigma\)</span> es cuadrada simétrica.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Método SVD</span>  Construiremos una función <code>rmvn.svd</code> para generar una muestra normal multivariada, utilizando el método svd para factorizar <span class="math inline">\(\Sigma\)</span>.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a>rmvn.svd <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, Sigma) {</span>
<span id="cb54-2"><a href=""></a>  <span class="co"># generar n vectores aleatorios de MVN(mu, Sigma)</span></span>
<span id="cb54-3"><a href=""></a>  <span class="co"># la dimensión se infiere de mu y Sigma</span></span>
<span id="cb54-4"><a href=""></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(mu)</span>
<span id="cb54-5"><a href=""></a>  S <span class="ot">&lt;-</span> <span class="fu">svd</span>(Sigma)</span>
<span id="cb54-6"><a href=""></a>  R <span class="ot">&lt;-</span> S<span class="sc">$</span>u <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(S<span class="sc">$</span>d)) <span class="sc">%*%</span> <span class="fu">t</span>(S<span class="sc">$</span>v) <span class="co"># raíz cuadrada de Sigma</span></span>
<span id="cb54-7"><a href=""></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> d), <span class="at">nrow =</span> n, <span class="at">ncol =</span> d)</span>
<span id="cb54-8"><a href=""></a>  X <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> R <span class="sc">+</span> <span class="fu">matrix</span>(mu, n, d, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-9"><a href=""></a>  X</span>
<span id="cb54-10"><a href=""></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="método-de-factorización-de-choleski-para-generar-muestras-n_dmu-sigma" class="slide level2" data-number="7.4"><h2>
<span class="header-section-number">7.4</span> Método de factorización de Choleski para generar muestras <span class="math inline">\(N_d(\mu, \Sigma)\)</span>
</h2>
<div class="definition">
<ul>
<li class="fragment"><p>La factorización de Choleski de una matriz simétrica positiva definida real es <span class="math inline">\(X = Q^TQ\)</span>, donde <span class="math inline">\(Q\)</span> es una matriz triangular superior.</p></li>
<li class="fragment"><p>La factorización de Choleski se implementa en la función de R <code>chol</code>. La sintaxis básica es <code>chol(X)</code> y el valor de retorno es una matriz triangular superior <span class="math inline">\(R\)</span> tal que <span class="math inline">\(R^TR = X\)</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="example">
<p><span class="green">Método de factorización de Choleski</span> </p>
<p>El método de factorización de Choleski se aplica para generar 200 observaciones aleatorias de una distribución normal multivariada de cuatro dimensiones.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a>rmvn.Choleski <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, Sigma) {</span>
<span id="cb55-2"><a href=""></a>  <span class="co"># generar n vectores aleatorios de MVN(mu, Sigma)</span></span>
<span id="cb55-3"><a href=""></a>  <span class="co"># la dimensión se infiere de mu y Sigma</span></span>
<span id="cb55-4"><a href=""></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(mu)</span>
<span id="cb55-5"><a href=""></a>  Q <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma) <span class="co"># factorización de Choleski de Sigma</span></span>
<span id="cb55-6"><a href=""></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> d), <span class="at">nrow =</span> n, <span class="at">ncol =</span> d)</span>
<span id="cb55-7"><a href=""></a>  X <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> Q <span class="sc">+</span> <span class="fu">matrix</span>(mu, n, d, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-8"><a href=""></a>  X</span>
<span id="cb55-9"><a href=""></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section class="slide level2"><p>Generamos muestras Normal 4-variada, de acuerdo con la misma estructura de media y covarianza que los datos de <code>iris virginica</code> de cuatro dimensiones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a>y <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">==</span> <span class="st">"virginica"</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb56-2"><a href=""></a>mu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(y)</span>
<span id="cb56-3"><a href=""></a>Sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb56-4"><a href=""></a>mu</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
       6.588        2.974        5.552        2.026 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a>Sigma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length   0.40434286  0.09376327   0.30328980  0.04909388
Sepal.Width    0.09376327  0.10400408   0.07137959  0.04762857
Petal.Length   0.30328980  0.07137959   0.30458776  0.04882449
Petal.Width    0.04909388  0.04762857   0.04882449  0.07543265</code></pre>
</div>
</div>
</section><section class="slide level2"><div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a><span class="co"># Generar datos MVN con la media y covarianza calculados</span></span>
<span id="cb60-2"><a href=""></a>X <span class="ot">&lt;-</span> <span class="fu">rmvn.Choleski</span>(<span class="dv">200</span>, mu, Sigma)</span>
<span id="cb60-3"><a href=""></a><span class="co">#pairs(X)</span></span>
<span id="cb60-4"><a href=""></a><span class="fu">library</span>(GGally)</span>
<span id="cb60-5"><a href=""></a><span class="fu">data.frame</span>(X) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href=""></a>  <span class="fu">ggpairs</span>(</span>
<span id="cb60-7"><a href=""></a>    <span class="co"># upper = list(continuous = "density", combo = "box_no_facet"),</span></span>
<span id="cb60-8"><a href=""></a>    <span class="co"># lower = list(continuous = "points", combo = "dot_no_facet")</span></span>
<span id="cb60-9"><a href=""></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-46-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a>y <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href=""></a>  <span class="fu">ggpairs</span>(</span>
<span id="cb61-3"><a href=""></a>    <span class="co"># upper = list(continuous = "density", combo = "box_no_facet"),</span></span>
<span id="cb61-4"><a href=""></a>    <span class="co"># lower = list(continuous = "points", combo = "dot_no_facet")</span></span>
<span id="cb61-5"><a href=""></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img data-src="Simulacion_2_Generando_variables_aleatorias_files/figure-revealjs/unnamed-chunk-47-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><ul>
<li class="fragment"><p>Los <span class="green">diagramas de dispersión</span> de los datos dan una vista 2-D de la <span class="orange">distribución bivariada</span> de cada par de distribuciones marginales.</p></li>
<li class="fragment"><p>La <span class="green">distribución conjunta de cada par</span> de distribuciones marginales es teóricamente <span class="orange">normal bivariada</span>. El gráfico puede compararse con la siguiente Figura de la derecha, que muestra los datos de <code>iris virginica</code>. (Los datos de iris virginica <span class="orange">no son multivariados normales</span>, pero las medias y la correlación para cada par de variables deberían ser similares a los datos simulados.)</p></li>
</ul>
<div class="fragment">
<blockquote>
<p>Nota: Para estandarizar una muestra normal multivariada, invertimos el procedimiento anterior, sustituyendo el vector de medias de la muestra y la matriz de covarianza de la muestra si los parámetros son desconocidos. La muestra transformada de <span class="math inline">\(d\)</span> dimensiones tiene entonces un vector de medias cero y covarianza <span class="math inline">\(I_d\)</span>. Esto no es lo mismo que escalar las columnas de la matriz de datos.</p>
</blockquote>
</div>
</section></section><section id="referencias" class="title-slide slide level1 smaller scrollable" data-background-color="#00A499" data-number="8"><h1>
<span class="header-section-number">8</span> Referencias</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Fisher1936" class="csl-entry" role="listitem">
Fisher, Ronald Aylmer et&nbsp;al. 1936. <span>«Statistical methods for research workers.»</span> <em>Statistical methods for research workers.</em>, n.º 6th Ed.
</div>
</div>
<div class="quarto-auto-generated-content">
<p><img src="images/Usach_P2.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/notes/notes.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/search/search.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="Simulacion_2_Generando_variables_aleatorias_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"d455d1a19a55b0f5","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>