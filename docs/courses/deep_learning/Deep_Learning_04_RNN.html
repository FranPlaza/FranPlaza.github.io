<!DOCTYPE html>
<html lang="es"><head>
<script src="Deep_Learning_04_RNN_files/libs/clipboard/clipboard.min.js"></script>
<script src="Deep_Learning_04_RNN_files/libs/quarto-html/tabby.min.js"></script>
<script src="Deep_Learning_04_RNN_files/libs/quarto-html/popper.min.js"></script>
<script src="Deep_Learning_04_RNN_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Deep_Learning_04_RNN_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/quarto-html/quarto-syntax-highlighting-86daaaaad7353f9cc0c554efc1dd6d94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Deep_Learning_04_RNN_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="Deep_Learning_04_RNN_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="author" content="Francisco Plaza Vega">
<title>Deep Learning</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="Deep_Learning_04_RNN_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="Deep_Learning_04_RNN_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="Deep_Learning_04_RNN_files/libs/revealjs/dist/theme/quarto-12f9f439e1922b60d66cad71bdc1d827.css">
<link href="Deep_Learning_04_RNN_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="Deep_Learning_04_RNN_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Deep Learning</h1>
  <p class="subtitle">Unidad 4: Redes Neuronales Recurrentes (RNNs)</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Francisco Plaza Vega 
</div>
<div class="quarto-title-author-email">
<a href="mailto:francisco.plaza.v@usach.cl">francisco.plaza.v@usach.cl</a>
</div>
        <p class="quarto-title-affiliation">
            Ingeniería en Estadística
          </p>
    </div>
</div>

</section><section><section id="redes-neuronales-recurrentes" class="title-slide slide level1 center" data-background-color="#00A499" data-number="1"><h1>
<span class="header-section-number">1</span> Redes Neuronales Recurrentes</h1>

</section><section id="qué-dice-youtube" class="slide level2" data-number="1.1"><h2>
<span class="header-section-number">1.1</span> Qué dice YouTube?</h2>
<div title="Algunos enlaces que pueden ser de interés">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Algunos enlaces que pueden ser de interés</strong></p>
</div>
<div class="callout-content">
<ul>
<li class="fragment"><a href="https://www.youtube.com/watch?v=6niqTuYFZLQ">Lecture 10: Recurrent Neural Networks -Stanford University School of Engineering</a></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=qjrad0V0uJE">MIT 6.S191(2021): Recurrent Neural Networks - Alexander Amini</a></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=8HyCNIVRbSU">Illustrated Guide to LSTM’s and GRU’s: A step by step explanation - The AI Hacker</a></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=AsNTP8Kwu80&amp;t=253s">Recurrent Neural Networks (RNNs), Clearly Explained!! - John Starmer</a></li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="datos-secuenciales" class="slide level2" data-number="1.2"><h2>
<span class="header-section-number">1.2</span> Datos secuenciales?</h2>
<div title="Datos secuenciales">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Datos secuenciales</strong></p>
</div>
<div class="callout-content">
<p><em>Conjunto de <span class="green">observaciones recopiladas y ordenadas</span> en función de un <span class="green">criterio temporal, espacial, o de cualquier otra dimensión en la que el orden de las observaciones sea esencial</span> para su análisis.</em></p>
</div>
</div>
</div>
</div>

<img data-src="images/04_RNN/sequential.png" class="r-stretch"></section><section class="slide level2"><ul>
<li class="fragment"><p>Los algoritmos típicos de aprendizaje supervisado asumen que la entrada es <span class="green"><strong>independiente e idénticamente distribuida (IID)</strong></span>, lo que significa que los ejemplos de entrenamiento son <span class="orange"><strong>mutuamente independientes</strong></span> y tienen la <span class="orange"><strong>misma distribución subyacente</strong></span>.</p></li>
<li class="fragment"><p>Si se tiene una muestra que consiste en <span class="orange"><span class="math inline">\(n\)</span> ejemplos de entrenamiento, <span class="math inline">\(x^{(1)}, x^{(2)}, \dots, x^{(n)}\)</span></span>, el orden en que se usan los datos para entrenar el algoritmo de aprendizaje automático no importa.</p></li>
</ul></section><section class="slide level2"><div class="example">
<p><span class="green">Ejemplo, los datos de iris</span><br> En el conjunto de datos <span class="orange"><code>**Iris**</code></span>, cada flor ha sido medida de manera independiente, y las mediciones de una flor no influyen en las mediciones de otra flor.</p>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(datasets)</span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href=""></a><span class="fu">data</span>(iris)</span>
<span id="cb1-4"><a href=""></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href=""></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1           6.1         2.9          4.7         1.4 versicolor
2           6.2         3.4          5.4         2.3  virginica
3           4.8         3.4          1.9         0.2     setosa
4           5.8         2.8          5.1         2.4  virginica
5           5.0         3.4          1.5         0.2     setosa
6           7.2         3.0          5.8         1.6  virginica
7           6.3         2.9          5.6         1.8  virginica
8           4.7         3.2          1.3         0.2     setosa
9           7.7         3.8          6.7         2.2  virginica
10          5.0         3.5          1.6         0.6     setosa</code></pre>
</div>
</div>
</section><section class="slide level2"><p>Lo anterior no funciona cuando trabajamos con secuencias, donde <span class="green">por definición, el orden <strong>sí</strong> importa</span>.</p>
<div class="example">
<p><span class="green">Ejemplo: Datos financieros</span><br></p>
<ul>
<li class="fragment"><p>Supongamos que tenemos una muestra de <span class="math inline">\(n\)</span> ejemplos de entrenamiento, que representa <span class="orange">el valor de mercado de cierta acción en un día particular</span>.</p></li>
<li class="fragment"><p>Si el objetivo es predecir el valor del mercado de esa acción para los próximos tres días, tendría sentido considerar los precios previos en un orden cronológico, <span class="orange">como al emplear un modelo Autoregresivo (AR) de series de tiempo</span>.</p></li>
</ul>
</div>
</section><section class="slide level2"><div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1">Precio de Bitcoin</a></li>
<li><a href="#tabset-1-2">Código</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="Deep_Learning_04_RNN_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">library</span>(cryptoQuotes)</span>
<span id="cb3-2"><a href=""></a><span class="fu">library</span>(xts)</span>
<span id="cb3-3"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-4"><a href=""></a>BTC <span class="ot">&lt;-</span> <span class="fu">get_quote</span>(</span>
<span id="cb3-5"><a href=""></a>  <span class="at">ticker   =</span> <span class="st">"BTCUSDT"</span>,</span>
<span id="cb3-6"><a href=""></a>  <span class="at">source   =</span> <span class="st">"binance"</span>,</span>
<span id="cb3-7"><a href=""></a>  <span class="at">futures  =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-8"><a href=""></a>  <span class="at">interval =</span> <span class="st">"1d"</span>,</span>
<span id="cb3-9"><a href=""></a>  <span class="at">from     =</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">90</span></span>
<span id="cb3-10"><a href=""></a>)</span>
<span id="cb3-11"><a href=""></a><span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">index</span>(BTC),</span>
<span id="cb3-12"><a href=""></a>           <span class="at">BTC =</span> BTC<span class="sc">$</span>close) <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.POSIXct</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a href=""></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb3-15"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>close), <span class="at">color=</span><span class="st">"#00a499"</span>, <span class="at">linewidth=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb3-16"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Precio de BTC en (USD)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Días"</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="series-de-tiempo" class="slide level2" data-number="1.3"><h2>
<span class="header-section-number">1.3</span> Series de tiempo</h2>
<div title="Un recordatorio... o no?">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Un recordatorio… o no?</strong></p>
</div>
<div class="callout-content">
<ul>
<li class="fragment"><p>Una <span class="green">serie de tiempo</span> corresponde a una colección de observaciones <span class="math inline">\(y_t\)</span>, registradas en un tiempo específico <span class="math inline">\(t\)</span>.</p></li>
<li class="fragment"><p>Usualmente <span class="math inline">\(t \in \mathbb{Z}\)</span>, donde <span class="green"><span class="math inline">\(\mathbb{Z} = \{..., -2, -1, 0, 1, 2, ... \}\)</span></span> es un conjunto de valores enteros positivos y negativos. En la práctica, sólo una parte finita de los datos está disponible, donde podemos escribir la serie de tiempo como <span class="math inline">\(\{y_1, y_2, ..., y_n \}\)</span>.</p></li>
<li class="fragment"><p>Formalmente, una serie de tiempo <span class="math inline">\(\{y_t \}\)</span> corresponde a una <span class="green">realización de un proceso estocástico</span> que está compuesto de variables aleatorias observadas a lo largo del tiempo.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<ul>
<li class="fragment"><p>Una serie de tiempo de tipo <span class="orange"><strong>discreta</strong></span>, es aquella en la que la colección de tiempos <span class="math inline">\(T_0\)</span> en la que se hacen las observaciones es un conjunto discreto.</p></li>
<li class="fragment"><p>Una serie de tiempo de tipo <span class="orange"><strong>contínua</strong></span> es obtenida cuando las observaciones son tomadas de manera contínua sobre un intervalo de tiempo, por ejemplo <span class="math inline">\(T_0 = [0,1]\)</span>.</p></li>
</ul>
</div>
</div>
</div>
</div>
</section><section class="slide level2"><div class="alert">
<p>Una de las características principales de las series de tiempo es el hecho que observaciones sucesivas no son usualmente independientes, por lo que el análisis debe tomar en cuenta el orden temporal de las observaciones.</p>
</div>
</section><section class="slide level2"><div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1">Algunos ejemplos</a></li>
<li><a href="#tabset-2-2">Vino</a></li>
<li><a href="#tabset-2-3">TSM</a></li>
<li><a href="#tabset-2-4">Contínua 1 y 2</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout="[[45,45],[45,45]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Deep_Learning_04_RNN_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Deep_Learning_04_RNN_files/figure-revealjs/unnamed-chunk-5-2.png" width="960"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Deep_Learning_04_RNN_files/figure-revealjs/unnamed-chunk-5-3.png" width="960"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Deep_Learning_04_RNN_files/figure-revealjs/unnamed-chunk-5-4.png" width="960"></p>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="small">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r code-overflow-scroll number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href=""></a><span class="fu">library</span>(readr)</span>
<span id="cb4-4"><a href=""></a></span>
<span id="cb4-5"><a href=""></a><span class="co"># Vino ----</span></span>
<span id="cb4-6"><a href=""></a><span class="co"># URL de los datos</span></span>
<span id="cb4-7"><a href=""></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/rajansharm/Time-Series-Analysis/refs/heads/master/AusWineSales.csv"</span></span>
<span id="cb4-8"><a href=""></a></span>
<span id="cb4-9"><a href=""></a><span class="co"># Leer los datos desde el enlace</span></span>
<span id="cb4-10"><a href=""></a>wine_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb4-11"><a href=""></a></span>
<span id="cb4-12"><a href=""></a><span class="co"># Convertir el campo 'YearMonth' a formato de fecha</span></span>
<span id="cb4-13"><a href=""></a>wine_data<span class="sc">$</span>YearMonth <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(wine_data<span class="sc">$</span>YearMonth, <span class="st">"-01"</span>))</span>
<span id="cb4-14"><a href=""></a></span>
<span id="cb4-15"><a href=""></a><span class="co"># Crear el gráfico</span></span>
<span id="cb4-16"><a href=""></a>wine <span class="ot">=</span></span>
<span id="cb4-17"><a href=""></a><span class="fu">ggplot</span>(wine_data, <span class="fu">aes</span>(<span class="at">x =</span> YearMonth, <span class="at">y =</span> Red)) <span class="sc">+</span></span>
<span id="cb4-18"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>            </span>
<span id="cb4-19"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-20"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb4-21"><a href=""></a>    <span class="at">x =</span> <span class="st">"Años"</span>,</span>
<span id="cb4-22"><a href=""></a>    <span class="at">y =</span> <span class="st">"Ventas de vino tinto</span><span class="sc">\n</span><span class="st"> en Australia"</span></span>
<span id="cb4-23"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb4-24"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="small">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r code-overflow-scroll number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href=""></a><span class="fu">library</span>(readr)</span>
<span id="cb5-4"><a href=""></a><span class="fu">library</span>(zoo)</span>
<span id="cb5-5"><a href=""></a></span>
<span id="cb5-6"><a href=""></a><span class="co"># SST ----</span></span>
<span id="cb5-7"><a href=""></a>url <span class="ot">&lt;-</span> <span class="st">"https://psl.noaa.gov/data/correlation/nina34.anom.data"</span></span>
<span id="cb5-8"><a href=""></a>data_raw <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(url)</span>
<span id="cb5-9"><a href=""></a>data_lines <span class="ot">&lt;-</span> data_raw <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href=""></a>  .[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span>                                <span class="co"># Eliminar automáticamente la primera línea</span></span>
<span id="cb5-11"><a href=""></a>  .[<span class="fu">str_detect</span>(., <span class="st">"^[ ]*[0-9]{4}"</span>)]        <span class="co"># Mantener líneas que comienzan con un año de 4 dígitos</span></span>
<span id="cb5-12"><a href=""></a></span>
<span id="cb5-13"><a href=""></a><span class="co"># Convertir las líneas en un data frame procesable</span></span>
<span id="cb5-14"><a href=""></a>data <span class="ot">&lt;-</span> data_lines <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href=""></a>  <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href=""></a>  <span class="fu">str_split</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href=""></a>  <span class="fu">as.data.frame</span>(<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href=""></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Year"</span>, <span class="fu">paste0</span>(<span class="st">"Month_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href=""></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Month_"</span>), <span class="at">names_to =</span> <span class="st">"Month"</span>, <span class="at">values_to =</span> <span class="st">"Temperature"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(Month, <span class="st">"Month_"</span>)),</span>
<span id="cb5-22"><a href=""></a>         <span class="at">Time =</span> Year <span class="sc">+</span> (Month <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href=""></a>  <span class="fu">filter</span>(Temperature <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb5-24"><a href=""></a></span>
<span id="cb5-25"><a href=""></a><span class="co"># Calcular la media móvil de 5 años</span></span>
<span id="cb5-26"><a href=""></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-27"><a href=""></a>  <span class="fu">arrange</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb5-28"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">Moving_Avg =</span> <span class="fu">rollmean</span>(Temperature, <span class="at">k =</span> <span class="dv">60</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"center"</span>)) <span class="co"># 5 años * 12 meses = 60</span></span>
<span id="cb5-29"><a href=""></a></span>
<span id="cb5-30"><a href=""></a><span class="co"># Crear la gráfica</span></span>
<span id="cb5-31"><a href=""></a>sst <span class="ot">=</span>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Time)) <span class="sc">+</span></span>
<span id="cb5-32"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Temperature), <span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb5-33"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Moving_Avg), <span class="at">color =</span> <span class="st">"#ea7600"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># Línea de tendencia</span></span>
<span id="cb5-34"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb5-35"><a href=""></a>    <span class="at">x =</span> <span class="st">"Años"</span>,</span>
<span id="cb5-36"><a href=""></a>    <span class="at">y =</span> <span class="st">"TSM en la región</span><span class="sc">\n</span><span class="st"> Niño34 (°C)"</span></span>
<span id="cb5-37"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb5-38"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-2-4">
<div class="small">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r code-overflow-scroll number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href=""></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb6-4"><a href=""></a></span>
<span id="cb6-5"><a href=""></a><span class="co"># Contínua 1 ----</span></span>
<span id="cb6-6"><a href=""></a>cont1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">N =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(t)),</span>
<span id="cb6-8"><a href=""></a>         <span class="at">x =</span> <span class="fu">cos</span>(t<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> N) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>x)) <span class="sc">+</span></span>
<span id="cb6-10"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>            </span>
<span id="cb6-11"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-12"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">TeX</span>(<span class="st">"t"</span>)) <span class="sc">+</span> </span>
<span id="cb6-13"><a href=""></a>  <span class="fu">ylab</span>(<span class="fu">TeX</span>(<span class="st">"$X_t = cos(</span><span class="sc">\\</span><span class="st">frac{t}{10})+N_t"</span>)) <span class="sc">+</span></span>
<span id="cb6-14"><a href=""></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb6-15"><a href=""></a></span>
<span id="cb6-16"><a href=""></a><span class="co"># Contínua 2 ----</span></span>
<span id="cb6-17"><a href=""></a>cont2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-18"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">cos</span>(<span class="fl">0.2</span><span class="sc">*</span>t <span class="sc">+</span> pi<span class="sc">/</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>x)) <span class="sc">+</span></span>
<span id="cb6-20"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>            </span>
<span id="cb6-21"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#00a499"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-22"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">TeX</span>(<span class="st">"t"</span>)) <span class="sc">+</span> </span>
<span id="cb6-23"><a href=""></a>  <span class="fu">ylab</span>(<span class="fu">TeX</span>(<span class="st">"$X_t = cos(0.2t + </span><span class="sc">\\</span><span class="st">frac{</span><span class="sc">\\</span><span class="st">pi}{3})"</span>)) <span class="sc">+</span></span>
<span id="cb6-24"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<!-- ![Ejemplos de algunas series de tiempo de tipo discreto y contínuo](images/04_RNN/timeseries_examples.png) -->
</section><section id="objetivos-del-análisis-de-series-de-tiempo" class="slide level2" data-number="1.4"><h2>
<span class="header-section-number">1.4</span> Objetivos del análisis de series de tiempo</h2>
<p>Existen distintos objetivos posibles del análisis de series de tiempo. Estos objetivos pueden ser clasificados en 4 categorías:</p>
<ul>
<li class="fragment"><span class="orange">Describir</span></li>
<li class="fragment"><span class="orange">Explicar</span></li>
<li class="fragment"><span class="orange">Predecir</span></li>
<li class="fragment"><span class="orange">Controlar</span></li>
</ul></section><section id="representando-secuencias" class="slide level2" data-number="1.5"><h2>
<span class="header-section-number">1.5</span> Representando secuencias</h2>
<p>A partir de las definiciones de <span class="citation" data-cites="Raschka2019">Raschka y Mirjalili (<a href="#/referencias" role="doc-biblioref" onclick="">2019</a>)</span></p>

<img data-src="images/04_RNN/sequence.png" alt="Traducido de @Raschka2019" class="r-stretch"></section><section id="categorías-en-la-modelación-de-secuencias" class="slide level2" data-number="1.6"><h2>
<span class="header-section-number">1.6</span> Categorías en la modelación de secuencias</h2>

<img data-src="images/04_RNN/representando_secuencias.png" alt="Traducido de @Raschka2019" class="r-stretch"></section><section class="slide level2"><h3 data-number="1.6.1" id="muchos-a-uno">
<span class="header-section-number">1.6.1</span> Muchos a uno</h3>

<img data-src="images/04_RNN/many_one.png" alt="Traducido de @Raschka2019" class="r-stretch"><p><strong>Many-to-one (Muchos a uno):</strong> Los datos de entrada son una secuencia, pero la salida es un vector o escalar de tamaño fijo, no una secuencia. Por ejemplo, en el análisis de sentimiento, la entrada es un texto (como una reseña de película) y la salida es una etiqueta de clase (por ejemplo, una etiqueta que indica si al crítico le gustó la película).</p>
</section><section class="slide level2"><h3 data-number="1.6.2" id="uno-a-muchos">
<span class="header-section-number">1.6.2</span> Uno a Muchos</h3>

<img data-src="images/04_RNN/one_many.png" alt="Traducido de @Raschka2019" class="r-stretch"><p><strong>One-to-many (Uno a muchos):</strong> Los datos de entrada están en formato estándar y no son una secuencia, pero la salida es una secuencia. Un ejemplo de esta categoría es la generación de subtítulos para imágenes: la entrada es una imagen y la salida es una frase en inglés que resume el contenido de esa imagen.</p>
</section><section class="slide level2"><h3 data-number="1.6.3" id="muchos-a-muchos">
<span class="header-section-number">1.6.3</span> Muchos a Muchos</h3>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/04_RNN/many_many1.png" class="quarto-figure quarto-figure-center" style="width:50.0%" alt="Traducido de @Raschka2019"></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/04_RNN/many_many2.png" class="quarto-figure quarto-figure-center" alt="Traducido de @Raschka2019"></p>
</figure>
</div>
</div></div>
<p><strong>Many-to-many (Muchos a muchos):</strong> Tanto las entradas como las salidas son secuencias. Esta categoría puede dividirse aún más dependiendo de si las entradas y salidas están sincronizadas o no.</p>
<ul>
<li class="fragment"><p>Un ejemplo de una tarea <strong>many-to-many sincronizada</strong> es la clasificación de video, donde cada cuadro en un video está etiquetado.</p></li>
<li class="fragment"><p>Un ejemplo de una tarea <strong>many-to-many con retraso</strong> sería la traducción de un idioma a otro. Por ejemplo, una frase completa en inglés debe ser procesada por una máquina antes de que se produzca su traducción al español.</p></li>
</ul></section></section><section><section id="rnn-para-secuencias" class="title-slide slide level1 center" data-background-color="#00A499" data-number="2"><h1>
<span class="header-section-number">2</span> RNN para secuencias</h1>

</section><section id="entendiendo-el-mecanismo-cíclico-de-las-rnns" class="slide level2" data-number="2.1"><h2>
<span class="header-section-number">2.1</span> Entendiendo el mecanismo cíclico de las RNNs</h2>

<img data-src="images/04_RNN/RNN-looping_mechanism.png" class="quarto-figure quarto-figure-center r-stretch" alt="Traducido de @Raschka2019"><p>Ambas redes tienen solo una capa oculta. En esta representación, las unidades no se muestran, pero asumimos que la capa de entrada <span class="math inline">\((x)\)</span>, la capa oculta <span class="math inline">\((h)\)</span> y la capa de salida <span class="math inline">\((o)\)</span> son vectores que contienen muchas unidades.</p>
</section><section class="slide level2"><div class="alert">
<ul>
<li class="fragment"><p>En una <span class="green">red feedforward estándar</span>, la información fluye desde la capa de entrada hasta la capa oculta, y luego desde la capa oculta hasta la capa de salida. Por otro lado, en <span class="green">una RNN (Red Neuronal Recurrente)</span>, la capa oculta recibe su entrada tanto de la capa de entrada del instante de tiempo actual como de la capa oculta del instante de tiempo anterior.</p></li>
<li class="fragment"><p>El flujo de información entre pasos de tiempo adyacentes en la capa oculta permite que la red tenga una memoria de eventos pasados. Este flujo de información se representa usualmente como un bucle, también conocido como un <span class="orange"><em>borde recurrente</em> (recurrent edge)</span> en notación de grafos, lo cual explica el origen del nombre de esta arquitectura general de RNN.</p></li>
</ul>
</div>
</section><section class="slide level2"><p>Similar a los MLP, las RNN pueden consistir en múltiples capas ocultas.</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><a href="images/04_RNN/RNN-1layer.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="images/04_RNN/RNN-1layer.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></a></p>
</figure>
</div>
<div class="alert">
<div class="small">
<ul>
<li class="fragment"><p>Cada unidad oculta en una red neuronal estándar (MLP) recibe sólo una entrada: la preactivación neta asociada a la capa de entrada. Sin embargo, cada unidad oculta <span class="orange">en una RNN recibe dos conjuntos <em>distintos</em> de entradas</span>: la preactivación desde la capa de entrada y la activación de la misma capa oculta desde el paso de tiempo anterior, <span class="math inline">\(t - 1\)</span>.</p></li>
<li class="fragment"><p>En el primer paso de tiempo, <span class="math inline">\(t = 0\)</span>, las unidades ocultas se inicializan en cero o con pequeños valores aleatorios. Luego, en un paso de tiempo donde <span class="math inline">\(t &gt; 0\)</span>, las unidades ocultas reciben su entrada desde el punto de datos en el tiempo actual, <span class="math inline">\(x^{(t)}\)</span>, y desde los valores anteriores de las unidades ocultas en <span class="math inline">\(t - 1\)</span>, indicados como <span class="math inline">\(h^{(t-1)}\)</span>.</p></li>
</ul>
</div>
</div>
</section><section class="slide level2"><div class="quarto-figure quarto-figure-center">
<figure><p><a href="images/04_RNN/RNN-multilayer.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="images/04_RNN/RNN-multilayer.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></a></p>
</figure>
</div>
<div class="alert">
<div class="small">
<p>En el caso de una RNN multicapa:</p>
<ul>
<li class="fragment"><p><code>capa_1</code>: La primera capa oculta se representa como <span class="math inline">\(\mathbf{h}_1^{(t)}\)</span> y recibe su entrada desde el punto de datos <span class="math inline">\(\mathbf{x}^{(t)}\)</span> y desde los valores ocultos de la misma capa, pero en el paso de tiempo anterior, <span class="math inline">\(\mathbf{h}_1^{(t-1)}\)</span>.</p></li>
<li class="fragment"><p><code>capa_2</code>: La segunda capa oculta, <span class="math inline">\(\mathbf{h}_2^{(t)}\)</span>, recibe sus entradas desde las salidas de la capa inferior en el paso de tiempo actual (<span class="math inline">\(\mathbf{o}_1^{(t)}\)</span>) y desde sus propios valores ocultos del paso de tiempo anterior, <span class="math inline">\(\mathbf{h}_2^{(t-1)}\)</span>.</p></li>
</ul>
</div>
</div>
</section><section id="cálculo-de-activaciones-en-una-rnn" class="slide level2" data-number="2.2"><h2>
<span class="header-section-number">2.2</span> Cálculo de activaciones en una RNN</h2>
<p>Para simplificar, consideraremos solo una capa oculta; sin embargo, el mismo concepto aplica a RNNs multicapa.</p>
<div class="fragment">
<div class="alert">
<p>Cada borde dirigido (las conexiones entre cajas) en la representación de una RNN que acabamos de ver está asociado a una matriz de pesos. Estos pesos no dependen del tiempo <span class="math inline">\(t\)</span>, por lo tanto, se comparten a lo largo del eje temporal. Las distintas matrices de pesos en una RNN de una sola capa son las siguientes:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(\mathbf{W}_{xh}\)</span>: La matriz de pesos entre la entrada, <span class="math inline">\(\mathbf{x}^{(t)}\)</span>, y la capa oculta, <span class="math inline">\(\mathbf{h}\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(\mathbf{W}_{hh}\)</span>: La matriz de pesos asociada al borde recurrente</p></li>
<li class="fragment"><p><span class="math inline">\(\mathbf{W}_{ho}\)</span>: La matriz de pesos entre la capa oculta y la capa de salida</p></li>
</ul>
</div>
</div>
</section><section class="slide level2">
<img data-src="images/04_RNN/RNN-computing_activations.png" class="r-stretch"></section><section class="slide level2"><div class="alert">
<p>En ciertas implementaciones, puede observarse que las matrices de pesos, <span class="math inline">\(\mathbf{W}_{xh}\)</span> y <span class="math inline">\(\mathbf{W}_{hh}\)</span>, se concatenan en una matriz combinada, <span class="math inline">\(\mathbf{W}_h = [\mathbf{W}_{xh} \, ; \, \mathbf{W}_{hh}]\)</span>. Más adelante en esta sección, también utilizaremos esta notación.</p>
<p>El cálculo de las activaciones es muy similar al de los perceptrones multicapa estándar y otros tipos de redes neuronales feedforward. Para la capa oculta, la entrada neta, <span class="math inline">\(\mathbf{z}_h\)</span> (preactivación), se calcula mediante una combinación lineal, es decir, computamos la suma de las multiplicaciones de las matrices de pesos con los vectores correspondientes y añadimos el término de sesgo:</p>
<p><span class="math display">\[
\mathbf{z}_h^{(t)} = \mathbf{W}_{xh} \mathbf{x}^{(t)} + \mathbf{W}_{hh} \mathbf{h}^{(t-1)} + \mathbf{b}_h
\]</span></p>
<p>Luego, las activaciones de las unidades ocultas en el instante de tiempo <span class="math inline">\(t\)</span> se calculan de la siguiente manera:</p>
<p><span class="math display">\[
\mathbf{h}^{(t)} = \phi_h \left( \mathbf{z}_h^{(t)} \right) = \phi_h \left( \mathbf{W}_{xh} \mathbf{x}^{(t)} + \mathbf{W}_{hh} \mathbf{h}^{(t-1)} + \mathbf{b}_h \right)
\]</span></p>
<p>Aquí, <span class="math inline">\(\mathbf{b}_h\)</span> es el vector de sesgo para las unidades ocultas y <span class="math inline">\(\phi_h(\cdot)\)</span> es la función de activación de la capa oculta.</p>
</div>
</section><section class="slide level2"><div class="alert">
<p>En caso de que se desee utilizar la matriz de pesos concatenada, <span class="math inline">\(\mathbf{W}_h = [\mathbf{W}_{xh} \, ; \, \mathbf{W}_{hh}]\)</span>, la fórmula para calcular las unidades ocultas cambia de la siguiente manera:</p>
<p><span class="math display">\[
\mathbf{h}^{(t)} = \phi_h \left(
\left[ \mathbf{W}_{xh} \, ; \, \mathbf{W}_{hh} \right]
\begin{bmatrix}
\mathbf{x}^{(t)} \\
\mathbf{h}^{(t-1)}
\end{bmatrix}
+ \mathbf{b}_h
\right)
\]</span></p>
<p>Una vez que se han calculado las activaciones de las unidades ocultas en el paso de tiempo actual, se computan las activaciones de la capa de salida de la siguiente forma:</p>
<p><span class="math display">\[
\mathbf{o}^{(t)} = \phi_o \left( \mathbf{W}_{ho} \mathbf{h}^{(t)} + \mathbf{b}_o \right)
\]</span></p>
</div>
</section><section class="slide level2"><p>Para clarificar aún más este proceso, se muestra cómo se computan estas activaciones con ambas formulaciones.</p>

<img data-src="images/04_RNN/RNN-computing_activations2.png" class="quarto-figure quarto-figure-center r-stretch"></section><section id="entrenamiento-de-rnns" class="slide level2" data-number="2.3"><h2>
<span class="header-section-number">2.3</span> Entrenamiento de RNNs</h2>
<p>El algoritmo de aprendizaje para RNNs fue introducido en 1990: <em>Backpropagation Through Time: What It Does and How to Do It</em> <span class="citation" data-cites="Werbos1990">(<a href="#/referencias" role="doc-biblioref" onclick="">Werbos 1990</a>)</span>.</p>
<div class="alert">
<p>La derivación de los gradientes puede ser algo compleja, pero la idea básica es que la pérdida total, <span class="math inline">\(L\)</span>, es la suma de todas las funciones de pérdida en los tiempos <span class="math inline">\(t = 1\)</span> hasta <span class="math inline">\(t = T\)</span>:</p>
<p><span class="math display">\[
L = \sum_{t=1}^{T} L^{(t)}
\]</span></p>
<p>Dado que la pérdida en el tiempo <span class="math inline">\(t\)</span> depende de las unidades ocultas en todos los pasos de tiempo anteriores <span class="math inline">\(1 : t\)</span>, el gradiente se calcula de la siguiente forma:</p>
<p><span class="math display">\[
\frac{\partial L^{(t)}}{\partial \mathbf{W}_{hh}} =
\frac{\partial L^{(t)}}{\partial \mathbf{o}^{(t)}}
\times \frac{\partial \mathbf{o}^{(t)}}{\partial \mathbf{h}^{(t)}}
\times \left( \sum_{k=1}^{t}
\frac{\partial \mathbf{h}^{(t)}}{\partial \mathbf{h}^{(k)}}
\times \frac{\partial \mathbf{h}^{(k)}}{\partial \mathbf{W}_{hh}}
\right)
\]</span></p>
<p>Aquí, <span class="math inline">\(\frac{\partial \mathbf{h}^{(t)}}{\partial \mathbf{h}^{(k)}}\)</span> se calcula como el producto de derivadas a través de los pasos de tiempo adyacentes:</p>
<p><span class="math display">\[
\frac{\partial \mathbf{h}^{(t)}}{\partial \mathbf{h}^{(k)}} =
\prod_{i = k+1}^{t}
\frac{\partial \mathbf{h}^{(i)}}{\partial \mathbf{h}^{(i-1)}}
\]</span></p>
</div>
</section></section><section id="referencias" class="title-slide slide level1 smaller scrollable" data-background-color="#00A499" data-number="3"><h1>
<span class="header-section-number">3</span> Referencias</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Raschka2019" class="csl-entry" role="listitem">
Raschka, Sebastian, y Vahid Mirjalili. 2019. <em>Python machine learning: Machine learning and deep learning with Python, scikit-learn, and TensorFlow 2</em>. Packt Publishing Ltd.
</div>
<div id="ref-Werbos1990" class="csl-entry" role="listitem">
Werbos, Paul J. 1990. <span>«Backpropagation through time: what it does and how to do it»</span>. <em>Proceedings of the IEEE</em> 78 (10): 1550-60.
</div>
</div>

</section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/Usach_P2.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="Deep_Learning_04_RNN_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/notes/notes.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/search/search.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="Deep_Learning_04_RNN_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"0a1271e2cf27cebb","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>


</body></html>