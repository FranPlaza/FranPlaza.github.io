<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Francisco Plaza Vega">

<title>Deep Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Deep_Learning_02_guide_01_files/libs/clipboard/clipboard.min.js"></script>
<script src="Deep_Learning_02_guide_01_files/libs/quarto-html/quarto.js"></script>
<script src="Deep_Learning_02_guide_01_files/libs/quarto-html/popper.min.js"></script>
<script src="Deep_Learning_02_guide_01_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Deep_Learning_02_guide_01_files/libs/quarto-html/anchor.min.js"></script>
<link href="Deep_Learning_02_guide_01_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Deep_Learning_02_guide_01_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Deep_Learning_02_guide_01_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Deep_Learning_02_guide_01_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Deep_Learning_02_guide_01_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#importar-keras" id="toc-importar-keras" class="nav-link active" data-scroll-target="#importar-keras"><span class="header-section-number">1</span> Importar Keras</a></li>
  <li><a href="#nuestro-primer-modelo" id="toc-nuestro-primer-modelo" class="nav-link" data-scroll-target="#nuestro-primer-modelo"><span class="header-section-number">2</span> Nuestro primer modelo</a>
  <ul class="collapse">
  <li><a href="#modelo-secuencial" id="toc-modelo-secuencial" class="nav-link" data-scroll-target="#modelo-secuencial"><span class="header-section-number">2.1</span> Modelo secuencial</a></li>
  <li><a href="#configurando-las-capas" id="toc-configurando-las-capas" class="nav-link" data-scroll-target="#configurando-las-capas"><span class="header-section-number">2.2</span> Configurando las capas</a></li>
  </ul></li>
  <li><a href="#entrenamiento-y-evaluación" id="toc-entrenamiento-y-evaluación" class="nav-link" data-scroll-target="#entrenamiento-y-evaluación"><span class="header-section-number">3</span> Entrenamiento y evaluación</a>
  <ul class="collapse">
  <li><a href="#configurar-el-entrenamiento" id="toc-configurar-el-entrenamiento" class="nav-link" data-scroll-target="#configurar-el-entrenamiento"><span class="header-section-number">3.1</span> Configurar el entrenamiento</a></li>
  <li><a href="#datos-de-entrada-entrenamiento-y-prueba" id="toc-datos-de-entrada-entrenamiento-y-prueba" class="nav-link" data-scroll-target="#datos-de-entrada-entrenamiento-y-prueba"><span class="header-section-number">3.2</span> Datos de entrada (Entrenamiento y prueba)</a></li>
  <li><a href="#entrenando-el-modelo" id="toc-entrenando-el-modelo" class="nav-link" data-scroll-target="#entrenando-el-modelo"><span class="header-section-number">3.3</span> Entrenando el modelo</a></li>
  <li><a href="#evaluación-del-modelo" id="toc-evaluación-del-modelo" class="nav-link" data-scroll-target="#evaluación-del-modelo"><span class="header-section-number">3.4</span> Evaluación del modelo</a></li>
  <li><a href="#predicción-de-observaciones" id="toc-predicción-de-observaciones" class="nav-link" data-scroll-target="#predicción-de-observaciones"><span class="header-section-number">3.5</span> Predicción de observaciones</a></li>
  </ul></li>
  <li><a href="#extras" id="toc-extras" class="nav-link" data-scroll-target="#extras"><span class="header-section-number">4</span> Extras</a>
  <ul class="collapse">
  <li><a href="#callbacks" id="toc-callbacks" class="nav-link" data-scroll-target="#callbacks"><span class="header-section-number">4.1</span> Callbacks</a></li>
  <li><a href="#guardar-y-restaurar-modelos" id="toc-guardar-y-restaurar-modelos" class="nav-link" data-scroll-target="#guardar-y-restaurar-modelos"><span class="header-section-number">4.2</span> Guardar y restaurar modelos</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Deep Learning</h1>
<p class="subtitle lead">DNN: Tutorial básico de <code>Keras</code> en R</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autor/a</div>
  <div class="quarto-title-meta-heading">Afiliación</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Francisco Plaza Vega <a href="mailto:francisco.plaza.v@usach.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Ingeniería en Estadística
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<div class="example">
<p>Bienvenidos a la guía rápida para empezar con <code>keras</code> en R para construir los primeros modelos de Deep Learning, particularmente los modelos de <span class="green">Perceptrón Multicapa (Multi Layer Perceptron, MLP)</span>. <span class="orange">Keras</span> es una API (<em>Application Program Interface</em>) basada en <code>tensorflow</code>, diseñada para permitir una implementación rápida, fácil y modular con diferentes arquitecturas de Deep Learning.</p>
<p>Características clave de Keras incluyen:</p>
<ul>
<li><p><span class="orange"><strong>Facilidad de uso</strong></span>: Keras tiene una API simple y coherente optimizada para casos de uso comunes, lo que facilita el entendimiento y la utilización, incluso para aquellos que son nuevos en el campo.</p></li>
<li><p><span class="orange"><strong>Modularidad</strong></span>: Keras está estructurada en módulos, lo que permite una configuración y expansión flexibles. Los componentes de Keras como las capas, funciones de activación, optimizadores, entre otros, son independientes y combinables.</p></li>
<li><p><span class="orange"><strong>Extensibilidad</strong></span>: Se puede extender fácilmente con nuevas funcionalidades como nuevos tipos de capas, funciones de pérdida, etc., lo que la hace adaptable a necesidades avanzadas.</p></li>
<li><p><span class="orange"><strong>Compatibilidad</strong></span>: Keras se ejecuta sobre varios frameworks de backend de computación, siendo TensorFlow el más común y recomendado. Esto significa que se puede aprovechar la potencia y flexibilidad de estos frameworks, incluyendo la capacidad de ejecución en GPU para procesamiento de alto rendimiento.</p></li>
</ul>
<p>Keras se utiliza para construir y entrenar modelos de Deep Learning de manera eficiente, desde redes simples hasta complejas, con soporte para una amplia gama de arquitecturas de red. Su diseño y facilidad de uso la posiciona como una de las bibliotecas más populares en el ámbito del Deep Learning.</p>
<p>Esta guía está basada en la guía oficial de Keras en R (<a href="https://tensorflow.rstudio.com/guides/keras/basics" class="uri">https://tensorflow.rstudio.com/guides/keras/basics</a>).</p>
</div>
<section id="importar-keras" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Importar Keras</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'keras' was built under R version 4.3.3</code></pre>
</div>
</div>
</section>
<section id="nuestro-primer-modelo" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Nuestro primer modelo</h1>
<section id="modelo-secuencial" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="modelo-secuencial"><span class="header-section-number">2.1</span> Modelo secuencial</h2>
<p>El modelo secuencial (<code>keras_model_sequential()</code>) en Keras utiliza una manera intuitiva para construir un modelo de red neuronal. Esencialmente, es un conjunto de capas apilado de manera lineal, es decir, que el modelo se va creando capa por capa de manera <em>secuencial</em>. Este tipo de modelo es muy útil cuando se tiene una cadena simple de capas, donde cada capa tiene exactamente un tensor de entrada y un tensor de salida.</p>
<ul>
<li><p><span class="orange"><strong>Inicialización</strong></span>: Comenzamos inicializando el modelo Sequential. Esto es como preparar un contenedor vacío donde se irán añadiendo capas para nuestro modelo.</p></li>
<li><p><span class="orange"><strong>Añadir Capas</strong></span>: Luego, añadimos las capas al modelo. Keras proporciona una variedad de capas que se pueden añadir, como capas <code>dense</code> (<em>fully connected</em>, i.e.&nbsp;MLP), capas de convolución, capas recurrentes, etc. Cada capa se va apilando sobre la anterior. Usaremos un modelo con dos capas ocultas, la primera y segunda capa oculta del modelo utilizarán una función de activación <code>relu</code> y luego la capa de salida tendrá una activación de tipo <code>softmax</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agrega la primer capa al modelo y establece la forma que tendrá la capa de entrada</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">activation =</span> <span class="st">'relu'</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">32</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agrega otra capa:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">activation =</span> <span class="st">'relu'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agrega la capa de salida (10 nodos) con la función 'softmax':</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">10</span>, <span class="at">activation =</span> <span class="st">'softmax'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="configurando-las-capas" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="configurando-las-capas"><span class="header-section-number">2.2</span> Configurando las capas</h2>
<p>Acá vemos algunas de las opciones que presenta la librería, las opciones consideran la función de activación, el inicializador para el kernel y algunas opciones de regularización:</p>
<ul>
<li><p><code>activation</code>: Establece la función de activación para cada una de las capas.</p></li>
<li><p><code>kernel_initializer</code> y <code>bias_initializer</code>: Los esquemas de inicialización que darán el punto de partida a los pesos de cada capa (kernel y bias). Por defecto, se utiliza el <a href="https://tensorflow.rstudio.com/reference/keras/initializer_glorot_uniform">inicializador uniforme de Glorot</a>.</p></li>
<li><p><code>kernel_regularizer</code> y <code>bias_regularizer</code>: Los esquemas de regularización que se aplicarán a los pesos de cada capa (kernel and bias), como <span class="orange">regularización en L1 o L2, o ambas</span>. Por defecto no se aplica ningún método de regularización.</p></li>
</ul>
<p>Ejemplos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una capa con activación sigmoide:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">activation =</span><span class="st">'sigmoid'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Una capa con regularización en L1 para el kernel y un factor de 0.01 </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">kernel_regularizer =</span> <span class="fu">regularizer_l1</span>(<span class="fl">0.01</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Una capa con regularización en L2 para el bias y un factor de 0.01 </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">bias_regularizer =</span> <span class="fu">regularizer_l2</span>(<span class="fl">0.01</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Una capa con inicialización de pesos en el kernel utilizando una matriz aleatoria ortogonal</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">kernel_initializer =</span> <span class="st">'orthogonal'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Una capa inicialización del vector bias en 2.0</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">64</span>, <span class="at">bias_initializer =</span> <span class="fu">initializer_constant</span>(<span class="fl">2.0</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="entrenamiento-y-evaluación" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Entrenamiento y evaluación</h1>
<section id="configurar-el-entrenamiento" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="configurar-el-entrenamiento"><span class="header-section-number">3.1</span> Configurar el entrenamiento</h2>
<p>Una vez se han añadido todas las capas necesarias, el siguiente paso es compilar el modelo. Aquí es donde se define la función de pérdida que el modelo tratará de minimizar, el optimizador que determina cómo el modelo actualizará los parámetros durante el entrenamiento, y las métricas de evaluación que queremos observar. Por ejemplo, para un problema de clasificación, se podría usar la función de pérdida de entropía cruzada categórica <code>categorical_crossentropy</code> y el optimizador <code>adam</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">compile</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimizer =</span> <span class="st">'adam'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss =</span> <span class="st">'categorical_crossentropy'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">list</span>(<span class="st">'accuracy'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La función <code>compile</code> toma tres argumentos importantes que se deben configurar adecuadamente, dependiendo de si el modelo se utiliza para tareas de clasificación o de regresión:</p>
<ul>
<li><span class="orange"><strong>Optimizador</strong></span>: Define cómo se actualiza el modelo durante el entrenamiento. Algunas opciones populares incluyen <code>adam</code> para una amplia gama de aplicaciones, <code>rmsprop</code> recomendado para redes recurrentes, y <code>sgd</code> (descenso de gradiente estocástico) que es útil en contextos específicos y cuando se necesita un control más detallado sobre el entrenamiento.
<ul>
<li>Clasificación y regresión: <code>adam</code>, <code>rmsprop</code>, <code>sgd</code>.</li>
</ul></li>
<li><span class="orange"><strong>Función de pérdida</strong></span>: Especifica el criterio que el modelo intentará minimizar.
<ul>
<li>Clasificación: <code>categorical_crossentropy</code> para clasificación multiclase, <code>binary_crossentropy</code> para clasificación binaria.</li>
<li>Regresión: <code>mean_squared_error</code> (mse) para medir el promedio de los errores al cuadrado entre los valores predichos y reales, <code>mean_absolute_error</code> (mae) para la diferencia media absoluta.</li>
</ul></li>
<li><span class="orange"><strong>Métricas</strong></span>: Utilizadas para monitorear y evaluar el rendimiento del modelo durante el entrenamiento.
<ul>
<li>Clasificación: <code>accuracy</code> es comúnmente usada para evaluar la proporción de aciertos.</li>
<li>Regresión: <code>mean_squared_error</code> o <code>mse</code> para el error cuadrático medio, <code>mean_absolute_error</code> o <code>mae</code> para el error absoluto medio. pueden ser usadas para evaluar cuán cerca están las predicciones del modelo de los valores reales.</li>
</ul></li>
</ul>
<p>Ejemplos de configuración del modelo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configura un modelo para regresión</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">compile</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimizer =</span> <span class="st">'adam'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss =</span> <span class="st">'mse'</span>,           <span class="co"># mean squared error</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">list</span>(<span class="st">'mae'</span>)   <span class="co"># mean absolute error</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Configura un modelo para clasificación</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">compile</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimizer =</span> <span class="fu">optimizer_rmsprop</span>(<span class="at">learning_rate =</span> <span class="fl">0.01</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss =</span> <span class="st">"categorical_crossentropy"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">list</span>(<span class="st">"categorical_accuracy"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="datos-de-entrada-entrenamiento-y-prueba" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="datos-de-entrada-entrenamiento-y-prueba"><span class="header-section-number">3.2</span> Datos de entrada (Entrenamiento y prueba)</h2>
<p>Se pueden entrenar modelos de Keras directamente en matrices y arreglos de R (que posiblemente se hayan creado a partir de <code>data.frames</code> de R). Un modelo se ajusta a los datos de entrenamiento utilizando el método <code>fit</code>. Las variables <code>data</code> y <code>labels</code> son matrices con elementos que siguen una distribución de probabilidad normal estándar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos de entrenamiento simulados</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">32</span>), <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">32</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos de prueba simulados</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">300</span> <span class="sc">*</span> <span class="dv">32</span>), <span class="at">nrow =</span> <span class="dv">300</span>, <span class="at">ncol =</span> <span class="dv">32</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>test_labels <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">300</span> <span class="sc">*</span> <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">300</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  labels,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">10</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">32</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
32/32 - 1s - loss: -2.0688e-01 - accuracy: 0.0960 - 675ms/epoch - 21ms/step
Epoch 2/10
32/32 - 0s - loss: -4.4227e-01 - accuracy: 0.1120 - 41ms/epoch - 1ms/step
Epoch 3/10
32/32 - 0s - loss: -6.3738e-01 - accuracy: 0.1200 - 29ms/epoch - 921us/step
Epoch 4/10
32/32 - 0s - loss: -8.5355e-01 - accuracy: 0.1360 - 34ms/epoch - 1ms/step
Epoch 5/10
32/32 - 0s - loss: -1.0190e+00 - accuracy: 0.1400 - 25ms/epoch - 780us/step
Epoch 6/10
32/32 - 0s - loss: -1.2954e+00 - accuracy: 0.1500 - 17ms/epoch - 537us/step
Epoch 7/10
32/32 - 0s - loss: -1.5062e+00 - accuracy: 0.1510 - 30ms/epoch - 932us/step
Epoch 8/10
32/32 - 0s - loss: -1.6185e+00 - accuracy: 0.1530 - 30ms/epoch - 925us/step
Epoch 9/10
32/32 - 0s - loss: -1.8616e+00 - accuracy: 0.1500 - 23ms/epoch - 727us/step
Epoch 10/10
32/32 - 0s - loss: -2.2438e+00 - accuracy: 0.1540 - 20ms/epoch - 624us/step</code></pre>
</div>
</div>
</section>
<section id="entrenando-el-modelo" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="entrenando-el-modelo"><span class="header-section-number">3.3</span> Entrenando el modelo</h2>
<p>El método <code>fit</code> toma tres argumentos importantes:</p>
<ul>
<li><p><span class="orange"><strong>epochs</strong></span>: El entrenamiento se estructura en épocas. Una época es una iteración sobre todo el conjunto de datos de entrada.</p></li>
<li><p><span class="orange"><strong>batch_size</strong></span>: Cuando se pasan datos en forma de matriz o arreglo, el modelo divide los datos en conjuntos más pequeños e itera sobre estos estos conjuntos durante el entrenamiento. Este entero especifica el tamaño de cada lote. Es importante tener en cuenta que el último lote puede ser más pequeño si el número total de muestras no es divisible por el tamaño del lote.</p></li>
<li><p><span class="orange"><strong>validation_data</strong></span>: Al prototipar un modelo, es útil monitorear fácilmente su rendimiento en algunos datos de validación. Pasar este argumento —una lista de entradas y etiquetas— permite al modelo mostrar la pérdida y métricas en modo de inferencia para los datos pasados, al final de cada época.</p></li>
</ul>
<p>Aquí se presenta un ejemplo utilizando <code>validation_data</code>, donde creamos un set de datos adicional. Otra opción es utilizar <code>validation_split()</code>, donde extraerá un subconjunto de datos del entrenamiento (tanto en los inputs <span class="math inline">X</span> como en las etiquetas <span class="math inline">Y</span>) para efectuar la validación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">32</span>), <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">32</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>val_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="dv">32</span>), <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">32</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>val_labels <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  labels,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">10</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">32</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">validation_data =</span> <span class="fu">list</span>(val_data, val_labels)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
32/32 - 0s - loss: 0.2927 - accuracy: 0.0930 - val_loss: -1.9791e+00 - val_accuracy: 0.1100 - 256ms/epoch - 8ms/step
Epoch 2/10
32/32 - 0s - loss: 0.0823 - accuracy: 0.1010 - val_loss: -1.4662e+00 - val_accuracy: 0.1000 - 54ms/epoch - 2ms/step
Epoch 3/10
32/32 - 0s - loss: -6.3662e-01 - accuracy: 0.0870 - val_loss: -1.1032e+00 - val_accuracy: 0.1300 - 46ms/epoch - 1ms/step
Epoch 4/10
32/32 - 0s - loss: -3.4476e-01 - accuracy: 0.1080 - val_loss: -1.4138e+00 - val_accuracy: 0.0900 - 61ms/epoch - 2ms/step
Epoch 5/10
32/32 - 0s - loss: -7.1458e-01 - accuracy: 0.1000 - val_loss: -2.6395e+00 - val_accuracy: 0.1300 - 42ms/epoch - 1ms/step
Epoch 6/10
32/32 - 0s - loss: -8.3069e-01 - accuracy: 0.1020 - val_loss: -1.3383e+00 - val_accuracy: 0.1500 - 50ms/epoch - 2ms/step
Epoch 7/10
32/32 - 0s - loss: -1.7367e+00 - accuracy: 0.1090 - val_loss: -7.6512e-01 - val_accuracy: 0.1000 - 40ms/epoch - 1ms/step
Epoch 8/10
32/32 - 0s - loss: -1.4613e+00 - accuracy: 0.1020 - val_loss: -1.9789e+00 - val_accuracy: 0.1400 - 50ms/epoch - 2ms/step
Epoch 9/10
32/32 - 0s - loss: -1.1939e+00 - accuracy: 0.1180 - val_loss: -1.7426e+00 - val_accuracy: 0.0900 - 44ms/epoch - 1ms/step
Epoch 10/10
32/32 - 0s - loss: -1.5717e+00 - accuracy: 0.1080 - val_loss: -1.4803e+00 - val_accuracy: 0.1000 - 47ms/epoch - 1ms/step</code></pre>
</div>
</div>
</section>
<section id="evaluación-del-modelo" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="evaluación-del-modelo"><span class="header-section-number">3.4</span> Evaluación del modelo</h2>
<p>Para evaluar la función de pérdida y las métricas establecidas usamos <code>evaluate</code>. Se puede utilizar tanto para el conjunto de entrenamiento como para el de prueba:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">evaluate</span>(test_data, test_labels, <span class="at">batch_size =</span> <span class="dv">32</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10 - 0s - loss: -4.5548e-01 - accuracy: 0.1300 - 15ms/epoch - 2ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      loss   accuracy 
-0.4554779  0.1300000 </code></pre>
</div>
</div>
</section>
<section id="predicción-de-observaciones" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="predicción-de-observaciones"><span class="header-section-number">3.5</span> Predicción de observaciones</h2>
<p>Y para predecir la salida de la última capa en el conjunto de prueba (pero también se puede hacer para el entrenamiento):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">predict</span>(test_data, <span class="at">batch_size =</span> <span class="dv">32</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10 - 0s - 65ms/epoch - 7ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]       [,3]        [,4]       [,5]        [,6]
[1,] 0.195472911 0.020692170 0.11873411 0.090526842 0.04747483 0.063484013
[2,] 0.246287227 0.066558935 0.11277572 0.012254063 0.12813528 0.072297566
[3,] 0.057932884 0.003986907 0.09824687 0.002683881 0.77617496 0.002414052
[4,] 0.007556915 0.027510762 0.49224505 0.003122625 0.23085147 0.077297240
[5,] 0.037863251 0.012916965 0.20119390 0.041215729 0.20616631 0.122328557
[6,] 0.028843455 0.013159634 0.01308275 0.001210736 0.26774430 0.101673916
           [,7]        [,8]         [,9]       [,10]
[1,] 0.12658481 0.046494108 4.522344e-02 0.245312676
[2,] 0.09047966 0.005971425 4.420675e-02 0.221033350
[3,] 0.04951634 0.000399508 1.568512e-04 0.008487809
[4,] 0.03028112 0.009660723 9.086001e-05 0.121383168
[5,] 0.31157717 0.056666274 1.159394e-03 0.008912438
[6,] 0.03464352 0.018494736 1.734982e-02 0.503797114</code></pre>
</div>
</div>
</section>
</section>
<section id="extras" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Extras</h1>
<section id="callbacks" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="callbacks"><span class="header-section-number">4.1</span> Callbacks</h2>
<p>Un <em>callback</em> es un objeto que se pasa a un modelo para personalizar y extender su comportamiento durante el entrenamiento. Se puede <em>escribir</em> un callback personalizado o utilizar los <em>callbacks</em> integrados en Keras (más detalles en este enlace de <a href="https://cran.r-project.org/web/packages/keras/vignettes/training_callbacks.html">R-CRAN</a>, que incluyen:</p>
<ul>
<li><code>callback_model_checkpoint</code>: Guarda puntos de control del modelo a intervalos regulares.</li>
<li><code>callback_learning_rate_scheduler</code>: Cambia dinámicamente la tasa de aprendizaje.</li>
<li><code>callback_early_stopping</code>: Interrumpe el entrenamiento cuando el rendimiento en la validación ha dejado de mejorar.</li>
</ul>
<p>Para usar un <code>callback</code>, se añade en la función <code>fit</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>callbacks <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">callback_early_stopping</span>(<span class="at">patience =</span> <span class="dv">2</span>, <span class="at">monitor =</span> <span class="st">'val_loss'</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">callback_tensorboard</span>(<span class="at">log_dir =</span> <span class="st">'./logs'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  labels,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">32</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">5</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">callbacks =</span> callbacks,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">validation_data =</span> <span class="fu">list</span>(val_data, val_labels)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="guardar-y-restaurar-modelos" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="guardar-y-restaurar-modelos"><span class="header-section-number">4.2</span> Guardar y restaurar modelos</h2>
<p>Se pueden guardar y cargar los pesos asociados a algún modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar los pesos del modelo</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">save_model_weights_tf</span>(<span class="st">'ruta_al_archivo/'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar los pesos del modelo</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">load_model_weights_tf</span>(<span class="st">'ruta_al_archivo/'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>También se puede guardar y cargar un modelo completo, sin necesidad de ejecutar el código nuevamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar modelo completo, en formato SavedModel</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">save_model_tf</span>(<span class="st">'ruta_al_archivo/'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar modelo completo, incluidos pesos y optimizador en formato SavedModel</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">load_model_tf</span>(<span class="st">'ruta_al_archivo/'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Espero esta guía sea de utilidad para poder comenzar a implementar los primeros modelos de Deep Learning.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>